---
title: Глава 1. Введение в FTP NetX для ОСРВ Azure
description: Протокол File Transfer Protocol (FTP) предназначен для передачи файлов. Для выполнения своей функции передачи файлов протокол FTP использует службы TCP.
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 86e132daf96f9039631234f10c8e239b61ad5126
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104815208"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-ftp"></a><span data-ttu-id="9c9a3-104">Глава 1. Введение в FTP NetX для ОСРВ Azure</span><span class="sxs-lookup"><span data-stu-id="9c9a3-104">Chapter 1 - Introduction to Azure RTOS NetX FTP</span></span>

<span data-ttu-id="9c9a3-105">Протокол File Transfer Protocol (FTP) предназначен для передачи файлов.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-105">The File Transfer Protocol (FTP) is a protocol designed for file transfers.</span></span> <span data-ttu-id="9c9a3-106">Для выполнения своей функции передачи файлов протокол FTP использует службы TCP.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-106">FTP utilizes reliable Transmission Control Protocol (TCP) services to perform its file transfer function.</span></span> <span data-ttu-id="9c9a3-107">Именно поэтому FTP является высоконадежным протоколом передачи файлов.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-107">Because of this, FTP is a highly reliable file transfer protocol.</span></span> <span data-ttu-id="9c9a3-108">FTP также характеризуется высокой производительностью.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-108">FTP is also high-performance.</span></span> <span data-ttu-id="9c9a3-109">Фактический перенос файлов FTP выполняется по выделенному FTP-соединению.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-109">The actual FTP file transfer is performed on a dedicated FTP connection.</span></span>

## <a name="ftp-requirements"></a><span data-ttu-id="9c9a3-110">Требования для FTP</span><span class="sxs-lookup"><span data-stu-id="9c9a3-110">FTP Requirements</span></span>

<span data-ttu-id="9c9a3-111">Для правильной работы пакета FTP NetX в ОСРВ Azure требуется, чтобы экземпляр IP NetX уже был создан.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-111">In order to function properly, the Azure RTOS NetX FTP package requires that a NetX IP instance has already been created.</span></span> <span data-ttu-id="9c9a3-112">Кроме того, на этом же экземпляре IP должен быть включен протокол TCP.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-112">In addition, TCP must be enabled on that same IP instance.</span></span> <span data-ttu-id="9c9a3-113">Дополнительные требования для клиентской части FTP в пакете FTP NetX отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-113">The FTP Client portion of the NetX FTP package has no further requirements.</span></span>

<span data-ttu-id="9c9a3-114">Для серверной части FTP в пакете FTP NetX существует ряд дополнительных требований.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-114">The FTP Server portion of the NetX FTP package has several additional requirements.</span></span> <span data-ttu-id="9c9a3-115">Во-первых, она требует полного доступа к *известному TCP-порту 21* для обработки всех запросов команд клиента FTP и к *хорошо известному порту 20* для обработки всех операций передачи данных клиента FTP.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-115">First, it requires complete access to TCP *well-known port 21* for handling all Client FTP command requests and *well-known port 20* for handling all Client FTP data transfers.</span></span> <span data-ttu-id="9c9a3-116">FTP-сервер также предназначен для работы со встроенной файловой системой FileX.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-116">The FTP Server is also designed for use with the FileX embedded file system.</span></span> <span data-ttu-id="9c9a3-117">Если система FileX недоступна, пользователь может перенести используемые части FileX в собственную среду.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-117">If FileX is not available, the user may port the portions of FileX used to their own environment.</span></span> <span data-ttu-id="9c9a3-118">Этот процесс рассматривается в последующих разделах данного руководства.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-118">This is discussed in later sections of this guide.</span></span>

## <a name="ftp-constraints"></a><span data-ttu-id="9c9a3-119">Ограничения FTP</span><span class="sxs-lookup"><span data-stu-id="9c9a3-119">FTP Constraints</span></span>

<span data-ttu-id="9c9a3-120">Стандарт FTP имеет множество параметров, касающихся представления данных файлов.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-120">The FTP standard has many options regarding the representation of file data.</span></span> <span data-ttu-id="9c9a3-121">Как и в случае с реализациями UNIX, для FTP NetX действуют следующие ограничения формата файлов.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-121">Similar to Unix implementations, NetX FTP assumes the following file format constraints:</span></span>

- <span data-ttu-id="9c9a3-122">Тип файла: **двоичный**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-122">File Type: **Binary**</span></span>
- <span data-ttu-id="9c9a3-123">Формат файла: **только непечатаемый**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-123">File Format: **Nonprint Only**</span></span>
- <span data-ttu-id="9c9a3-124">Структура файла: **только структура файлов**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-124">File Structure: **File Structure Only**</span></span>
- <span data-ttu-id="9c9a3-125">Режим передачи: **только режим потоковой передачи**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-125">Transmission Mode: **Stream Mode Only**</span></span>

## <a name="ftp-file-names"></a><span data-ttu-id="9c9a3-126">Имена файлов FTP</span><span class="sxs-lookup"><span data-stu-id="9c9a3-126">FTP File Names</span></span>

<span data-ttu-id="9c9a3-127">Имена файлов FTP должны иметь формат целевой файловой системы (обычно FileX).</span><span class="sxs-lookup"><span data-stu-id="9c9a3-127">FTP file names should be in the format of the target file system (usually FileX).</span></span> <span data-ttu-id="9c9a3-128">Они должны быть строками символов ASCII с завершающим нулем и сведениями о полном пути, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-128">They should be NULL terminated ASCII strings, with full path information if necessary.</span></span> <span data-ttu-id="9c9a3-129">В реализации FTP NetX ограничение на размер имен файлов FTP отсутствует.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-129">There is no specified limit for the size of FTP file names in the NetX FTP implementation.</span></span> <span data-ttu-id="9c9a3-130">Однако размер полезных данных пула пакетов должен поддерживать максимальное значение пути и (или) имени файла.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-130">However, the packet pool payload size should be able to accommodate the maximum path and/or file name.</span></span>

## <a name="ftp-client-commands"></a><span data-ttu-id="9c9a3-131">Команды клиента FTP</span><span class="sxs-lookup"><span data-stu-id="9c9a3-131">FTP Client Commands</span></span>

<span data-ttu-id="9c9a3-132">В FTP доступен простой механизм для открытия подключений и выполнения операций с файлами и каталогами.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-132">The FTP has a simple mechanism for opening connections and performing file and directory operations.</span></span> <span data-ttu-id="9c9a3-133">По сути, существует набор стандартных команд FTP, выдаваемых клиентом после успешной установки подключения на *известном TCP-порту 21*.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-133">There is basically a set of standard FTP commands that are issued by the Client after a connection has been successfully established on the TCP *well-known port 21*.</span></span> <span data-ttu-id="9c9a3-134">Ниже приведены некоторые основные команды FTP.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-134">The following shows some of the basic FTP commands:</span></span>

### <a name="ftp-command-and-meaning"></a><span data-ttu-id="9c9a3-135">Команда FTP и ее значение</span><span class="sxs-lookup"><span data-stu-id="9c9a3-135">FTP Command and Meaning</span></span>

- <span data-ttu-id="9c9a3-136">**CWD path**: *изменение рабочего каталога*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-136">**CWD path**: *Change working directory*</span></span>
- <span data-ttu-id="9c9a3-137">**DELE filename**: *удаление указанного имени файла*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-137">**DELE filename**: *Delete specified file name*</span></span>
- <span data-ttu-id="9c9a3-138">**LIST directory**: *получение списка каталогов*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-138">**LIST directory**: *Get directory listing*</span></span>
- <span data-ttu-id="9c9a3-139">**MKD directory**: *создание нового каталога*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-139">**MKD directory**: *Make new directory*</span></span>
- <span data-ttu-id="9c9a3-140">**MKD directory**: *получение списка каталогов*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-140">**NLST directory**: *Get directory listing*</span></span>
- <span data-ttu-id="9c9a3-141">**NOOP**: *нет операции, успешное выполнение*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-141">**NOOP**: *No operation, returns success*</span></span>
- <span data-ttu-id="9c9a3-142">**PASS password**: *ввод пароля для входа*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-142">**PASS password**: *Provide password for login*</span></span>
- <span data-ttu-id="9c9a3-143">**PASV**: *запрос пассивного режима передачи*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-143">**PASV**: *Request passive transfer mode*</span></span>
- <span data-ttu-id="9c9a3-144">**PWD path**: *выбор текущего пути к каталогу*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-144">**PWD path**: *Pickup current directory path*</span></span>
- <span data-ttu-id="9c9a3-145">**QUIT**: *завершение подключения клиента*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-145">**QUIT**: *Terminate Client connection*</span></span>
- <span data-ttu-id="9c9a3-146">**RETR filename**: *чтение указанного файла*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-146">**RETR filename**: *Read specified file*</span></span>
- <span data-ttu-id="9c9a3-147">**RMD directory**: *удаление указанного каталога*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-147">**RMD directory**: *Delete specified directory*</span></span>
- <span data-ttu-id="9c9a3-148">**RNFR oldfilename**: *указание файла для переименования*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-148">**RNFR oldfilename**: *Specify file to rename*</span></span>
- <span data-ttu-id="9c9a3-149">**RNTO newfilename**: *переименование имени файла в указанное имя*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-149">**RNTO newfilename**: *Rename file to supplied file name*</span></span>
- <span data-ttu-id="9c9a3-150">**STOR filename**: *запись указанного файла*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-150">**STOR filename**: *Write specified file*</span></span>
- <span data-ttu-id="9c9a3-151">**TYPE I**: *выбор образа двоичного файла*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-151">**TYPE I**: *Select binary file image*</span></span>
- <span data-ttu-id="9c9a3-152">**USER username**: *указание имени пользователя для входа*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-152">**USER username**: *Provide username for login*</span></span>
- <span data-ttu-id="9c9a3-153">**PORT ip_address,port**: *указание IP-адреса и порта данных клиента*</span><span class="sxs-lookup"><span data-stu-id="9c9a3-153">**PORT ip_address,port**: *Provide IP address and Client data port*</span></span>

<span data-ttu-id="9c9a3-154">Эти команды ASCII используются программным обеспечением клиента FTP NetX внутренним образом для выполнения операций FTP с FTP-сервером.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-154">These ASCII commands are used internally by the NetX FTP Client software to perform FTP operations with the FTP Server.</span></span>

## <a name="ftp-server-responses"></a><span data-ttu-id="9c9a3-155">Ответы FTP-сервера</span><span class="sxs-lookup"><span data-stu-id="9c9a3-155">FTP Server Responses</span></span>

<span data-ttu-id="9c9a3-156">FTP-сервер использует *TCP-порт 21* для обработки запросов команд клиента.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-156">The FTP Server utilizes the *well-known TCP port 21* to field Client command requests.</span></span> <span data-ttu-id="9c9a3-157">После обработки команды клиента FTP-сервер возвращает трехзначный цифровой ответ в формате ASCII, за которым следует необязательная строка ASCII.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-157">Once the FTP Server processes the Client command, it returns a 3-digit numeric response in ASCII followed by an optional ASCII string.</span></span> <span data-ttu-id="9c9a3-158">Программное обеспечение клиента использует числовой ответ для определения успешного выполнения операции или ее сбоя.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-158">The numeric response is used by the FTP Client software to determine whether the operation succeeded or failed.</span></span> <span data-ttu-id="9c9a3-159">Ниже перечислены различные ответы FTP-сервера на команды клиента.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-159">The following lists various FTP Server responses to Client commands:</span></span>

### <a name="first-numeric-field-and-meaning"></a><span data-ttu-id="9c9a3-160">Первое числовое поле и значение</span><span class="sxs-lookup"><span data-stu-id="9c9a3-160">First Numeric Field and Meaning</span></span>

- <span data-ttu-id="9c9a3-161">**1xx**: *положительное предварительное состояние, дождитесь следующего ответа*.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-161">**1xx**: *Positive preliminary status – another reply coming*.</span></span>
- <span data-ttu-id="9c9a3-162">**2xx**: *положительное состояние завершения*.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-162">**2xx**: *Positive completion status*.</span></span>
- <span data-ttu-id="9c9a3-163">**3xx**: *положительное предварительное состояние, должна быть отправлена другая команда*.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-163">**3xx**: *Positive preliminary status – another command must be sent*.</span></span>
- <span data-ttu-id="9c9a3-164">**4xx**: *условие возникновения временной ошибки*.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-164">**4xx**: *Temporary error condition*.</span></span>
- <span data-ttu-id="9c9a3-165">**5xx**: *условие возникновения ошибки*.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-165">**5xx**: *Error condition.*</span></span>

### <a name="second-numeric-field-and-meaning"></a><span data-ttu-id="9c9a3-166">Второе числовое поле и значение</span><span class="sxs-lookup"><span data-stu-id="9c9a3-166">Second Numeric Field and Meaning</span></span>

- <span data-ttu-id="9c9a3-167">**x0x**: синтаксическая ошибка в команде.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-167">**x0x**: Syntax error in command.</span></span>
- <span data-ttu-id="9c9a3-168">**x1x**: информационное сообщение.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-168">**x1x**: Informational message.</span></span>
- <span data-ttu-id="9c9a3-169">**x2x**: связано с подключением.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-169">**x2x**: Connection related.</span></span>
- <span data-ttu-id="9c9a3-170">**x3x**: связано с проверкой подлинности.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-170">**x3x**: Authentication related.</span></span>
- <span data-ttu-id="9c9a3-171">**x4x**: не указано.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-171">**x4x**: Unspecified.</span></span>
- <span data-ttu-id="9c9a3-172">**x5x**: связано с файловой системой.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-172">**x5x**: File system related.</span></span>

<span data-ttu-id="9c9a3-173">Например, на запрос клиента на отключение FTP-подключения с помощью команды QUIT сервер обычно дает ответ с кодом 221, означающим успешное отключение.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-173">For example, a Client request to disconnect an FTP connection with the QUIT command will typically be responded with a "221" code from the Server – if the disconnect is successful.</span></span>

## <a name="ftp-passive-transfer-mode"></a><span data-ttu-id="9c9a3-174">Пассивный режим передачи FTP</span><span class="sxs-lookup"><span data-stu-id="9c9a3-174">FTP Passive Transfer Mode</span></span>

<span data-ttu-id="9c9a3-175">По умолчанию FTP-клиент NetX использует активный режим передачи для обмена данными через сокет данных с FTP-сервером.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-175">By default, the NetX FTP Client uses the active transport mode to exchange data over the data socket with the FTP server.</span></span> <span data-ttu-id="9c9a3-176">Проблема этой схемы заключается в том, что для подключения FTP-сервера клиент FTP должен открыть сокет TCP-сервера.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-176">The problem with this arrangement is that it requires the FTP Client to open a TCP server socket for the FTP Server to connect to.</span></span> <span data-ttu-id="9c9a3-177">Такая ситуация представляет потенциальную угрозу безопасности, поэтому эта возможность может быть заблокирована брандмауэром клиента.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-177">This represents a possible security risk and may be blocked by the Client firewall.</span></span> <span data-ttu-id="9c9a3-178">Пассивный режим передачи отличается от активного тем, что FTP-сервер создает сокет TCP-сервера при подключении к данным.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-178">Passive transfer mode differs from active transport mode by having the FTP server create the TCP server socket on the data connection.</span></span> <span data-ttu-id="9c9a3-179">В этом случае риск безопасности отсутствует (для клиента FTP).</span><span class="sxs-lookup"><span data-stu-id="9c9a3-179">This eliminates the security risk (for the FTP Client).</span></span>

<span data-ttu-id="9c9a3-180">Чтобы включить пассивную передачу данных, приложение вызывает *nx_ftp_client_passive_mode_set* в ранее созданном клиенте FTP со вторым аргументом, имеющим значение NX_TRUE.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-180">To enable passive data transfer, the application calls *nx_ftp_client_passive_mode_set* on a previously created FTP Client with the second argument set to NX_TRUE.</span></span> <span data-ttu-id="9c9a3-181">После этого все последующие службы FTP-клиента NetX для передачи данных (NLST, RETR, STOR) выполняются в пассивном режиме передачи.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-181">Thereafter, all subsequent NetX FTP Client services for transferring data (NLST, RETR, STOR) are attempted in the passive transport mode.</span></span>

<span data-ttu-id="9c9a3-182">Сначала FTP-клиент отправляет команду PASV (без аргументов).</span><span class="sxs-lookup"><span data-stu-id="9c9a3-182">The FTP Client first sends the PASV command (no arguments).</span></span> <span data-ttu-id="9c9a3-183">Если FTP-сервер поддерживает этот запрос, он вернет ответ OK 227.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-183">If the FTP server supports this request it will return the 227 "OK" response.</span></span> <span data-ttu-id="9c9a3-184">Затем клиент отправляет запрос, например RETR.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-184">Then the Client sends the request e.g. RETR.</span></span> <span data-ttu-id="9c9a3-185">Если сервер отклоняет пассивный режим передачи, служба FTP-клиента NetX возвращает состояние ошибки.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-185">If the server refuses passive transfer mode, the NetX FTP Client service returns an error status.</span></span>

<span data-ttu-id="9c9a3-186">Чтобы отключить пассивный режим передачи и вернуться в активный режим, приложение вызывает *nx_ftp_client_passive_mode_set* со вторым аргументом, имеющим значение NX_FALSE.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-186">To disable passive transport mode and return to active transport mode, the application calls *nx_ftp_client_passive_mode_set* with the second argument set to NX_FALSE.</span></span>

## <a name="ftp-communication"></a><span data-ttu-id="9c9a3-187">Взаимодействие по FTP</span><span class="sxs-lookup"><span data-stu-id="9c9a3-187">FTP Communication</span></span>

<span data-ttu-id="9c9a3-188">Для обработки запросов клиента FTP-сервер использует *известный TCP-порт 21*.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-188">The FTP Server utilizes the *well-known TCP port 21* to field Client requests.</span></span> <span data-ttu-id="9c9a3-189">Клиенты FTP могут использовать любой доступный TCP-порт.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-189">FTP Clients may use any available TCP port.</span></span> <span data-ttu-id="9c9a3-190">Общая последовательность событий FTP выглядит следующим образом.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-190">The general sequence of FTP events is as follows:</span></span>

### <a name="ftp-read-file-requests"></a><span data-ttu-id="9c9a3-191">Запросы FTP на чтение файлов</span><span class="sxs-lookup"><span data-stu-id="9c9a3-191">FTP Read File Requests</span></span>

1. <span data-ttu-id="9c9a3-192">Клиент отправляет запрос на подключение к TCP-порту 21 сервера.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-192">Client issues TCP connect to Server port 21.</span></span>
1. <span data-ttu-id="9c9a3-193">Сервер отправляет ответ "220", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-193">Server sends "220" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-194">Клиент отправляет сообщение "USER" с "username".</span><span class="sxs-lookup"><span data-stu-id="9c9a3-194">Client sends "USER" message with "username."</span></span>
1. <span data-ttu-id="9c9a3-195">Сервер отправляет ответ "331", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-195">Server sends "331" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-196">Клиент отправляет сообщение "PASS" с "password".</span><span class="sxs-lookup"><span data-stu-id="9c9a3-196">Client sends "PASS" message with "password."</span></span>
1. <span data-ttu-id="9c9a3-197">Сервер отправляет ответ "230", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-197">Server sends "230" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-198">Клиент отправляет сообщение "TYPE I" для передачи двоичных файлов.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-198">Client sends "TYPE I" message for binary transfer.</span></span>
1. <span data-ttu-id="9c9a3-199">Сервер отправляет ответ "200" для сообщения об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-199">Server sends "200" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-200">Клиент отправляет сообщение "PORT" с IP-адресом и портом.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-200">Client sends "PORT" message with IP address and port.</span></span>
1. <span data-ttu-id="9c9a3-201">Сервер отправляет ответ "200" для сообщения об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-201">Server sends "200" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-202">Клиент отправляет сообщение "RETR" с именем файла для чтения.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-202">Client sends "RETR" message with file name to read.</span></span>
1. <span data-ttu-id="9c9a3-203">Сервер создает сокет данных и подключается к порту данных клиента, указанным в команде "PORT".</span><span class="sxs-lookup"><span data-stu-id="9c9a3-203">Server creates data socket and connects with client data port specified in the "PORT" command.</span></span>
1. <span data-ttu-id="9c9a3-204">Сервер отправляет ответ "125", информирующий о начале чтения файла.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-204">Server sends "125" response to signal file read has started.</span></span>
1. <span data-ttu-id="9c9a3-205">Сервер отправляет содержимое файла через подключение к данным.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-205">Server sends contents of file through the data connection.</span></span> <span data-ttu-id="9c9a3-206">Этот процесс продолжается до полной передачи файла.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-206">This process continues until file is completely transferred.</span></span>
1. <span data-ttu-id="9c9a3-207">По завершении сервер разрывает подключение к данным.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-207">When finished, Server disconnects data connection.</span></span>
1. <span data-ttu-id="9c9a3-208">Сервер отправляет ответ "250", информирующий об успешном выполнении чтения файла.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-208">Server sends "250" response to signal file read is successful.</span></span>
1. <span data-ttu-id="9c9a3-209">Клиент отправляют "QUIT" для завершения FTP-подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-209">Clients sends "QUIT" to terminate FTP connection.</span></span>
1. <span data-ttu-id="9c9a3-210">Сервер отправляет ответ "221", информирующий об успешном отключении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-210">Server sends "221" response to signal disconnect is successful.</span></span>
1. <span data-ttu-id="9c9a3-211">Сервер разрывает FTP-подключение.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-211">Server disconnects FTP connection.</span></span>

<span data-ttu-id="9c9a3-212">Как упоминалось ранее, единственное различие между FTP, выполняемым по протоколу IPv4, и FTP, выполняемым по протоколу IPv6, заключается в том, что для IPv6 команда PORT заменяется командой EPRT.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-212">As mentioned previously, the only difference between FTP running over IPv4 and IPv6 is the PORT command is replaced with the EPRT command for IPv6</span></span>

<span data-ttu-id="9c9a3-213">Если клиент FTP отправляет запрос на чтение в пассивном режиме передачи, последовательность команд выглядит указанным ниже образом (строки, выделенные **полужирным шрифтом**, означают действие, отличное от действия в активном режиме передачи).</span><span class="sxs-lookup"><span data-stu-id="9c9a3-213">If the FTP Client makes a read request in the passive transfer mode, the command sequence is as follows (**bolded** lines indicates a different step from active transfer mode):</span></span>

1. <span data-ttu-id="9c9a3-214">Клиент отправляет запрос на подключение к TCP-порту 21 сервера.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-214">Client issues TCP connect to Server port 21.</span></span>
1. <span data-ttu-id="9c9a3-215">Сервер отправляет ответ "220", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-215">Server sends "220" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-216">Клиент отправляет сообщение "USER" с "username".</span><span class="sxs-lookup"><span data-stu-id="9c9a3-216">Client sends "USER" message with "username."</span></span>
1. <span data-ttu-id="9c9a3-217">Сервер отправляет ответ "331", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-217">Server sends "331" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-218">Клиент отправляет сообщение "PASS" с "password".</span><span class="sxs-lookup"><span data-stu-id="9c9a3-218">Client sends "PASS" message with "password."</span></span>
1. <span data-ttu-id="9c9a3-219">Сервер отправляет ответ "230", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-219">Server sends "230" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-220">Клиент отправляет сообщение "TYPE I" для передачи двоичных файлов.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-220">Client sends "TYPE I" message for binary transfer.</span></span>
1. <span data-ttu-id="9c9a3-221">Сервер отправляет ответ "200" для сообщения об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-221">Server sends "200" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-222">**Клиент отправляет сообщение "PASV".**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-222">**Client sends "PASV" message.**</span></span>
1. <span data-ttu-id="9c9a3-223">**Сервер отправляет ответ "227" с IP-адресом и портом для подключения клиента, информирующий об успешном выполнении.**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-223">**Server sends "227" response, and IP address and port for the Client to connect to, to signal success.**</span></span>
1. <span data-ttu-id="9c9a3-224">Клиент отправляет сообщение "RETR" с именем файла для чтения.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-224">Client sends "RETR" message with file name to read.</span></span>
1. <span data-ttu-id="9c9a3-225">**Сервер создает сокет сервера данных и прослушивает на нем запрос на подключение клиента, используя порт, указанный в ответе "227".**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-225">**Server creates data server socket and listens for the Client connect request on this socket using the port specified in the "227" response.**</span></span>
1. <span data-ttu-id="9c9a3-226">**Сервер отправляет ответ "150" на контрольный сокет, информирующий о начале чтения файла.**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-226">**Server sends "150" response on the control socket to signal file read has started.**</span></span>
1. <span data-ttu-id="9c9a3-227">Сервер отправляет содержимое файла через подключение к данным.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-227">Server sends contents of file through the data connection.</span></span> <span data-ttu-id="9c9a3-228">Этот процесс продолжается до полной передачи файла.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-228">This process continues until file is completely transferred.</span></span>
1. <span data-ttu-id="9c9a3-229">По завершении сервер разрывает подключение к данным.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-229">When finished, Server disconnects data connection.</span></span>
1. <span data-ttu-id="9c9a3-230">**Сервер отправляет ответ "226" на контрольный сокет, информирующий об успешном чтении файла.**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-230">**Server sends "226" response on the control socket to signal file read is successful.**</span></span>
1. <span data-ttu-id="9c9a3-231">Клиент отправляют "QUIT" для завершения FTP-подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-231">Client sends "QUIT" to terminate FTP connection.</span></span>
1. <span data-ttu-id="9c9a3-232">Сервер отправляет ответ "221", информирующий об успешном отключении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-232">Server sends "221" response to signal disconnect is successful.</span></span>
1. <span data-ttu-id="9c9a3-233">Сервер разрывает FTP-подключение.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-233">Server disconnects FTP connection.</span></span>

### <a name="ftp-write-requests"></a><span data-ttu-id="9c9a3-234">Запросы FTP на запись</span><span class="sxs-lookup"><span data-stu-id="9c9a3-234">FTP Write Requests</span></span>

1. <span data-ttu-id="9c9a3-235">Клиент отправляет запрос на подключение к TCP-порту 21 сервера.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-235">Client issues TCP connect to Server port 21.</span></span>
1. <span data-ttu-id="9c9a3-236">Сервер отправляет ответ "220", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-236">Server sends "220" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-237">Клиент отправляет сообщение "USER" с "username".</span><span class="sxs-lookup"><span data-stu-id="9c9a3-237">Client sends "USER" message with "username."</span></span>
1. <span data-ttu-id="9c9a3-238">Сервер отправляет ответ "331", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-238">Server sends "331" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-239">Клиент отправляет сообщение "PASS" с "password".</span><span class="sxs-lookup"><span data-stu-id="9c9a3-239">Client sends "PASS" message with "password."</span></span>
1. <span data-ttu-id="9c9a3-240">Сервер отправляет ответ "230", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-240">Server sends "230" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-241">Клиент отправляет сообщение "TYPE I" для передачи двоичных файлов.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-241">Client sends "TYPE I" message for binary transfer.</span></span>
1. <span data-ttu-id="9c9a3-242">Сервер отправляет ответ "200" для сообщения об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-242">Server sends "200" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-243">Клиент отправляет сообщение "PORT" с IP-адресом и портом.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-243">Client sends "PORT" message with IP address and port.</span></span>
1. <span data-ttu-id="9c9a3-244">Сервер отправляет ответ "200" для сообщения об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-244">Server sends "200" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-245">Клиент отправляет сообщение "STOR" с именем файла для чтения.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-245">Client sends "STOR" message with file name to write.</span></span>
1. <span data-ttu-id="9c9a3-246">Сервер создает сокет данных и подключается к порту данных клиента, указанным в команде "PORT".</span><span class="sxs-lookup"><span data-stu-id="9c9a3-246">Server creates data socket and connects with client data port specified in the "PORT" command.</span></span>
1. <span data-ttu-id="9c9a3-247">Сервер отправляет ответ "125", информирующий о начале записи файла.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-247">Server sends "125" response to signal file write has started.</span></span>
1. <span data-ttu-id="9c9a3-248">Клиент отправляет содержимое файла через подключение к данным.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-248">Client sends contents of file through the data connection.</span></span> <span data-ttu-id="9c9a3-249">Этот процесс продолжается до полной передачи файла.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-249">This process continues until file is completely transferred.</span></span>
1. <span data-ttu-id="9c9a3-250">По завершении клиент разрывает подключение к данным.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-250">When finished, Client disconnects data connection.</span></span>
1. <span data-ttu-id="9c9a3-251">Сервер отправляет ответ "250", информирующий об успешном выполнении записи файла.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-251">Server sends "250" response to signal file write is successful.</span></span>
1. <span data-ttu-id="9c9a3-252">Клиент отправляют "QUIT" для завершения FTP-подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-252">Clients sends "QUIT" to terminate FTP connection.</span></span>
1. <span data-ttu-id="9c9a3-253">Сервер отправляет ответ "221", информирующий об успешном отключении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-253">Server sends "221" response to signal disconnect is successful.</span></span>
1. <span data-ttu-id="9c9a3-254">Сервер разрывает FTP-подключение.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-254">Server disconnects FTP connection.</span></span>

<span data-ttu-id="9c9a3-255">Если клиент FTP отправляет запрос на запись в пассивном режиме передачи, последовательность команд выглядит указанным ниже образом (строки, выделенные **полужирным шрифтом**, означают действие, отличное от действия в активном режиме передачи).</span><span class="sxs-lookup"><span data-stu-id="9c9a3-255">If the FTP Client makes a write request in the passive transfer mode, the command sequence is as follows (**bolded** lines indicates a different step from active transfer mode):</span></span>

1. <span data-ttu-id="9c9a3-256">Клиент отправляет запрос на подключение к TCP-порту 21 сервера.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-256">Client issues TCP connect to Server port 21.</span></span>
1. <span data-ttu-id="9c9a3-257">Сервер отправляет ответ "220", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-257">Server sends "220" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-258">Клиент отправляет сообщение "USER" с "username".</span><span class="sxs-lookup"><span data-stu-id="9c9a3-258">Client sends "USER" message with "username."</span></span>
1. <span data-ttu-id="9c9a3-259">Сервер отправляет ответ "331", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-259">Server sends "331" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-260">Клиент отправляет сообщение "PASS" с "password".</span><span class="sxs-lookup"><span data-stu-id="9c9a3-260">Client sends "PASS" message with "password."</span></span>
1. <span data-ttu-id="9c9a3-261">Сервер отправляет ответ "230", информирующий об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-261">Server sends "230" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-262">Клиент отправляет сообщение "TYPE I" для передачи двоичных файлов.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-262">Client sends "TYPE I" message for binary transfer.</span></span>
1. <span data-ttu-id="9c9a3-263">Сервер отправляет ответ "200" для сообщения об успешном выполнении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-263">Server sends "200" response to signal success.</span></span>
1. <span data-ttu-id="9c9a3-264">**Клиент отправляет сообщение "PASV".**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-264">**Client sends "PASV" message.**</span></span>
1. <span data-ttu-id="9c9a3-265">**Сервер отправляет ответ "227" с IP-адресом и портом для подключения клиента, информирующий об успешном выполнении.**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-265">**Server sends "227" response, and IP address and port for the Client to connect to, to signal success.**</span></span>
1. <span data-ttu-id="9c9a3-266">Клиент отправляет сообщение "STOR" с именем файла для чтения.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-266">Client sends "STOR" message with file name to write.</span></span>
1. <span data-ttu-id="9c9a3-267">**Сервер создает сокет сервера данных и прослушивает на нем запрос на подключение клиента, используя порт, указанный в ответе "227".**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-267">**Server creates data server socket and listens for the Client connect request on this socket using the port specified in the "227" response.**</span></span>
1. <span data-ttu-id="9c9a3-268">**Сервер отправляет ответ "150" на контрольный сокет, информирующий о начале записи файла.**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-268">**Server sends "150" response on the control socket to signal file write has started.**</span></span>
1. <span data-ttu-id="9c9a3-269">Клиент отправляет содержимое файла через подключение к данным.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-269">Client sends contents of file through the data connection.</span></span> <span data-ttu-id="9c9a3-270">Этот процесс продолжается до полной передачи файла.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-270">This process continues until file is completely transferred.</span></span>
1. <span data-ttu-id="9c9a3-271">По завершении клиент разрывает подключение к данным.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-271">When finished, Client disconnects data connection.</span></span>
1. <span data-ttu-id="9c9a3-272">**Сервер отправляет ответ "226" на контрольный сокет, информирующий об успешной записи файла.**</span><span class="sxs-lookup"><span data-stu-id="9c9a3-272">**Server sends "226" response on the control socket to signal file write is successful.**</span></span>
1. <span data-ttu-id="9c9a3-273">Клиент отправляют "QUIT" для завершения FTP-подключения.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-273">Client sends "QUIT" to terminate FTP connection.</span></span>
1. <span data-ttu-id="9c9a3-274">Сервер отправляет ответ "221", информирующий об успешном отключении.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-274">Server sends "221" response to signal disconnect is successful.</span></span>
1. <span data-ttu-id="9c9a3-275">Сервер разрывает FTP-подключение.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-275">Server disconnects FTP connection.</span></span>

## <a name="ftp-authentication"></a><span data-ttu-id="9c9a3-276">FTP Authentication</span><span class="sxs-lookup"><span data-stu-id="9c9a3-276">FTP Authentication</span></span>

<span data-ttu-id="9c9a3-277">При каждом FTP-подключении клиент должен предоставить серверу *имя пользователя* и *пароль*.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-277">Whenever an FTP connection takes place, the Client must provide the Server with a *username* and *password*.</span></span> <span data-ttu-id="9c9a3-278">Некоторые FTP-сайты поддерживают так называемый *анонимный доступ к FTP*, который разрешает доступ к FTP без определенного имени пользователя и пароля.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-278">Some FTP sites allow what is called *Anonymous FTP*, which allows FTP access without a specific username and password.</span></span> <span data-ttu-id="9c9a3-279">Для этого типа подключения в качестве имени пользователя должно быть указано anonymous, а пароль должен быть полным адресом электронной почты.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-279">For this type of connection, "anonymous" should be supplied for username and the password should be a complete e-mail address.</span></span>

<span data-ttu-id="9c9a3-280">Пользователь несет ответственность за предоставление FTP NetX подпрограмм проверки подлинности входа и выхода.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-280">The user is responsible for supplying NetX FTP with login and logout authentication routines.</span></span> <span data-ttu-id="9c9a3-281">Они предоставляются во время функции \***nx_ftp_server_create** _ и вызываются из обработки пароля.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-281">These are supplied during the \***nx_ftp_server_create** _ function and called from the password processing.</span></span> <span data-ttu-id="9c9a3-282">Если функция _login\* возвращает NX_SUCCESS, значит, подключение прошло проверку подлинности и операции FTP разрешены.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-282">If the _login\* function returns NX_SUCCESS, the connection is authenticated and FTP operations are allowed.</span></span> <span data-ttu-id="9c9a3-283">В противном случае, если функция *входа в систему* возвращает нечто, отличное от NX_SUCCESS, попытка подключения отклоняется.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-283">Otherwise, if the *login* function returns something other than NX_SUCCESS, the connection attempt is rejected.</span></span>

## <a name="ftp-multi-thread-support"></a><span data-ttu-id="9c9a3-284">Поддержка нескольких потоков FTP</span><span class="sxs-lookup"><span data-stu-id="9c9a3-284">FTP Multi-Thread Support</span></span>

<span data-ttu-id="9c9a3-285">Службы клиента FTP NetX можно вызывать из нескольких потоков одновременно.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-285">The NetX FTP Client services can be called from multiple threads simultaneously.</span></span> <span data-ttu-id="9c9a3-286">Однако запросы на чтение или запись для конкретного экземпляра клиента FTP должны выполняться последовательно из одного потока.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-286">However, read or write requests for a particular FTP Client instance should be done in sequence from the same thread.</span></span>

## <a name="ftp-rfcs"></a><span data-ttu-id="9c9a3-287">Стандарты RFC для протокола FTP</span><span class="sxs-lookup"><span data-stu-id="9c9a3-287">FTP RFCs</span></span>

<span data-ttu-id="9c9a3-288">FTP NetX соответствует стандарту RFC959 и другим связанным стандартам RFC.</span><span class="sxs-lookup"><span data-stu-id="9c9a3-288">NetX FTP is compliant with RFC959 and related RFCs.</span></span>