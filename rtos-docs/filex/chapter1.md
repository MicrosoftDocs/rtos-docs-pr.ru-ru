---
title: Глава 1. Знакомство с FileX в ОСРВ Azure
description: FileX в ОСРВ Azure — это полноценная система управления файлами и носителями в формате FAT для глубоко внедренных приложений.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: be7e6f9cd9fbc69ac0908d1de733dac1c4f73bf6
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104814399"
---
# <a name="chapter-1---introduction-to-azure-rtos-filex"></a><span data-ttu-id="05e97-103">Глава 1. Знакомство с FileX в ОСРВ Azure</span><span class="sxs-lookup"><span data-stu-id="05e97-103">Chapter 1 - Introduction to Azure RTOS FileX</span></span>

<span data-ttu-id="05e97-104">FileX в ОСРВ Azure — это полноценная система управления файлами и носителями в формате FAT для глубоко внедренных приложений.</span><span class="sxs-lookup"><span data-stu-id="05e97-104">Azure RTOS FileX is a complete FAT format media and file management system for deeply embedded applications.</span></span> <span data-ttu-id="05e97-105">В этой главе представлены основные сведения о FileX, в том числе области применения и преимущества.</span><span class="sxs-lookup"><span data-stu-id="05e97-105">This chapter introduces FileX, describing its applications and benefits.</span></span>

## <a name="filex-unique-features"></a><span data-ttu-id="05e97-106">Уникальные функции FileX</span><span class="sxs-lookup"><span data-stu-id="05e97-106">FileX Unique Features</span></span>

<span data-ttu-id="05e97-107">Компонент FileX в ОСРВ Azure поддерживает неограниченное количество устройств хранения данных одновременно, включая электронные диски, диспетчеры флэш-памяти и непосредственно физические устройства.</span><span class="sxs-lookup"><span data-stu-id="05e97-107">Azure RTOS FileX supports an unlimited number of media devices at the same time, including RAM disks, FLASH managers, and actual physical devices.</span></span> <span data-ttu-id="05e97-108">Он поддерживает 12-, 16- и 32-битные форматы FAT, а также exFAT, непрерывное распределение файлов и хорошо оптимизирован как с точки зрения размера, так и с точки зрения производительности.</span><span class="sxs-lookup"><span data-stu-id="05e97-108">It supports 12-, 16-, and 32-bit File Allocation Table (FAT) formats, and also supports Extended File Allocation Table (exFAT), contiguous file allocation, and is highly optimized for both size and performance.</span></span> <span data-ttu-id="05e97-109">FileX также включает в себя поддержку отказоустойчивости, функции открытия/закрытия носителя и обратного вызова записи файла.</span><span class="sxs-lookup"><span data-stu-id="05e97-109">FileX also includes fault tolerant support, media open/ close, and file write callback functions.</span></span>

<span data-ttu-id="05e97-110">Предназначенный для удовлетворения растущих потребностей в устройствах флэш-памяти, FileX использует те же методы проектирования и программирования, что и ThreadX.</span><span class="sxs-lookup"><span data-stu-id="05e97-110">Designed to meet the growing need for FLASH devices, FileX uses the same design and coding methods as ThreadX.</span></span> <span data-ttu-id="05e97-111">Как и все продукты Майкрософт, FileX распространяется с полным исходным кодом ANSI C и не имеет лицензионных отчислений за время выполнения.</span><span class="sxs-lookup"><span data-stu-id="05e97-111">Like all Microsoft products, FileX is distributed with full ANSI C source code, and it has no run-time royalties.</span></span>

### <a name="product-highlights"></a><span data-ttu-id="05e97-112">Особенности продукта</span><span class="sxs-lookup"><span data-stu-id="05e97-112">Product Highlights</span></span>

- <span data-ttu-id="05e97-113">Полная поддержка процессора ThreadX.</span><span class="sxs-lookup"><span data-stu-id="05e97-113">Complete ThreadX processor support</span></span>
- <span data-ttu-id="05e97-114">Отсутствие лицензионных отчислений.</span><span class="sxs-lookup"><span data-stu-id="05e97-114">No royalties</span></span>
- <span data-ttu-id="05e97-115">Полный исходный код ANSI C.</span><span class="sxs-lookup"><span data-stu-id="05e97-115">Complete ANSI C source code</span></span>
- <span data-ttu-id="05e97-116">Производительность в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="05e97-116">Real-time performance</span></span>
- <span data-ttu-id="05e97-117">Быстрая техническая поддержка.</span><span class="sxs-lookup"><span data-stu-id="05e97-117">Responsive technical support</span></span>
- <span data-ttu-id="05e97-118">Неограниченные объекты FileX (носители, каталоги и файлы).</span><span class="sxs-lookup"><span data-stu-id="05e97-118">Unlimited FileX objects (media, directories, and files)</span></span>
- <span data-ttu-id="05e97-119">Динамическое создание или удаление объектов FileX.</span><span class="sxs-lookup"><span data-stu-id="05e97-119">Dynamic FileX object creation/deletion</span></span>
- <span data-ttu-id="05e97-120">Гибкое использование памяти.</span><span class="sxs-lookup"><span data-stu-id="05e97-120">Flexible memory usage</span></span>
- <span data-ttu-id="05e97-121">Автоматическое масштабирование размера.</span><span class="sxs-lookup"><span data-stu-id="05e97-121">Size scales automatically</span></span>
- <span data-ttu-id="05e97-122">Малый объем памяти (всего 6 КБ), занимаемой областью хранения команд: 6–30 КБ.</span><span class="sxs-lookup"><span data-stu-id="05e97-122">Small footprint (as low as 6 KBytes) instruction area size: 6-30K</span></span>
- <span data-ttu-id="05e97-123">Полная интеграция с ThreadX.</span><span class="sxs-lookup"><span data-stu-id="05e97-123">Complete integration with ThreadX</span></span>
- <span data-ttu-id="05e97-124">Независимость от порядка байтов.</span><span class="sxs-lookup"><span data-stu-id="05e97-124">Endian neutral</span></span>
- <span data-ttu-id="05e97-125">Простые в реализации драйверы ввода-вывода FileX.</span><span class="sxs-lookup"><span data-stu-id="05e97-125">Easy-to-implement FileX I/O drivers</span></span>
- <span data-ttu-id="05e97-126">Поддержка 12-, 16- и 32-разрядных систем FAT.</span><span class="sxs-lookup"><span data-stu-id="05e97-126">12-, 16-, and 32-bit FAT support</span></span>
- <span data-ttu-id="05e97-127">Поддержка exFAT.</span><span class="sxs-lookup"><span data-stu-id="05e97-127">exFAT support</span></span>
- <span data-ttu-id="05e97-128">Поддержка длинных имен файлов.</span><span class="sxs-lookup"><span data-stu-id="05e97-128">Long filename support</span></span>
- <span data-ttu-id="05e97-129">Внутренний кэш записей FAT.</span><span class="sxs-lookup"><span data-stu-id="05e97-129">Internal FAT entry cache</span></span>
- <span data-ttu-id="05e97-130">Поддержка имен в Юникоде.</span><span class="sxs-lookup"><span data-stu-id="05e97-130">Unicode name support</span></span>
- <span data-ttu-id="05e97-131">Непрерывное распределение файлов.</span><span class="sxs-lookup"><span data-stu-id="05e97-131">Contiguous file allocation</span></span>
- <span data-ttu-id="05e97-132">Последовательные чтение и запись сектора и кластера.</span><span class="sxs-lookup"><span data-stu-id="05e97-132">Consecutive sector and cluster read/write</span></span>
- <span data-ttu-id="05e97-133">Внутренний кэш логических секторов.</span><span class="sxs-lookup"><span data-stu-id="05e97-133">Internal logical sector cache</span></span>
- <span data-ttu-id="05e97-134">Готовая демонстрация электронного диска.</span><span class="sxs-lookup"><span data-stu-id="05e97-134">RAM disk demonstration runs out-of-the-box</span></span>
- <span data-ttu-id="05e97-135">Возможность форматирования носителя.</span><span class="sxs-lookup"><span data-stu-id="05e97-135">Media format capability</span></span>
- <span data-ttu-id="05e97-136">Обнаружение ошибок и восстановление.</span><span class="sxs-lookup"><span data-stu-id="05e97-136">Error detection and recovery</span></span>
- <span data-ttu-id="05e97-137">Функции отказоустойчивости.</span><span class="sxs-lookup"><span data-stu-id="05e97-137">Fault tolerant options</span></span>
- <span data-ttu-id="05e97-138">Встроенная статистика производительности.</span><span class="sxs-lookup"><span data-stu-id="05e97-138">Built-in performance statistics</span></span>
- <span data-ttu-id="05e97-139">Поддержка автономной работы (без ОСРВ Azure).</span><span class="sxs-lookup"><span data-stu-id="05e97-139">Standalone support (No Azure RTOS)</span></span>

## <a name="safety-certifications"></a><span data-ttu-id="05e97-140">Сертификация по безопасности</span><span class="sxs-lookup"><span data-stu-id="05e97-140">Safety Certifications</span></span>

### <a name="tv-certification"></a><span data-ttu-id="05e97-141">Сертификация TÜV</span><span class="sxs-lookup"><span data-stu-id="05e97-141">TÜV Certification</span></span>

<span data-ttu-id="05e97-142">Решение FileX сертифицировано организацией SGS-TÜV Saar для использования в критических для безопасности систем в соответствии со стандартами IEC-61508 и IEC-62304.</span><span class="sxs-lookup"><span data-stu-id="05e97-142">FileX has been certified by SGS-TÜV Saar for use in safety-critical systems, according to IEC-61508 and IEC-62304.</span></span> <span data-ttu-id="05e97-143">Такая сертификация гарантирует, что FileX можно использовать при разработке программного обеспечения с особыми требованиями к высочайшим уровням защиты целостности в соответствии со стандартами IEC-61508 и IEC-62304 для "функциональной безопасности электрических, электронных и программируемых электронных систем, связанных с безопасностью".</span><span class="sxs-lookup"><span data-stu-id="05e97-143">The certification confirms that FileX can be used in the development of safety-related software for the highest safety integrity levels of the International Electrotechnical Commission (IEC) 61508 and IEC 62304, for the "Functional Safety of electrical, electronic, and programmable electronic safety-related systems."</span></span> <span data-ttu-id="05e97-144">Компания SGS-TÜV Saar, основанная совместно немецкими компаниями SGS-Group и TÜV Saarland, стала ведущей аккредитованной и независимой компанией, выполняющей тестирование, аудит, проверку и сертификацию встраиваемого ПО для связанных с безопасностью систем.</span><span class="sxs-lookup"><span data-stu-id="05e97-144">SGS-TÜV Saar, formed through a joint venture of Germany's SGS-Group and TÜV Saarland, has become the leading accredited, independent company for testing, auditing, verifying, and certifying embedded software for safety-related systems worldwide.</span></span> <span data-ttu-id="05e97-145">Соответствие промышленному стандарту безопасности IEC 61508 и всем его производным стандартам, в том числе IEC-62304, гарантирует функциональную безопасность электрических, электронных и программируемых электронных медицинских изделий, систем управления процессами, промышленного оборудования и систем управления железнодорожными перевозками с высоким уровнем защиты.</span><span class="sxs-lookup"><span data-stu-id="05e97-145">The industrial safety standard IEC 61508, and all standards that are derived from it, including IEC 62304, are used to assure the functional safety of electrical, electronic, and programmable electronic safety-related medical devices, process control systems, industrial machinery, and railway control systems.</span></span>

<span data-ttu-id="05e97-146">Компания SGS-TÜV Saar сертифицировала FileX для использования в критических для безопасности системах автомобилестроения в соответствии со стандартом ISO 26262.</span><span class="sxs-lookup"><span data-stu-id="05e97-146">SGS-TÜV Saar has certified FileX to be used in safety-critical automotive systems, according to the ISO 26262 standard.</span></span> <span data-ttu-id="05e97-147">Более того, решение FileX сертифицировано согласно классификации Automotive Safety Integrity Level D (ASIL), которая соответствует высочайшему уровню сертификации ISO 26262.</span><span class="sxs-lookup"><span data-stu-id="05e97-147">Furthermore, FileX is certified to Automotive Safety Integrity Level (ASIL) D, which represents the highest level of ISO 26262 certification.</span></span>

<span data-ttu-id="05e97-148">Кроме того, компания SGS-TÜV Saar сертифицировала FileX для использования в критических для безопасности приложениях для железнодорожного сообщения в соответствии со стандартом EN 50128 вплоть до уровня SW-SIL 4.</span><span class="sxs-lookup"><span data-stu-id="05e97-148">In addition, SGS-TÜV Saar has certified FileX to be used in safety-critical railway applications, meeting to the EN 50128 standard up to SW-SIL 4.</span></span>

![Логотип SGS TUV Saar](./media/user-guide/sgs-tuv-saar-logo.png)

- <span data-ttu-id="05e97-150">IEC 61508 до уровня SIL 4</span><span class="sxs-lookup"><span data-stu-id="05e97-150">IEC 61508 up to SIL 4</span></span>
- <span data-ttu-id="05e97-151">IEC 62304 до уровня SW класса безопасности C</span><span class="sxs-lookup"><span data-stu-id="05e97-151">IEC 62304 up to SW safety Class C</span></span>
- <span data-ttu-id="05e97-152">ISO 26262 ASIL D</span><span class="sxs-lookup"><span data-stu-id="05e97-152">ISO 26262 ASIL D</span></span>
- <span data-ttu-id="05e97-153">EN 50128 SW-SIL 4</span><span class="sxs-lookup"><span data-stu-id="05e97-153">EN 50128 SW-SIL 4</span></span>

> [!IMPORTANT]
> <span data-ttu-id="05e97-154">Обратившись к нам, вы можете получить дополнительные сведения о версиях FileX, которые прошли сертификацию TÜV, а также копии доступных отчетов о тестах, сертификатов и других документов.\*</span><span class="sxs-lookup"><span data-stu-id="05e97-154">Please contact us for more information on which version(s) of FileX have been certified by TÜV or for the availability of test reports, certificates, and associated documentation.\*</span></span>

### <a name="ul-certification"></a><span data-ttu-id="05e97-155">Сертификация UL</span><span class="sxs-lookup"><span data-stu-id="05e97-155">UL Certification</span></span>

<span data-ttu-id="05e97-156">Решение FileX сертифицировано организацией UL как соответствующее стандартам безопасности UL 60730-1 (приложение H), CSA E60730-1 (приложение H), IEC 60730-1 (приложение H), UL 60335-1 (приложение R), IEC 603351 (приложение R) и UL 1998 для программного обеспечения в программируемых компонентах.</span><span class="sxs-lookup"><span data-stu-id="05e97-156">FileX has been certified by UL for compliance with UL 60730-1 Annex H, CSA E60730-1 Annex H, IEC  60730-1 Annex H, UL 60335-1 Annex R, IEC 603351 Annex R, and UL 1998 safety standards for software in programmable components.</span></span> <span data-ttu-id="05e97-157">В дополнение к стандарту IEC/UL 60730-1, который в приложении H содержит требования к управлению с использованием программного обеспечения, стандарт IEC 60335-1 описывает в приложении R требования к программируемым электронным цепям. В IEC 60730 (приложение H) и IEC 60335-1 (приложение R) обсуждается безопасность программного и аппаратного обеспечения микроконтроллеров, используемых в разных устройствах, таких как стиральные, посудомоечные и сушильные машины, а также холодильные, морозильные и духовые шкафы.</span><span class="sxs-lookup"><span data-stu-id="05e97-157">Along with IEC/UL 60730-1, which has requirements for  "Controls Using Software" in its Annex H, the IEC 60335-1 standard describes the requirements for "Programmable Electronic Circuits" in its Annex R. IEC 60730 Annex H and IEC 60335-1 Annex R address the safety of MCU hardware and software used in appliances such as washing machines, dishwashers, dryers, refrigerators, freezers, and ovens.</span></span>

![C RU US 2](./media/user-guide/c-ru-us-logo.png)

<span data-ttu-id="05e97-159">*UL/IEC 60730, UL/IEC 60335, UL 1998*</span><span class="sxs-lookup"><span data-stu-id="05e97-159">*UL/IEC 60730, UL/IEC 60335, UL 1998*</span></span>

> [!IMPORTANT]
><span data-ttu-id="05e97-160">*Обратившись к нам, вы можете получить дополнительные сведения о версиях FileX, которые прошли сертификацию UL, а также копии доступных отчетов о тестах, сертификатов и других документов.*</span><span class="sxs-lookup"><span data-stu-id="05e97-160">*Please contact us for more information on which version(s) of FileX have been certified by UL or for the availability of test reports, certificates, and associated documentation.*</span></span>

## <a name="powerful-services-of-filex"></a><span data-ttu-id="05e97-161">Многофункциональные службы FileX</span><span class="sxs-lookup"><span data-stu-id="05e97-161">Powerful Services of FileX</span></span>

### <a name="multiple-media-management"></a><span data-ttu-id="05e97-162">Управление несколькими носителями</span><span class="sxs-lookup"><span data-stu-id="05e97-162">Multiple Media Management</span></span>

<span data-ttu-id="05e97-163">FileX может поддерживать неограниченное число физических носителей.</span><span class="sxs-lookup"><span data-stu-id="05e97-163">FileX can support an unlimited number of physical media.</span></span> <span data-ttu-id="05e97-164">Каждый экземпляр носителя имеет собственную отдельную область памяти и соответствующий драйвер, указанный в вызове ***fx_media_open***.</span><span class="sxs-lookup"><span data-stu-id="05e97-164">Each media instance has its own distinct memory area and associated driver specified on the ***fx_media_open*** call.</span></span> <span data-ttu-id="05e97-165">Дистрибутив FileX по умолчанию содержит простой драйвер электронного носителя (размещаемого в ОЗУ), а также демонстрационную систему, использующую этот электронный диск.</span><span class="sxs-lookup"><span data-stu-id="05e97-165">The default distribution of FileX comes with a simple RAM media driver and a demonstration system that uses this RAM disk.</span></span>

### <a name="logical-sector-cache"></a><span data-ttu-id="05e97-166">Кэш логических секторов</span><span class="sxs-lookup"><span data-stu-id="05e97-166">Logical Sector Cache</span></span>

<span data-ttu-id="05e97-167">Кэш логических секторов FileX значительно повышает производительность, снижая число передач полных секторов как на носитель, так и с него.</span><span class="sxs-lookup"><span data-stu-id="05e97-167">By reducing the number of whole sector transfers, both to and from the media, the FileX logical sector cache significantly improves performance.</span></span> <span data-ttu-id="05e97-168">FileX поддерживает кэш логических секторов для каждого открытого носителя.</span><span class="sxs-lookup"><span data-stu-id="05e97-168">FileX maintains a logical sector cache for each opened media.</span></span> <span data-ttu-id="05e97-169">Глубина кэша логических секторов определяется объемом памяти, предоставленным FileX вызовом API ***fx_media_open***.</span><span class="sxs-lookup"><span data-stu-id="05e97-169">The depth of the logical sector cache is determined by the amount of memory supplied to FileX with the ***fx_media_open*** API call.</span></span>

### <a name="contiguous-file-support"></a><span data-ttu-id="05e97-170">Поддержка непрерывных файлов</span><span class="sxs-lookup"><span data-stu-id="05e97-170">Contiguous File Support</span></span>

<span data-ttu-id="05e97-171">FileX предоставляет поддержку непрерывную файлов с помощью службы API ***fx_file_allocate***, чтобы улучшить время доступа к файлу и сделать его детерминированным.</span><span class="sxs-lookup"><span data-stu-id="05e97-171">FileX offers contiguous file support through the API service ***fx_file_allocate*** to improve and make file access time deterministic.</span></span> <span data-ttu-id="05e97-172">Эта процедура принимает запрошенный объем памяти и ищет ряд смежных кластеров для удовлетворения запроса.</span><span class="sxs-lookup"><span data-stu-id="05e97-172">This routine takes the amount of memory requested and looks for a series of adjacent clusters to satisfy the request.</span></span> <span data-ttu-id="05e97-173">Если такие кластеры найдены, они предварительно выделяются, что делает их частью цепочки выделенных кластеров для файла.</span><span class="sxs-lookup"><span data-stu-id="05e97-173">If such clusters are found, they are pre-allocated by making them part of the file's chain of allocated clusters.</span></span> <span data-ttu-id="05e97-174">При перемещении физического носителя поддержка непрерывных файлов FileX обеспечивает значительное повышение производительности и делает время доступа детерминированным.</span><span class="sxs-lookup"><span data-stu-id="05e97-174">On moving physical media, the FileX contiguous file support results in a significant performance improvement and makes the access time deterministic.</span></span>

### <a name="dynamic-creation"></a><span data-ttu-id="05e97-175">Динамическое создание</span><span class="sxs-lookup"><span data-stu-id="05e97-175">Dynamic Creation</span></span>

<span data-ttu-id="05e97-176">FileX позволяет динамически создавать системные ресурсы.</span><span class="sxs-lookup"><span data-stu-id="05e97-176">FileX allows you to create system resources dynamically.</span></span> <span data-ttu-id="05e97-177">Это особенно важно, если приложение имеет различные или динамические требования к конфигурации.</span><span class="sxs-lookup"><span data-stu-id="05e97-177">This is especially important if your application has multiple or dynamic configuration requirements.</span></span> <span data-ttu-id="05e97-178">Кроме того, не существует заранее установленных ограничений на количество ресурсов FileX, которые можно использовать (носители или файлы).</span><span class="sxs-lookup"><span data-stu-id="05e97-178">In addition, there are no predetermined limits on the number of FileX resources you can use (media or files).</span></span> <span data-ttu-id="05e97-179">Кроме того, количество системных объектов не влияет на производительность.</span><span class="sxs-lookup"><span data-stu-id="05e97-179">Also, the number of system objects does not have any impact on performance.</span></span>

## <a name="easy-to-use-api"></a><span data-ttu-id="05e97-180">Простые в использовании API-интерфейсы</span><span class="sxs-lookup"><span data-stu-id="05e97-180">Easy-to-use API</span></span>

<span data-ttu-id="05e97-181">FileX предоставляет лучшую глубоко внедренную технологию файловой системы, которую при этом легко изучить и использовать.</span><span class="sxs-lookup"><span data-stu-id="05e97-181">FileX provides the very best deeply embedded file system technology in a manner that is easy to understand and easy to use!</span></span> <span data-ttu-id="05e97-182">Программный интерфейс (API) FileX обеспечивает интуитивную простоту и согласованность при работе со службами.</span><span class="sxs-lookup"><span data-stu-id="05e97-182">The FileX Application Programming Interface (API) makes the services intuitive and consistent.</span></span> <span data-ttu-id="05e97-183">Вам не придется расшифровать службы из "набора букв", которые слишком часто встречаются в других файловых системах.</span><span class="sxs-lookup"><span data-stu-id="05e97-183">You won't have to decipher "alphabet soup" services that are all too common with other file systems.</span></span>

<span data-ttu-id="05e97-184">Полный список служб FileX версии 5 см. в [приложении A](appendix-a.md).</span><span class="sxs-lookup"><span data-stu-id="05e97-184">For a complete list of the FileX Version 5 Services, see [Appendix A](appendix-a.md).</span></span>

## <a name="exfat-support"></a><span data-ttu-id="05e97-185">Поддержка exFAT</span><span class="sxs-lookup"><span data-stu-id="05e97-185">exFAT Support</span></span>

<span data-ttu-id="05e97-186">exFAT (расширенная таблица распределения файлов) — это файловая система, разработанная корпорацией Майкрософт и поддерживающая файлы размером свыше 2 ГБ, что было ограничением для файловой системы FAT32.</span><span class="sxs-lookup"><span data-stu-id="05e97-186">exFAT (extended File Allocation Table) is a file system designed by Microsoft to allow file size to exceed 2GB, a limit imposed by FAT32 file systems.</span></span> <span data-ttu-id="05e97-187">Это файловая система по умолчанию для SD-карт емкостью свыше 32 ГБ.</span><span class="sxs-lookup"><span data-stu-id="05e97-187">It is the default file system for SD cards with capacity over 32GB.</span></span> <span data-ttu-id="05e97-188">SD-карты или устройства флэш-памяти, отформатированные с использованием формата exFAT FileX, совместимы с Windows.</span><span class="sxs-lookup"><span data-stu-id="05e97-188">SD cards or flash drives formatted with FileX exFAT format are compatible with Windows.</span></span> <span data-ttu-id="05e97-189">exFAT поддерживает размер файла до одного эксабайта (ЭБ), который составляет примерно 1 000 000 000 ГБ.</span><span class="sxs-lookup"><span data-stu-id="05e97-189">exFAT supports file size up to one Exabyte (EB), which is approximately one billion GB.</span></span>

<span data-ttu-id="05e97-190">Пользователи, желающие использовать exFAT, должны перекомпилировать библиотеку FileX с заданным символом \***FX_ENABLE_EXFAT** _.</span><span class="sxs-lookup"><span data-stu-id="05e97-190">Users wishing to use exFAT must recompile the FileX library with the symbol \***FX_ENABLE_EXFAT** _ defined.</span></span> <span data-ttu-id="05e97-191">При открытии носителя FileX определяет его тип.</span><span class="sxs-lookup"><span data-stu-id="05e97-191">When opening media, FileX detects the media type.</span></span> <span data-ttu-id="05e97-192">Если носитель отформатирован с использованием exFAT, FileX осуществляет чтение и запись в файловой системе согласно стандарту exFAT.</span><span class="sxs-lookup"><span data-stu-id="05e97-192">If the media is formatted with exFAT, FileX reads and writes the file system following exFAT standard.</span></span> <span data-ttu-id="05e97-193">Чтобы отформатировать новый носитель с использованием exFAT, используйте службу _\*_fx_media_exFAT_format_\*\*.</span><span class="sxs-lookup"><span data-stu-id="05e97-193">To format new media with exFAT, use the service _\*_fx_media_exFAT_format_\*\*.</span></span> <span data-ttu-id="05e97-194">По умолчанию файловая система exFAT отключена.</span><span class="sxs-lookup"><span data-stu-id="05e97-194">By default exFAT is not enabled.</span></span>

## <a name="fault-tolerant-support"></a><span data-ttu-id="05e97-195">Поддержка отказоустойчивости</span><span class="sxs-lookup"><span data-stu-id="05e97-195">Fault Tolerant Support</span></span>

<span data-ttu-id="05e97-196">Модуль отказоустойчивости FileX предназначен для предотвращения повреждения файловой системы, вызванного прерываниями при изменении файла или каталога.</span><span class="sxs-lookup"><span data-stu-id="05e97-196">The FileX Fault Tolerant Module is designed to prevent file system corruption caused by interruptions during the file or directory update.</span></span> <span data-ttu-id="05e97-197">Например, при добавлении данных в файл FileX нужно изменить содержимое файла, запись каталога и, возможно, записи в файловой системе FAT.</span><span class="sxs-lookup"><span data-stu-id="05e97-197">For example, when appending data to a file, FileX needs to update the content of the file, the directory entry, and possibly the FAT entries.</span></span> <span data-ttu-id="05e97-198">Если эта последовательность изменения была прервана (например, из-за сбоя питания или извлечения носителя в середине операции), файловая система находится в несогласованном состоянии, что может негативно повлиять на целостность всей файловой системы, вызвав повреждение других файлов.</span><span class="sxs-lookup"><span data-stu-id="05e97-198">If this sequence of update is interrupted (such as power glitch, or the media is ejected in the middle of the update), the file system is in an inconsistent state, which may affect the integrity of the entire file system, leading towards corruption of other files.</span></span>

<span data-ttu-id="05e97-199">Модуль отказоустойчивости FileX работает путем записи всех действий, необходимых для изменения файла или каталога.</span><span class="sxs-lookup"><span data-stu-id="05e97-199">The FileX Fault Tolerant Module works by recording all steps required to update a file or a directory along the way.</span></span> <span data-ttu-id="05e97-200">Эта запись журнала хранится на носителе в выделенных секторах (блоках), по которым FileX может выполнить поиск и к которым может обратиться.</span><span class="sxs-lookup"><span data-stu-id="05e97-200">This log entry is stored on the media in dedicated sectors (blocks) that FileX can find and access.</span></span> <span data-ttu-id="05e97-201">Доступ к расположению данных журнала можно получить даже без соответствующей файловой системы.</span><span class="sxs-lookup"><span data-stu-id="05e97-201">The location of the log data can be accessed even without a proper file system.</span></span> <span data-ttu-id="05e97-202">Таким образом, если файловая система повреждена, FileX все равно сможет найти запись журнала и восстановить файловую систему в нормальном состоянии.</span><span class="sxs-lookup"><span data-stu-id="05e97-202">Therefore, in case the file system is corrupted, FileX is still able to find the log entry and restore the file system back into a good state.</span></span>

<span data-ttu-id="05e97-203">Записи журнала создаются по мере изменения файла или каталога решением FileX.</span><span class="sxs-lookup"><span data-stu-id="05e97-203">As FileX updates file or directory, log entries are created.</span></span> <span data-ttu-id="05e97-204">После успешного завершения операции изменения записи журнала удаляются.</span><span class="sxs-lookup"><span data-stu-id="05e97-204">After the update operation is successfully completed, the log entries are removed.</span></span> <span data-ttu-id="05e97-205">Если записи журнала не были должным образом удалены после успешного изменения файла, а процесс восстановления определяет, что содержимое в записи журнала соответствует файловой системе, то никаких действий не требуется, а записи журнала можно очистить.</span><span class="sxs-lookup"><span data-stu-id="05e97-205">If the log entries were not properly removed after a successful file update, if the recovery process determines that the content in the log entry matches the file system, nothing needs to be done, and the log entries can be cleaned up.</span></span>

<span data-ttu-id="05e97-206">Если операция изменения файловой системы была прервана, при следующем подключении носителя с помощью FileX модуль отказоустойчивости анализирует записи журнала.</span><span class="sxs-lookup"><span data-stu-id="05e97-206">In case the file system update operation was interrupted, next time the media is mounted by FileX, the Fault Tolerant Module analyzes the log entries.</span></span> <span data-ttu-id="05e97-207">Сведения в записях журнала позволяют FileX откатить частичные изменения, уже примененные к файловой системе (в случае сбоя на раннем этапе операции обновления файла), а если записи журнала содержат сведения о повторе, FileX может применить изменения, необходимые для завершения предыдущей операции.</span><span class="sxs-lookup"><span data-stu-id="05e97-207">The information in the log entries allows FileX to back out partial changes already applied to the file system (in case the failure happens during the early stage of the file update operation), or if the log entries contain re-do information, FileX is able to apply the changes required to finish the prior operation.</span></span>

<span data-ttu-id="05e97-208">Эта функция отказоустойчивости доступна для всех файловых систем FAT, поддерживаемых FileX, включая FAT12, FAT16, FAT32 и exFAT.</span><span class="sxs-lookup"><span data-stu-id="05e97-208">This fault tolerant feature is available to all FAT file systems supported by FileX, including FAT12, FAT16, FAT32, and exFAT.</span></span> <span data-ttu-id="05e97-209">По умолчанию отказоустойчивость в FileX отключена.</span><span class="sxs-lookup"><span data-stu-id="05e97-209">By default fault tolerant is not enabled in FileX.</span></span> <span data-ttu-id="05e97-210">Чтобы включить функцию отказоустойчивости, для FileX необходимо выполнить сборку с заданным символом **FX_ENABLE_FAULT_TOLERANT** и **FX_FAULT_TOLERANT**.</span><span class="sxs-lookup"><span data-stu-id="05e97-210">To enable the fault tolerant feature, FileX must be built with the symbol  **FX_ENABLE_FAULT_TOLERANT** and **FX_FAULT_TOLERANT** defined.</span></span> <span data-ttu-id="05e97-211">Во время своего выполнения приложение запускает службу отказоустойчивости путем вызова **_fx_fault_tolerant_enable_**.</span><span class="sxs-lookup"><span data-stu-id="05e97-211">At run time, the application starts fault tolerant service by calling **_fx_fault_tolerant_enable_**.</span></span>
<span data-ttu-id="05e97-212">После запуска службы все операции записи файлов и каталогов проходят через модуль отказоустойчивости.</span><span class="sxs-lookup"><span data-stu-id="05e97-212">After the service starts, all file and directory write operations go through the Fault Tolerant Module.</span></span>

<span data-ttu-id="05e97-213">При запуске служба отказоустойчивости сначала определяет, защищен ли носитель модулем отказоустойчивости.</span><span class="sxs-lookup"><span data-stu-id="05e97-213">As fault tolerant service starts, it first detects whether or not the media is protected under the Fault Tolerant Module.</span></span> <span data-ttu-id="05e97-214">Если это не так, FileX предполагает целостность файловой системы и активирует защиту, выделяя из файловой системы свободные блоки для ведения журнала и кэширования.</span><span class="sxs-lookup"><span data-stu-id="05e97-214">If it is not, FileX assumes integrity of the file system, and starts protection by allocating free blocks from the file system to be used for logging and caching.</span></span> <span data-ttu-id="05e97-215">Если в файловой системе найдены журналы модуля отказоустойчивости, решение анализирует записи журнала.</span><span class="sxs-lookup"><span data-stu-id="05e97-215">If the Fault Tolerant Module logs are found on the file system, it analyzes the log entries.</span></span> <span data-ttu-id="05e97-216">FileX отменяет изменения предыдущей операции или повторяет предыдущую операцию в зависимости от содержимого записей журнала.</span><span class="sxs-lookup"><span data-stu-id="05e97-216">FileX reverts the prior operation or redoes the prior operation, depending on the content of the log entries.</span></span> <span data-ttu-id="05e97-217">После обработки всех предыдущих записей журнала файловая система становится доступной.</span><span class="sxs-lookup"><span data-stu-id="05e97-217">The file system becomes available after all the prior log entries are processed.</span></span> <span data-ttu-id="05e97-218">Это гарантирует, что FileX начинает работу с известного рабочего состояния.</span><span class="sxs-lookup"><span data-stu-id="05e97-218">This ensures that FIleX starts from a known good state.</span></span>

<span data-ttu-id="05e97-219">После защиты носителя с помощью модуля отказоустойчивости FileX этот носитель не будет обновляться другой файловой системой.</span><span class="sxs-lookup"><span data-stu-id="05e97-219">After a media is protected under the FileX Fault Tolerant Module, the media will not be updated with another file system.</span></span> <span data-ttu-id="05e97-220">В этом случае записи журнала в файловой системе не будут соответствовать содержимому в таблице FAT, записи каталога.</span><span class="sxs-lookup"><span data-stu-id="05e97-220">Doing so would leave the log entries on the file system inconsistent with the contents in the FAT table, the directory entry.</span></span> <span data-ttu-id="05e97-221">Если носитель обновляется другой файловой системой до его переноса обратно в FileX с помощью модуля отказоустойчивости, это дает неопределенный результат.</span><span class="sxs-lookup"><span data-stu-id="05e97-221">If the media is updated by another file system before moving it back to FileX with the Fault Tolerant Module, the result is undefined.</span></span>

## <a name="callback-functions"></a><span data-ttu-id="05e97-222">Функции обратного вызова</span><span class="sxs-lookup"><span data-stu-id="05e97-222">Callback Functions</span></span>

<span data-ttu-id="05e97-223">В FileX добавлены три следующих функции обратного вызова:</span><span class="sxs-lookup"><span data-stu-id="05e97-223">The following three callback functions are added to FileX:</span></span>

- <span data-ttu-id="05e97-224">Обратный вызов открытия носителя</span><span class="sxs-lookup"><span data-stu-id="05e97-224">Media Open callback</span></span>
- <span data-ttu-id="05e97-225">Обратный вызов закрытия носителя</span><span class="sxs-lookup"><span data-stu-id="05e97-225">Media Close callback</span></span>
- <span data-ttu-id="05e97-226">Обратный вызов записи файла</span><span class="sxs-lookup"><span data-stu-id="05e97-226">File Write callback</span></span>

<span data-ttu-id="05e97-227">После регистрации эти функции будут уведомлять приложение о возникновении таких событий.</span><span class="sxs-lookup"><span data-stu-id="05e97-227">After registered, these functions will notify the application when such events occur.</span></span>

## <a name="easy-integration"></a><span data-ttu-id="05e97-228">Простота интеграции</span><span class="sxs-lookup"><span data-stu-id="05e97-228">Easy Integration</span></span>

<span data-ttu-id="05e97-229">FileX легко интегрируется практически с любым устройством флэш-памяти или носителем.</span><span class="sxs-lookup"><span data-stu-id="05e97-229">FileX is easily integrated with virtually any FLASH or media device.</span></span> <span data-ttu-id="05e97-230">Перенос FileX довольно прост.</span><span class="sxs-lookup"><span data-stu-id="05e97-230">Porting FileX is simple.</span></span> <span data-ttu-id="05e97-231">Данный процесс подробно описан в настоящем руководстве, при этом драйвер ОЗУ демонстрационной системы станет отличной отправной точкой.</span><span class="sxs-lookup"><span data-stu-id="05e97-231">This guide describes the process in detail, and the RAM driver of the demo system makes for a very good place to start!</span></span>
