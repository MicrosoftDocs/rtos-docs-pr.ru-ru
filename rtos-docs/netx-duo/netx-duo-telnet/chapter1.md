---
title: Глава 1. Введение в NetX Duo Telnet для ОСРВ Azure
description: NetX Duo Telnet для ОСРВ Azure — это протокол, предназначенный для передачи команд и ответов между двумя узлами в Интернете.
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: d25f5ca4a7bf1ecf4c3d0c68ef6c8aeda7800098
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104814543"
---
# <a name="chapter-1---introduction-to-the-azure-rtos-netx-duo-telnet"></a><span data-ttu-id="158d6-103">Глава 1. Введение в NetX Duo Telnet для ОСРВ Azure</span><span class="sxs-lookup"><span data-stu-id="158d6-103">Chapter 1 - Introduction to the Azure RTOS NetX Duo Telnet</span></span>

<span data-ttu-id="158d6-104">NetX Duo Telnet для ОСРВ Azure — это протокол, предназначенный для передачи команд и ответов между двумя узлами в Интернете.</span><span class="sxs-lookup"><span data-stu-id="158d6-104">The Azure RTOS NetX Duo Telnet is a protocol designed for transferring commands and responses between two nodes on the Internet.</span></span> <span data-ttu-id="158d6-105">Telnet — это простой протокол, в котором для выполнения функции передачи используются надежные службы протокола TCP.</span><span class="sxs-lookup"><span data-stu-id="158d6-105">Telnet is a simple protocol that utilizes reliable Transmission Control Protocol (TCP) services to perform its transfer function.</span></span> <span data-ttu-id="158d6-106">Поэтому Telnet является высоконадежным протоколом передачи данных.</span><span class="sxs-lookup"><span data-stu-id="158d6-106">Because of this, Telnet is a highly reliable transfer protocol.</span></span> <span data-ttu-id="158d6-107">Telnet также является одним из наиболее используемых протоколов приложений.</span><span class="sxs-lookup"><span data-stu-id="158d6-107">Telnet is also one of the most used application protocols.</span></span>

## <a name="telnet-requirements"></a><span data-ttu-id="158d6-108">Требования для работы Telnet</span><span class="sxs-lookup"><span data-stu-id="158d6-108">Telnet Requirements</span></span>

<span data-ttu-id="158d6-109">Для правильной работы пакета NetX Duo Telnet требуется, чтобы экземпляр IP NetX уже был создан.</span><span class="sxs-lookup"><span data-stu-id="158d6-109">In order to function properly, the NetX Duo Telnet package requires that a NetX IP instance has already been created.</span></span> <span data-ttu-id="158d6-110">Кроме того, на этом же экземпляре IP должен быть включен протокол TCP.</span><span class="sxs-lookup"><span data-stu-id="158d6-110">In addition, TCP must be enabled on that same IP instance.</span></span> <span data-ttu-id="158d6-111">Часть клиента в пакете NetX Duo Telnet не имеет дополнительных требований.</span><span class="sxs-lookup"><span data-stu-id="158d6-111">The Telnet Client portion of the NetX Duo Telnet package has no further requirements.</span></span>

<span data-ttu-id="158d6-112">Часть сервера в пакете NetX Duo Telnet имеет одно дополнительное требование.</span><span class="sxs-lookup"><span data-stu-id="158d6-112">The Telnet Server portion of the NetX Duo Telnet package has one additional requirement.</span></span> <span data-ttu-id="158d6-113">Ему требуется полный доступ к *хорошо известному порту TCP 23* для обработки всех клиентских запросов Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-113">It requires complete access to TCP *well-known port 23* for handling all Client Telnet requests.</span></span>

## <a name="telnet-constraints"></a><span data-ttu-id="158d6-114">Ограничения Telnet</span><span class="sxs-lookup"><span data-stu-id="158d6-114">Telnet Constraints</span></span> 

<span data-ttu-id="158d6-115">Протокол NetX Duo Telnet реализует стандарт Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-115">The NetX Duo Telnet protocol implements the Telnet standard.</span></span> <span data-ttu-id="158d6-116">Однако за интерпретацию и ответ команд Telnet, обозначенных байтом со значением 255, отвечает приложение.</span><span class="sxs-lookup"><span data-stu-id="158d6-116">However,the interpretation and response of Telnet commands, indicated by a byte with the value of 255, is the responsibility of the application.</span></span> <span data-ttu-id="158d6-117">Различные команды Telnet и их параметры определены в файлах *nxd_telnet_client.h и nxd_telnet_server.h*.</span><span class="sxs-lookup"><span data-stu-id="158d6-117">The various Telnet commands and command parameters are defined in the *nxd_telnet_client.h and nxd_telnet_server.h* files.</span></span>

## <a name="telnet-communication"></a><span data-ttu-id="158d6-118">Взаимодействие по протоколу Telnet</span><span class="sxs-lookup"><span data-stu-id="158d6-118">Telnet Communication</span></span>

<span data-ttu-id="158d6-119">Как упоминалось ранее, сервер Telnet использует *хорошо известный порт TCP 23* для клиентских запросов.</span><span class="sxs-lookup"><span data-stu-id="158d6-119">As mentioned previously, the Telnet Server utilizes the *well-known TCP port 23* to field Client requests.</span></span> <span data-ttu-id="158d6-120">Клиенты Telnet могут использовать любой доступный TCP-порт.</span><span class="sxs-lookup"><span data-stu-id="158d6-120">Telnet Clients may use any available TCP port.</span></span>

## <a name="telnet-authentication"></a><span data-ttu-id="158d6-121">Проверка подлинности Telnet</span><span class="sxs-lookup"><span data-stu-id="158d6-121">Telnet Authentication</span></span>

<span data-ttu-id="158d6-122">Проверка подлинности Telnet отвечает за функцию обратного вызова сервера Telnet в приложении.</span><span class="sxs-lookup"><span data-stu-id="158d6-122">Telnet authentication is the responsibility of the application’s Telnet Server callback function.</span></span> <span data-ttu-id="158d6-123">Ответный вызов "новое подключение" к серверу Telnet-сервера обычно запрашивает у клиента имя и (или) пароль.</span><span class="sxs-lookup"><span data-stu-id="158d6-123">The application’s Telnet Server “new connection” callback would typically prompt the Client for name and/or password.</span></span> <span data-ttu-id="158d6-124">Затем на клиента возлагается ответственность за предоставление этой информации.</span><span class="sxs-lookup"><span data-stu-id="158d6-124">The Client would then be responsible for providing the information.</span></span> <span data-ttu-id="158d6-125">Затем сервер будет обрабатывать информацию в обратном вызове "получение данных".</span><span class="sxs-lookup"><span data-stu-id="158d6-125">The Server would then process the information in the “receive data” callback.</span></span> <span data-ttu-id="158d6-126">Именно здесь код сервера приложений должен будет проверить подлинность информации и решить, является ли она допустимой.</span><span class="sxs-lookup"><span data-stu-id="158d6-126">This is where the application Server code would have to authenticate the information and decide whether or not it is valid.</span></span>

## <a name="telnet-new-connection-callback"></a><span data-ttu-id="158d6-127">Обратный вызов нового подключения Telnet</span><span class="sxs-lookup"><span data-stu-id="158d6-127">Telnet New Connection Callback</span></span>

<span data-ttu-id="158d6-128">Сервер NetX Duo Telnet вызывает указанную приложением функцию обратного вызова при получении нового запроса клиента Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-128">The NetX Duo Telnet Server calls the application specified callback function whenever a new Telnet Client request is received.</span></span> <span data-ttu-id="158d6-129">Приложение указывает функцию обратного вызова при создании сервера Telnet с помощью функции ***nx_telnet_server_create***.</span><span class="sxs-lookup"><span data-stu-id="158d6-129">The application specifies the callback function when the Telnet Server is created via the ***nx_telnet_server_create*** function.</span></span> <span data-ttu-id="158d6-130">Типичные действия обратного вызова "новое подключение" включают отправку баннера или запроса клиенту.</span><span class="sxs-lookup"><span data-stu-id="158d6-130">Typical actions of the “new connection” callback include sending a banner or prompt to the Client.</span></span> <span data-ttu-id="158d6-131">Это вполне может включать запрос информации для входа в систему.</span><span class="sxs-lookup"><span data-stu-id="158d6-131">This could very well include a prompt for login information.</span></span>

### <a name="prototype"></a><span data-ttu-id="158d6-132">Прототип</span><span class="sxs-lookup"><span data-stu-id="158d6-132">Prototype</span></span>

```c
void  telnet_new_connection(NX_TELNET_SERVER *server_ptr, 
                            UINT logical_connection);
```

### <a name="input-parameters"></a><span data-ttu-id="158d6-133">Входные параметры</span><span class="sxs-lookup"><span data-stu-id="158d6-133">Input Parameters</span></span>

- <span data-ttu-id="158d6-134">**server_ptr**: указатель на вызывающий сервер Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-134">**server_ptr**: Pointer to the calling Telnet Server.</span></span>
- <span data-ttu-id="158d6-135">**logical_connection**: внутреннее логическое соединение для сервера Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-135">**logical_connection**: The internal logical connection for the Telnet Server.</span></span> <span data-ttu-id="158d6-136">Этот параметр может использоваться приложением в качестве индекса в буферах и (или) структурах данных, специфичных для каждого клиентского соединения.</span><span class="sxs-lookup"><span data-stu-id="158d6-136">This can be used by the application as an index into buffers and/or data structures specific for each Client connection.</span></span> <span data-ttu-id="158d6-137">Его значение лежит в диапазоне от 0 до NX_TELNET_MAX_CLIENTS - 1.</span><span class="sxs-lookup"><span data-stu-id="158d6-137">Its value ranges from 0 through NX_TELNET_MAX_CLIENTS - 1.</span></span>

## <a name="telnet-receive-data-callback"></a><span data-ttu-id="158d6-138">Обратный вызов получения данных Telnet</span><span class="sxs-lookup"><span data-stu-id="158d6-138">Telnet Receive Data Callback</span></span>

<span data-ttu-id="158d6-139">Сервер NetX Duo Telnet вызывает указанную приложением функцию обратного вызова при получении новых данных клиента Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-139">The NetX Duo Telnet Server calls the application specified callback function whenever a new Telnet Client data is received.</span></span> <span data-ttu-id="158d6-140">Приложение указывает функцию обратного вызова при создании сервера Telnet с помощью функции ***nx_telnet_server_create***.</span><span class="sxs-lookup"><span data-stu-id="158d6-140">The application specifies the callback function when the Telnet Server is created via the ***nx_telnet_server_create*** function.</span></span> <span data-ttu-id="158d6-141">Типичные действия обратного вызова "получение данных" включают возврат данных обратно и (или) анализ данных и предоставление данных в результате интерпретации команды от клиента.</span><span class="sxs-lookup"><span data-stu-id="158d6-141">Typical actions of the “new connection” callback include echoing the data back and/or parsing the data and providing data as a result of interpreting a command from the client.</span></span>

<span data-ttu-id="158d6-142">Обратите внимание, что эта подпрограмма обратного вызова также должна освобождать указанный пакет.</span><span class="sxs-lookup"><span data-stu-id="158d6-142">Note that this callback routine must also release the supplied packet.</span></span>

### <a name="prototype"></a><span data-ttu-id="158d6-143">Прототип</span><span class="sxs-lookup"><span data-stu-id="158d6-143">Prototype</span></span>

```c
void  telnet_receive_data(NX_TELNET_SERVER *server_ptr, 
                          UINT logical_connection, NX_PACKET *packet_ptr);
```
### <a name="input-parameters"></a><span data-ttu-id="158d6-144">Входные параметры</span><span class="sxs-lookup"><span data-stu-id="158d6-144">Input Parameters</span></span>

- <span data-ttu-id="158d6-145">**server_ptr**: указатель на вызывающий сервер Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-145">**server_ptr**: Pointer to the calling Telnet Server.</span></span>
- <span data-ttu-id="158d6-146">**logical_connection**: внутреннее логическое соединение для сервера Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-146">**logical_connection**: The internal logical connection for the Telnet Server.</span></span> <span data-ttu-id="158d6-147">Этот параметр может использоваться приложением в качестве индекса в буферах и (или) структурах данных, специфичных для каждого клиентского соединения.</span><span class="sxs-lookup"><span data-stu-id="158d6-147">This can be used by the application as an index into buffers and/or data structures specific for each Client connection.</span></span> <span data-ttu-id="158d6-148">Его значение лежит в диапазоне от 0 до NX_TELNET_MAX_CLIENTS - 1.</span><span class="sxs-lookup"><span data-stu-id="158d6-148">Its value ranges from 0 through NX_TELNET_MAX_CLIENTS - 1.</span></span>
- <span data-ttu-id="158d6-149">**packet_ptr**: указатель на пакет, содержащий данные от клиента.</span><span class="sxs-lookup"><span data-stu-id="158d6-149">**packet_ptr**: Pointer to packet containing the data from the Client.</span></span>

## <a name="telnet-end-connection-callback"></a><span data-ttu-id="158d6-150">Обратный вызов завершения подключения Telnet</span><span class="sxs-lookup"><span data-stu-id="158d6-150">Telnet End Connection Callback</span></span>

<span data-ttu-id="158d6-151">Сервер NetX Duo Telnet вызывает указанную приложением функцию обратного вызова при завершении подключения клиентом Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-151">The NetX Duo Telnet Server calls the application specified callback function whenever a Telnet Client ends the connection.</span></span> <span data-ttu-id="158d6-152">Приложение указывает функцию обратного вызова при создании сервера Telnet с помощью функции ***nx_telnet_server_create***.</span><span class="sxs-lookup"><span data-stu-id="158d6-152">The application specifies the callback function when the Telnet Server is created via the ***nx_telnet_server_create*** function.</span></span> <span data-ttu-id="158d6-153">Типичные действия обратного вызова "завершение подключения" включают очистку всех специфичных для клиента структур данных, связанных с логическим подключением.</span><span class="sxs-lookup"><span data-stu-id="158d6-153">Typical actions of the “end connection” callback include cleaning up any Client specific data structures associated with the logical connection.</span></span>

### <a name="prototype"></a><span data-ttu-id="158d6-154">Прототип</span><span class="sxs-lookup"><span data-stu-id="158d6-154">Prototype</span></span>
```c
void  telnet_end_connection(NX_TELNET_SERVER *server_ptr, 
                            UINT logical_connection);
```

### <a name="input-parameters"></a><span data-ttu-id="158d6-155">Входные параметры</span><span class="sxs-lookup"><span data-stu-id="158d6-155">Input Parameters</span></span>

- <span data-ttu-id="158d6-156">**server_ptr**: указатель на вызывающий сервер Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-156">**server_ptr** Pointer to the calling Telnet Server.</span></span>
- <span data-ttu-id="158d6-157">**logical_connection**: внутреннее логическое соединение для сервера Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-157">**logical_connection** The internal logical connection for the Telnet Server.</span></span> <span data-ttu-id="158d6-158">Этот параметр может использоваться приложением в качестве индекса в буферах и (или) структурах данных, специфичных для каждого клиентского соединения.</span><span class="sxs-lookup"><span data-stu-id="158d6-158">This can be used by the application as an index into buffers and/or data structures specific for each Client connection.</span></span> <span data-ttu-id="158d6-159">Его значение лежит в диапазоне от 0 до NX_TELNET_MAX_CLIENTS - 1.</span><span class="sxs-lookup"><span data-stu-id="158d6-159">Its value ranges from 0 through NX_TELNET_MAX_CLIENTS - 1.</span></span>

## <a name="telnet-option-negotiation"></a><span data-ttu-id="158d6-160">Согласование параметров Telnet</span><span class="sxs-lookup"><span data-stu-id="158d6-160">Telnet Option Negotiation</span></span>

<span data-ttu-id="158d6-161">Сервер NetX Duo Telnet поддерживает ограниченный набор параметров Telnet, Echo и Suppress Go Ahead.</span><span class="sxs-lookup"><span data-stu-id="158d6-161">The NetX Duo Telnet Server supports a limited set of Telnet options, Echo and Suppress Go Ahead.</span></span>

<span data-ttu-id="158d6-162">Для работы этой функции параметр NX_TELNET_SERVER_OPTION_DISABLE не должен быть определен.</span><span class="sxs-lookup"><span data-stu-id="158d6-162">To enable this feature the NX_TELNET_SERVER_OPTION_DISABLE must not be defined.</span></span> <span data-ttu-id="158d6-163">По умолчанию он не определен.</span><span class="sxs-lookup"><span data-stu-id="158d6-163">By default it is not defined.</span></span> <span data-ttu-id="158d6-164">Сервер Telnet создает пул пакетов в службе *nx_telnet_server_create*, из которой он выделяет пакеты для отправки запросов параметров Telnet клиенту.</span><span class="sxs-lookup"><span data-stu-id="158d6-164">The Telnet Server creates a packet pool in the *nx_telnet_server_create* service from which it allocates packets for sending telnet options requests to the Client.</span></span> <span data-ttu-id="158d6-165">Сведения о настройке полезных данных пакета (NX_TELNET_SERVER_PACKET_PAYLOAD) и размера пула пакетов (NX_TELNET_SERVER_PACKET_POOL_SIZE) для этого пула пакетов см. в разделе "Параметры конфигурации".</span><span class="sxs-lookup"><span data-stu-id="158d6-165">See “Configuration Options” for setting the packet payload (NX_TELNET_SERVER_PACKET_PAYLOAD) and packet pool size (NX_TELNET_SERVER_PACKET_POOL_SIZE) for this packet pool.</span></span> <span data-ttu-id="158d6-166">Этот пул пакетов будет удален при вызове службы *nx_telnet_server_delete*.</span><span class="sxs-lookup"><span data-stu-id="158d6-166">It will delete this packet pool when the *nx_telnet_server_delete* service is called.</span></span>

<span data-ttu-id="158d6-167">При установлении соединения с клиентом Telnet он отправляет ему этот набор параметров, если не получил следующие запросы параметров от клиента:</span><span class="sxs-lookup"><span data-stu-id="158d6-167">Upon making a connection with the Telnet Client, it will send out this set of telnet options to the Client if it has not received option requests from the Client:</span></span>

- <span data-ttu-id="158d6-168">will echo</span><span class="sxs-lookup"><span data-stu-id="158d6-168">will echo</span></span>
- <span data-ttu-id="158d6-169">dont echo</span><span class="sxs-lookup"><span data-stu-id="158d6-169">dont echo</span></span>
- <span data-ttu-id="158d6-170">will sga</span><span class="sxs-lookup"><span data-stu-id="158d6-170">will sga</span></span>

<span data-ttu-id="158d6-171">При получении данных Telnet от клиента сервер Telnet проверяет, является ли первый байт кодом "IAC".</span><span class="sxs-lookup"><span data-stu-id="158d6-171">When it receives Telnet data from the Client, the Telnet Server checks if the first byte is the “IAC” code.</span></span> <span data-ttu-id="158d6-172">В этом случае он обрабатывает все параметры пакета клиента.</span><span class="sxs-lookup"><span data-stu-id="158d6-172">If so, it will process all the options in the Client packet.</span></span> <span data-ttu-id="158d6-173">Параметры, отсутствующие в списке выше, игнорируются.</span><span class="sxs-lookup"><span data-stu-id="158d6-173">Options not in the list above are ignored.</span></span>

<span data-ttu-id="158d6-174">По умолчанию сервер Telnet создает собственный внутренний пул пакетов, если параметр NX_TELNET_SERVER_OPTION_DISABLE не определен и ему требуется передать команды параметров Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-174">By default, the Telnet Server creates its own internal packet pool if NX_TELNET_SERVER_OPTION_DISABLE is not defined and it needs to transmit Telnet option commands.</span></span> <span data-ttu-id="158d6-175">Пул пакетов сервера Telnet определяется параметрами NX_TELNET_SERVER_PACKET_PAYLOAD и NX_TELNET_SERVER_PACKET_POOLSIZE.</span><span class="sxs-lookup"><span data-stu-id="158d6-175">The Telnet Server packet pool is defined by NX_TELNET_SERVER_PACKET_PAYLOAD and NX_TELNET_SERVER_PACKET_POOLSIZE.</span></span> <span data-ttu-id="158d6-176">Однако, если определен параметр NX_TELNET_SERVER_USER_CREATE_PACKET_POOL, то приложение должно создать пул пакетов сервера Telnet и задать его в качестве пула пакетов сервера Telnet, вызвав *_nx_telnet_server_packet_pool_set*.</span><span class="sxs-lookup"><span data-stu-id="158d6-176">If, however, NX_TELNET_SERVER_USER_CREATE_PACKET_POOL is defined, the application must create the Telnet Server packet pool and set it as the Telnet Server packet pool by calling *_nx_telnet_server_packet_pool_set*.</span></span> <span data-ttu-id="158d6-177">Дополнительные сведения об этой функции см. в главе 3 "Описание служб Telnet".</span><span class="sxs-lookup"><span data-stu-id="158d6-177">See Chapter 3 “Description of Telnet Services” for more details about this function.</span></span>

<span data-ttu-id="158d6-178">В отличие от сервера NetX Duo Telnet, поток задач клиента NetX Duo Telnet не выполняет отправку и не реагирует на полученные параметры от сервера Telnet автоматически.</span><span class="sxs-lookup"><span data-stu-id="158d6-178">Unlike the NetX Duo Telnet Server, the NetX Duo Telnet Client task thread does not automatically send and respond to received options from the Telnet Server.</span></span> <span data-ttu-id="158d6-179">Это должно делать клиентское приложение Telnet.</span><span class="sxs-lookup"><span data-stu-id="158d6-179">This must be done by the Telnet Client application.</span></span>

## <a name="telnet-multi-thread-support"></a><span data-ttu-id="158d6-180">Поддержка нескольких потоков в Telnet</span><span class="sxs-lookup"><span data-stu-id="158d6-180">Telnet Multi-Thread Support</span></span>

<span data-ttu-id="158d6-181">Клиентские службы NetX Duo Telnet можно вызывать из нескольких потоков одновременно.</span><span class="sxs-lookup"><span data-stu-id="158d6-181">The NetX Duo Telnet Client services can be called from multiple threads simultaneously.</span></span> <span data-ttu-id="158d6-182">Однако запросы на чтение или запись для конкретного экземпляра клиента Telnet должны выполняться последовательно из одного потока.</span><span class="sxs-lookup"><span data-stu-id="158d6-182">However, read or write requests for a particular Telnet Client instance should be done in sequence from the same thread.</span></span>

## <a name="telnet-rfcs"></a><span data-ttu-id="158d6-183">Документы RFC по Telnet</span><span class="sxs-lookup"><span data-stu-id="158d6-183">Telnet RFCs</span></span>

<span data-ttu-id="158d6-184">NetX Duo Telnet совместим с RFC854 и связанными документами RFC.</span><span class="sxs-lookup"><span data-stu-id="158d6-184">NetX Duo Telnet is compliant with RFC854 and related RFCs.</span></span>
