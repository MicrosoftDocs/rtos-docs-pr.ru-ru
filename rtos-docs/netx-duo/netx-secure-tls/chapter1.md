---
title: Глава 1. Введение в ОСРВ Azure NetX Secure
description: В этой главе содержатся общие сведения о протоколе ОСРВ Azure NetX Secure, в том числе описываются аспекты его прикладного применения и преимущества.
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 8f4c7a97564cd2f702f9887181b36297b42fa492
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104814508"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-secure"></a><span data-ttu-id="9c390-103">Глава 1. Введение в ОСРВ Azure NetX Secure</span><span class="sxs-lookup"><span data-stu-id="9c390-103">Chapter 1 - Introduction to Azure RTOS NetX Secure</span></span>

<span data-ttu-id="9c390-104">ОСРВ Azure NetX Secure — это высокопроизводительная реализация криптографических стандартов сетевой безопасности, включая TLS/SSL, предназначенная исключительно для внедренных приложений на основе ThreadX.</span><span class="sxs-lookup"><span data-stu-id="9c390-104">Azure RTOS NetX Secure is a high-performance real-time implementation of cryptographic network security standards including TLS/SSL designed exclusively for embedded ThreadX-based applications.</span></span> <span data-ttu-id="9c390-105">В этой главе содержатся общие сведения о протоколе NetX Secure, в том числе описываются аспекты его прикладного применения и преимущества.</span><span class="sxs-lookup"><span data-stu-id="9c390-105">This chapter contains an introduction to NetX Secure and a description of its applications and benefits.</span></span>

## <a name="netx-secure-unique-features"></a><span data-ttu-id="9c390-106">Уникальные возможности NetX Secure</span><span class="sxs-lookup"><span data-stu-id="9c390-106">NetX Secure Unique Features</span></span>

<span data-ttu-id="9c390-107">В отличие от большинства других реализаций TLS, протокол NetX Secure был разработан с нуля для поддержки широкого спектра встроенных аппаратных платформ. Он легко масштабируется от небольших приложений микроконтроллеров до самых мощных встроенных процессоров из доступных.</span><span class="sxs-lookup"><span data-stu-id="9c390-107">Unlike most other TLS implementations, NetX Secure was designed from the ground up to support a wide variety of embedded hardware platforms and scales easily from small micro-controller applications to the most powerful embedded processors available.</span></span> <span data-ttu-id="9c390-108">Код написан с учетом ограниченных ресурсов встроенных систем и предоставляет ряд параметров для уменьшения объема памяти, необходимой для безопасного взаимодействия по протоколу TLS.</span><span class="sxs-lookup"><span data-stu-id="9c390-108">The code is written with the limited resources of embedded systems in mind, and provides a number of configuration options to reduce the memory footprint needed to provide secure network communications over TLS.</span></span>

## <a name="rfcs-supported-by-netx-secure"></a><span data-ttu-id="9c390-109">Документы RFC, поддерживаемые NetX Secure</span><span class="sxs-lookup"><span data-stu-id="9c390-109">RFCs Supported by NetX Secure</span></span> 

<span data-ttu-id="9c390-110">NetX Secure поддерживает приведенные ниже протоколы, связанные с протоколом TLS.</span><span class="sxs-lookup"><span data-stu-id="9c390-110">NetX Secure supports the following protocols related to TLS.</span></span> <span data-ttu-id="9c390-111">Этот список не обязательно является исчерпывающим, так как существует множество документов RFC, относящихся к TLS и шифрованию.</span><span class="sxs-lookup"><span data-stu-id="9c390-111">The list is not necessarily comprehensive as there are numerous RFCs pertaining to TLS and cryptography.</span></span> <span data-ttu-id="9c390-112">NetX Secure соответствует всем общим рекомендациям и базовым требованиям с учетом ограничений операционной системы реального времени, обусловленных небольшой занимаемой памятью и эффективным выполнением.</span><span class="sxs-lookup"><span data-stu-id="9c390-112">NetX Secure follows all general recommendations and basic requirements within the constraints of a real-time operating system with small memory footprint and efficient execution.</span></span>

| <span data-ttu-id="9c390-113">RFC</span><span class="sxs-lookup"><span data-stu-id="9c390-113">RFC</span></span>      | <span data-ttu-id="9c390-114">Описание</span><span class="sxs-lookup"><span data-stu-id="9c390-114">Description</span></span>                                                                                                 | <span data-ttu-id="9c390-115">Страница</span><span class="sxs-lookup"><span data-stu-id="9c390-115">Page</span></span> |
|----------|-------------------------------------------------------------------------------------------------------------|------|
| <span data-ttu-id="9c390-116">RFC 2104</span><span class="sxs-lookup"><span data-stu-id="9c390-116">RFC 2104</span></span> | <span data-ttu-id="9c390-117">HMAC: хэширование с ключом для проверки подлинности сообщений</span><span class="sxs-lookup"><span data-stu-id="9c390-117">HMAC: Keyed-Hashing for Message Authentication</span></span>                                                              | <span data-ttu-id="9c390-118">33</span><span class="sxs-lookup"><span data-stu-id="9c390-118">33</span></span>   |
| <span data-ttu-id="9c390-119">RFC 2246</span><span class="sxs-lookup"><span data-stu-id="9c390-119">RFC 2246</span></span> | <span data-ttu-id="9c390-120">Протокол TLS версии 1.0</span><span class="sxs-lookup"><span data-stu-id="9c390-120">The TLS Protocol Version 1.0</span></span>                                                                                | <span data-ttu-id="9c390-121">19</span><span class="sxs-lookup"><span data-stu-id="9c390-121">19</span></span>   |
| <span data-ttu-id="9c390-122">RFC 3268</span><span class="sxs-lookup"><span data-stu-id="9c390-122">RFC 3268</span></span> | <span data-ttu-id="9c390-123">Комплекты шифров AES для протокола TLS</span><span class="sxs-lookup"><span data-stu-id="9c390-123">Advanced Encryption Standard (AES) Ciphersuites for Transport Layer Security (TLS)</span></span>                          | <span data-ttu-id="9c390-124">31</span><span class="sxs-lookup"><span data-stu-id="9c390-124">31</span></span>   |
| <span data-ttu-id="9c390-125">RFC 3447</span><span class="sxs-lookup"><span data-stu-id="9c390-125">RFC 3447</span></span> | <span data-ttu-id="9c390-126">Стандарты шифрования с открытым ключом (PKCS) № 1: спецификации шифрования RSA версии 2.1</span><span class="sxs-lookup"><span data-stu-id="9c390-126">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</span></span>                    | <span data-ttu-id="9c390-127">32</span><span class="sxs-lookup"><span data-stu-id="9c390-127">32</span></span>   |
| <span data-ttu-id="9c390-128">RFC 4279</span><span class="sxs-lookup"><span data-stu-id="9c390-128">RFC 4279</span></span> | <span data-ttu-id="9c390-129">Комплекты шифров с общим ключом для протокола TLS</span><span class="sxs-lookup"><span data-stu-id="9c390-129">Pre-Shared Key Ciphersuites for TLS</span></span>                                                                         | <span data-ttu-id="9c390-130">39</span><span class="sxs-lookup"><span data-stu-id="9c390-130">39</span></span>   |
| <span data-ttu-id="9c390-131">RFC 4346</span><span class="sxs-lookup"><span data-stu-id="9c390-131">RFC 4346</span></span> | <span data-ttu-id="9c390-132">Протокол TLS версии 1.1</span><span class="sxs-lookup"><span data-stu-id="9c390-132">The Transport Layer Security (TLS) Protocol Version 1.1</span></span>                                                     | <span data-ttu-id="9c390-133">19</span><span class="sxs-lookup"><span data-stu-id="9c390-133">19</span></span>   |
| <span data-ttu-id="9c390-134">RFC 5246</span><span class="sxs-lookup"><span data-stu-id="9c390-134">RFC 5246</span></span> | <span data-ttu-id="9c390-135">Протокол TLS версии 1.2</span><span class="sxs-lookup"><span data-stu-id="9c390-135">The Transport Layer Security (TLS) Protocol Version 1.2</span></span>                                                     | <span data-ttu-id="9c390-136">19</span><span class="sxs-lookup"><span data-stu-id="9c390-136">19</span></span>   |
| <span data-ttu-id="9c390-137">RFC 5280</span><span class="sxs-lookup"><span data-stu-id="9c390-137">RFC 5280</span></span> | <span data-ttu-id="9c390-138">Сертификаты PKI X.509 (вер. 3)</span><span class="sxs-lookup"><span data-stu-id="9c390-138">X.509 PKI Certificates (v3)</span></span>                                                                                 | <span data-ttu-id="9c390-139">41</span><span class="sxs-lookup"><span data-stu-id="9c390-139">41</span></span>   |
| <span data-ttu-id="9c390-140">RFC 5746</span><span class="sxs-lookup"><span data-stu-id="9c390-140">RFC 5746</span></span> | <span data-ttu-id="9c390-141">Расширение для указания повторного согласования TLS</span><span class="sxs-lookup"><span data-stu-id="9c390-141">Transport Layer Security (TLS) Renegotiation Indication Extension</span></span>                                           |      |
| <span data-ttu-id="9c390-142">RFC 5869</span><span class="sxs-lookup"><span data-stu-id="9c390-142">RFC 5869</span></span> | <span data-ttu-id="9c390-143">Функция формирования ключа на основе HMAC (HKDF) (извлечение и дополнение)</span><span class="sxs-lookup"><span data-stu-id="9c390-143">HMAC-based Extract-and-Expand Key Derivation Function (HKDF)</span></span>                                                | <span data-ttu-id="9c390-144">19</span><span class="sxs-lookup"><span data-stu-id="9c390-144">19</span></span>   |
| <span data-ttu-id="9c390-145">RFC 6066<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="9c390-145">RFC 6066<sup>1</sup></span></span> | <span data-ttu-id="9c390-146">Расширения протокола TLS: определения расширений</span><span class="sxs-lookup"><span data-stu-id="9c390-146">Transport Layer Security (TLS) Extensions: Extension Definitions</span></span>                                            | <span data-ttu-id="9c390-147">19</span><span class="sxs-lookup"><span data-stu-id="9c390-147">19</span></span>   |
| <span data-ttu-id="9c390-148">RFC 6234</span><span class="sxs-lookup"><span data-stu-id="9c390-148">RFC 6234</span></span> | <span data-ttu-id="9c390-149">Безопасные хэш-алгоритмы США (SHA, HMAC на основе SHA и HKDF)</span><span class="sxs-lookup"><span data-stu-id="9c390-149">US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)</span></span>                                                 | <span data-ttu-id="9c390-150">33</span><span class="sxs-lookup"><span data-stu-id="9c390-150">33</span></span>   |
| <span data-ttu-id="9c390-151">RFC 8443</span><span class="sxs-lookup"><span data-stu-id="9c390-151">RFC 8443</span></span> | <span data-ttu-id="9c390-152">Комплекты шифров ECC для протокола TLS версии 1.2 и более ранних версий</span><span class="sxs-lookup"><span data-stu-id="9c390-152">Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS) Versions 1.2 and Earlier</span></span> |      |
| <span data-ttu-id="9c390-153">RFC 8446</span><span class="sxs-lookup"><span data-stu-id="9c390-153">RFC 8446</span></span> | <span data-ttu-id="9c390-154">Протокол TLS версии 1.3</span><span class="sxs-lookup"><span data-stu-id="9c390-154">The Transport Layer Security (TLS) Protocol Version 1.3</span></span>                                                     | <span data-ttu-id="9c390-155">19</span><span class="sxs-lookup"><span data-stu-id="9c390-155">19</span></span>   |

1. <span data-ttu-id="9c390-156">Начиная с версии 6.0 полностью поддерживается только расширение указания имени сервера (SNI), описанное в RFC 6066.</span><span class="sxs-lookup"><span data-stu-id="9c390-156">As of version 6.0 only the Server Name Indication (SNI) extension from RFC 6066 is fully supported.</span></span>

## <a name="netx-secure-requirements"></a><span data-ttu-id="9c390-157">Требования NetX Secure</span><span class="sxs-lookup"><span data-stu-id="9c390-157">NetX Secure Requirements</span></span>

<span data-ttu-id="9c390-158">Для правильной работы библиотеки времени выполнения NetX Secure требуется, чтобы экземпляр NetX IP уже был создан.</span><span class="sxs-lookup"><span data-stu-id="9c390-158">In order to function properly, the NetX Secure run-time library requires that a NetX IP instance has already been created.</span></span> <span data-ttu-id="9c390-159">Кроме того, в зависимости от приложения, потребуется один или несколько цифровых сертификатов X.509 в кодировке DER, чтобы идентифицировать экземпляр TLS или проверять сертификаты, поступающие с удаленного узла.</span><span class="sxs-lookup"><span data-stu-id="9c390-159">In addition, and depending on the application, one or more DER-encoded X.509 Digital Certificates will be required, either to identify a TLS instance or to verify certificates coming from a remote host.</span></span> <span data-ttu-id="9c390-160">Дополнительные требования для пакета NetX Secure отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="9c390-160">The NetX Secure package has no further requirements.</span></span>

## <a name="netx-secure-constraints"></a><span data-ttu-id="9c390-161">Ограничения NetX Secure</span><span class="sxs-lookup"><span data-stu-id="9c390-161">NetX Secure Constraints</span></span>

<span data-ttu-id="9c390-162">Протокол NetX Secure реализует требования стандартов RFC 5246 для TLS 1.2 и RFC 8446 для TLS 1.3, а также дополнительно обеспечивает обратную совместимость с RFC 4346 (TLS 1.1) и 2246 (TLS 1.0) (отключенную по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="9c390-162">The NetX Secure protocol implements the requirements of the RFC 5246 Standard(s) for TLS 1.2 and RFC 8446 for TLS 1.3, as well as providing optional (disabled by default) backwards-compatibility with RFCs 4346 (TLS 1.1) and 2246 (TLS 1.0).</span></span> <span data-ttu-id="9c390-163">Однако действуют следующие ограничения.</span><span class="sxs-lookup"><span data-stu-id="9c390-163">However, there are the following constraints:</span></span>

- <span data-ttu-id="9c390-164">Для протоколов TLS 1.2 и TLS 1.3 поддерживаются только комплекты шифров, использующие SHA-256.</span><span class="sxs-lookup"><span data-stu-id="9c390-164">Only ciphersuites using SHA-256 are supported for TLS 1.2 and TLS 1.3.</span></span> <span data-ttu-id="9c390-165">В версиях, предшествовавших TLS 1.2, для подтверждения TLS использовалась процедура фиксированного хэширования для проверки того, что сообщения подтверждения TLS не были изменены.</span><span class="sxs-lookup"><span data-stu-id="9c390-165">In versions prior to TLS 1.2, the TLS handshake uses a fixed hashing routine to verify TLS handshake messages are not tampered with.</span></span> <span data-ttu-id="9c390-166">Начиная с версии 1.2 для подтверждения используется хэш-процедура, предоставляемая вместе с комплектом шифров.</span><span class="sxs-lookup"><span data-stu-id="9c390-166">Starting with version 1.2, the handshake uses the hash routine provided with the ciphersuite.</span></span> <span data-ttu-id="9c390-167">Протокол TLS не знает заранее, какая именно хэш-процедура будет использоваться, и должен кэшировать сообщения подтверждения.</span><span class="sxs-lookup"><span data-stu-id="9c390-167">TLS does not know ahead of time what hash routine will be used and must cache the handshake messages.</span></span> <span data-ttu-id="9c390-168">При записи хэша в SHA-256 протокол NetX Secure TLS может занимать меньше памяти, чем другие реализации TLS.</span><span class="sxs-lookup"><span data-stu-id="9c390-168">By fixing the hash to SHA-256, NetX Secure TLS can function with a smaller RAM footprint than other TLS implementations.</span></span> <span data-ttu-id="9c390-169">Это ограничение будет удалено в следующей версии, когда будет соответствующим образом реализовано использование памяти.</span><span class="sxs-lookup"><span data-stu-id="9c390-169">This limitation will be removed in a future version once the memory usage can be properly addressed.</span></span> <span data-ttu-id="9c390-170">\*Важное замечание. Это ограничение относится **только** к выбору комплекта шифров.</span><span class="sxs-lookup"><span data-stu-id="9c390-170">\*IMPORTANT NOTE: This limitation applies **only** to ciphersuite choice.</span></span> <span data-ttu-id="9c390-171">Оно не распространяется на подписи сертификатов X.509, и можно использовать любые поддерживаемые хэш-процедуры.</span><span class="sxs-lookup"><span data-stu-id="9c390-171">X.509 certificate signatures are not subject to the same limitation and any of the supported hash routines may be used.</span></span>
- <span data-ttu-id="9c390-172">Вследствие архитектуры встроенных устройств некоторые приложения могут не иметь ресурсов для поддержки максимального размера записи TLS в 16 КБ.</span><span class="sxs-lookup"><span data-stu-id="9c390-172">Due to the nature of embedded devices, some applications may not have the resources to support the maximum TLS record size of 16KB.</span></span> <span data-ttu-id="9c390-173">NetX Secure может обрабатывать записи размером в 16 КБ на устройствах с достаточными ресурсами.</span><span class="sxs-lookup"><span data-stu-id="9c390-173">NetX Secure can handle 16KB records on devices with sufficient resources.</span></span> <span data-ttu-id="9c390-174">При возникновении проблем совместимости для буфера повторной сборки TLS (см. описание *nx_secure_tls_session_packet_buffer_set* в справочнике по API) **можно** установить размер меньше 16 КБ.</span><span class="sxs-lookup"><span data-stu-id="9c390-174">The TLS reassembly buffer (see API reference for *nx_secure_tls_session_packet_buffer_set*) **may** be set to a size smaller than 16KB at the risk of interoperability problems.</span></span> <span data-ttu-id="9c390-175">Если получена допустимая запись TLS большего размера, чем буфер повторной сборки, NetX Secure TLS прерывает сеанс TLS с ошибкой.</span><span class="sxs-lookup"><span data-stu-id="9c390-175">If a valid TLS record is received that is larger than the reassembly buffer, NetX Secure TLS will abort the TLS session with an error.</span></span> <span data-ttu-id="9c390-176">В общем случае всегда должен быть задан размер буфера не менее 18 KB (размер записи TLS 16 КБ + 2 КБ для заполнения при шифровании), который можно уменьшить только посредством контролируемых параметров (например, если удаленный узел гарантирует максимальный размер записи TLS).</span><span class="sxs-lookup"><span data-stu-id="9c390-176">In general, the buffer should always be set to at least 18KB (16KB TLS record size + 2KB for encryption padding) and only made smaller in controlled settings (e.g. the remote host guarantees a maximum TLS record size).</span></span>
  > [!NOTE]
  > <span data-ttu-id="9c390-177">В общем случае буфер повторной сборки пакетов никогда не должен быть меньше, чем максимальный размер записи TLS.</span><span class="sxs-lookup"><span data-stu-id="9c390-177">In general, the packet reassembly buffer should never be smaller than the TLS maximum record size.</span></span> <span data-ttu-id="9c390-178">Однако если характеристики удаленного узла известны (например, в полностью закрытой системе), то размер можно уменьшить, чтобы освободить некоторый объем ОЗУ.</span><span class="sxs-lookup"><span data-stu-id="9c390-178">However, if the characteristics of the remote host are well known (e.g. in a completely closed system) the size can be reduced to regain some RAM space.</span></span>
- <span data-ttu-id="9c390-179">Минимальная проверка сертификатов.</span><span class="sxs-lookup"><span data-stu-id="9c390-179">Minimal certificate verification.</span></span> <span data-ttu-id="9c390-180">NetX Secure выполняет базовую проверку цепочки X.509 для сертификата, чтобы убедиться, что сертификат является действительным и подписан доверенным центром сертификации, и может предоставить общее имя сертификата приложению, которое сравнит его с доменным именем верхнего уровня удаленного узла.</span><span class="sxs-lookup"><span data-stu-id="9c390-180">NetX Secure will perform basic X.509 chain verification on a certificate to assure that the certificate is valid and signed by a trusted Certificate Authority, and can provide the certificate Common Name for the application to compare against the Top-Level Domain Name of the remote host.</span></span> <span data-ttu-id="9c390-181">Если доступны часы реального времени, то их можно использовать для проверки даты окончания срока действия сертификата (см. описание API nx_secure_tls_session_time_function_set).</span><span class="sxs-lookup"><span data-stu-id="9c390-181">If a real-time clock is available, it can be used to verify the certificate expiration date (see API nx_secure_tls_session_time_function_set).</span></span> <span data-ttu-id="9c390-182">Тем не менее, ответственность за проверку расширений сертификатов и других данных несет разработчик приложения.</span><span class="sxs-lookup"><span data-stu-id="9c390-182">However, verification of certificate extensions and other data is the responsibility of the application implementer.</span></span>
- <span data-ttu-id="9c390-183">Программное шифрование требует много ресурсов процессора.</span><span class="sxs-lookup"><span data-stu-id="9c390-183">Software-based cryptography is processor-intensive.</span></span> <span data-ttu-id="9c390-184">Программные криптографические процедуры NetX Secure оптимизированы для повышения производительности, но, в зависимости от мощности целевого процессора, эта нагрузка может привести к очень длительным операциям.</span><span class="sxs-lookup"><span data-stu-id="9c390-184">The NetX Secure software-based cryptographic routines have been optimized for performance, but depending on the power of the target processor, that performance may result in very long operations.</span></span> <span data-ttu-id="9c390-185">Если доступно аппаратное шифрование, следует использовать его, чтобы обеспечить оптимальную производительность NetX Secure TLS.</span><span class="sxs-lookup"><span data-stu-id="9c390-185">When hardware-based cryptography is available, it should be used for optimal performance of NetX Secure TLS.</span></span>
- <span data-ttu-id="9c390-186">Фрагментация записей подтверждения TLS не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="9c390-186">TLS Handshake Record fragmentation is unsupported.</span></span> <span data-ttu-id="9c390-187">Если сообщения записей подтверждения TLS слишком велики, они могут быть разделены на несколько записей TLS. В настоящее время NetX Secure TLS обрабатывает это как ошибку.</span><span class="sxs-lookup"><span data-stu-id="9c390-187">If certain TLS handshake record messages are too large, they may be split across multiple TLS records – NetX Secure TLS currently treats this as an error.</span></span> <span data-ttu-id="9c390-188">Требования к памяти для встроенных систем означают, что сообщение подтверждения большего размера, скорее всего, не будет обработано, а ограничение может привести к ошибкам при взаимодействии с определенными узлами TLS, использующими очень большие цепочки сертификатов.</span><span class="sxs-lookup"><span data-stu-id="9c390-188">The memory requirements for embedded systems mean that the larger handshake record message likely cannot be handled anyway but the limitation could lead to errors when communicating with certain TLS hosts that use excessively large certificate chains.</span></span>
- <span data-ttu-id="9c390-189">Сервер TLS не поддерживает динамический выбор сертификатов, если в локальном хранилище доступно несколько сертификатов.</span><span class="sxs-lookup"><span data-stu-id="9c390-189">TLS server does not support dynamic certificate selection when there are multiple certificates in the local store.</span></span> 
- <span data-ttu-id="9c390-190">Значение KeyUsage сертификата X.509 не отслеживается.</span><span class="sxs-lookup"><span data-stu-id="9c390-190">X509 Certificate KeyUsage is not observed.</span></span> 
- <span data-ttu-id="9c390-191">Комплекты шифров на основе ECDH не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="9c390-191">ECDH-based ciphersuites are not supported.</span></span> <span data-ttu-id="9c390-192">Вместо них используйте ECDHE.</span><span class="sxs-lookup"><span data-stu-id="9c390-192">Use ECDHE instead.</span></span>
