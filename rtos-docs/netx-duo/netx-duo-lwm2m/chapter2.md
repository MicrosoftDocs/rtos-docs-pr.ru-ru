---
title: Глава 2. Установка и использование клиента LWM2M для NetX Duo для ОСРВ
description: В этой главе описаны процессы установки и использования клиента LWM2M для NetX Duo для ОСРВ.
author: v-condav
ms.author: v-condav
ms.date: 01/22/2021
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 536225de30f54356157c222917fc904c6aa039fe
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104814687"
---
# <a name="chapter-2--installation-and-use-of-lwm2m-client"></a>Глава 2. Установка и использование клиента LWM2M

В этой главе обсуждаются вопросы, связанные с установкой, настройкой и использованием клиента LWM2M.

## <a name="product-distribution"></a>Распространение продукта

Клиент LWM2M для ОСРВ Azure можно получить из нашего репозитория общедоступного исходного кода по адресу [https://github.com/azure-rtos/netxduo/tree/master/addons/lwm2m](https://github.com/azure-rtos/netxduo/tree/master/addons/lwm2m/). Этот пакет содержит три исходных файла и один включаемый файл, перечисленные ниже:

* **nx\_lwm2m\_client.h** — файл заголовка для клиента LWM2M;

* **nx\_lwm2m\_client.c** — исходный файл C для клиента LWM2M;

* **demo\_netx\_lwm2m\_client.c** — исходный файл C для демонстрационного примера клиента LWM2M.

## <a name="lwm2m-client-installation"></a>Установка клиента LWM2M

Клиент LWM2M входит в состав NetX Duo. Это означает, что после клонирования NetX Duo из репозитория GitHub вы найдете клиент LWM2M в каталоге ***netxduo/addons/lwm2m***.

## <a name="using-lwm2m_client"></a>Использование клиента LWM2M\_

Использование клиента LWM2M не вызывает никаких трудностей. В коде приложения следует включить файл ***nx\_lwm2m\_client.h* *_ после _* _tx\_api.h_ *_ и _* _nx\_api.h_ *_, чтобы использовать ThreadX и NetX. После включения файла _* _nx\_lwm2m\_client.h_ *_ код приложения сможет выполнять вызовы функций LWM2M, указанные далее в этом руководстве. Также приложению нужно импортировать файл _* _nx\_lwm2m\_client\_.\**** в библиотеку NetX.

## <a name="configuration-options"></a>Параметры конфигурации

При сборке библиотеки клиента LWM2M и приложения, использующего клиент LWM2M, можно применить несколько параметров конфигурации. Параметры конфигурации можно определить в исходном коде приложения или в командной строке, если не указано иное.

| Параметр&nbsp;конфигурации | Описание |
| --- | --- |
| **NX\_LWM2M\_CLIENT\_MTU** | Определяет максимальный размер сообщения CoAP, включая заголовки IP и UDP. Значение по умолчанию — 1280. |
| **NX\_LWM2M\_CLIENT\_SOCKET\_TOS** | Тип требуемой службы для LwM2M UDP. По умолчанию это значение определено как NX\_IP\_NORMAL для указания обычной службы IP-пакетов. |
| **NX\_LWM2M\_CLIENT\_SOCKET\_TTL** | Указывает число маршрутизаторов, которые может пройти пакет, прежде чем его передача будет отменена. Значение по умолчанию — 0x80. |
| **NX\_LWM2M\_CLIENT\_SOCKET\_QUEUE\_MAX** | Определяет максимальную глубину для очереди получения. По умолчанию задано значение 4. |
| **NX\_LWM2M\_CLIENT\_MAX\_COAP\_URI\_PATH** | Определяет максимальную длину для параметра CoAP Uri-Path. По умолчанию задано значение 32. |
| **NX\_LWM2M\_CLIENT\_MAX\_DEVICE\_ERRORS** | Указывает максимальное количество кодов ошибок, хранящихся в объекте устройства. Значение по умолчанию: 8. |
| **NX\_LWM2M\_CLIENT\_MAX\_SECURITY\_INSTANCES** | Указывает максимальное число экземпляров объекта безопасности. По умолчанию имеет значение 2, чтобы поддерживать сервер начальной загрузки и стандартный сервер. |
| **NX\_LWM2M\_CLIENT\_MAX\_SERVER\_INSTANCES** | Указывает максимальное число экземпляров объекта сервера. По умолчанию имеет значение 1, чтобы поддерживать один стандартный сервер. |
| **NX\_LWM2M\_CLIENT\_MAX\_ACCESS\_CONTROL\_INSTANCES** | Указывает максимальное число экземпляров службы контроля доступа. По умолчанию имеет значение 0. При этом контроль доступа отключен. Если приложение поддерживает несколько серверов LWM2M, максимальное число экземпляров управления доступом должно совпадать с максимальным числом экземпляров объектов, которые будет поддерживать клиент LWM2M, так как для каждого экземпляра объекта (за исключением экземпляров объекта безопасности) должен быть создан один экземпляр управления доступом. |
| **NX\_LWM2M\_CLIENT\_MAX\_ACCESS\_CONTROL\_ACLS** | Указывает максимальное количество ресурсов ACL на каждый экземпляр службы контроля доступа. Значение по умолчанию — 4. |
| **NX\_LWM2M\_CLIENT\_MAX\_NOTIFICATIONS** | Указывает максимальное количество уведомлений, которые будет поддерживать клиент LWM2M. Сервер LWM2M может устанавливать уведомления для объектов, экземпляров объектов и ресурсов. Значение по умолчанию: 8. |
| **NX\_LWM2M\_CLIENT\_MAX\_RESOURCES** | Указывает максимальное количество ресурсов на объект. Значение по умолчанию: 32. |
| **NX\_LWM2M\_CLIENT\_MAX\_MULTIPLE\_RESOURCES** | Указывает максимальное число экземпляров ресурсов при поддержке нескольких ресурсов. Значение по умолчанию: 8. |
| **NX\_LWM2M\_CLIENT\_BOOTSTRAP\_IDLE\_TIMER** | Указывает максимальное время ожидания запросов сервера начальной загрузки при запуске сеанса начальной загрузки перед прерыванием сеанса. Значение по умолчанию — 60 секунд. |
| **NX\_LWM2M\_CLIENT\_DTLS\_START\_TIMEOUT** | Указывает максимальное время ожидания для завершения подтверждения DTLS. Значение по умолчанию - 30 секунды. |
| **NX\_LWM2M\_CLIENT\_DTLS\_END\_TIMEOUT** | Указывает максимальное время ожидания для завершения работы DTLS. Значение по умолчанию — 5 секунд. |
| **NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_SERVER\_URI** | Указывает максимальную длину URI сервера, включая завершающий нуль-символ. Значение по умолчанию — 128. |
| **NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_PUBLIC\_KEY\_OR\_IDENTITY** | Задает максимальную длину открытого ключа или удостоверения для DTLS. Значение по умолчанию — 128. |
| **NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_SERVER\_PUBLIC\_KEY** | Указывает максимальную длину открытого ключа сервера для DTLS. Значение по умолчанию — 128. |
| **NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_SECRET\_KEY** | Указывает максимальную длину закрытого ключа для DTLS. Значение по умолчанию — 128. |
| **NX\_LWM2M\_CLIENT\_HOLD\_OFF** | Указывает количество секунд ожидания перед инициацией начальной загрузки. Значение по умолчанию — 1 секунда. |
| **NX\_LWM2M\_CLIENT\_LIFE\_TIME** | Указывает количество секунд для времени существования регистрации. Значение по умолчанию — 600 секунд. |
