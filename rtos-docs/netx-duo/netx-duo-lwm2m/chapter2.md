---
title: Глава 2. Установка и использование клиента LWM2M для NetX Duo для ОСРВ
description: В этой главе описаны процессы установки и использования клиента LWM2M для NetX Duo для ОСРВ.
author: v-condav
ms.author: v-condav
ms.date: 01/22/2021
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 536225de30f54356157c222917fc904c6aa039fe
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104814687"
---
# <a name="chapter-2--installation-and-use-of-lwm2m-client"></a><span data-ttu-id="084d7-103">Глава 2. Установка и использование клиента LWM2M</span><span class="sxs-lookup"><span data-stu-id="084d7-103">Chapter 2  Installation and Use of LWM2M Client</span></span>

<span data-ttu-id="084d7-104">В этой главе обсуждаются вопросы, связанные с установкой, настройкой и использованием клиента LWM2M.</span><span class="sxs-lookup"><span data-stu-id="084d7-104">This chapter contains a description of various issues related to installation, setup, and usage of the LWM2M Client component.</span></span>

## <a name="product-distribution"></a><span data-ttu-id="084d7-105">Распространение продукта</span><span class="sxs-lookup"><span data-stu-id="084d7-105">Product Distribution</span></span>

<span data-ttu-id="084d7-106">Клиент LWM2M для ОСРВ Azure можно получить из нашего репозитория общедоступного исходного кода по адресу [https://github.com/azure-rtos/netxduo/tree/master/addons/lwm2m](https://github.com/azure-rtos/netxduo/tree/master/addons/lwm2m/).</span><span class="sxs-lookup"><span data-stu-id="084d7-106">Azure RTOS LWM2M Client can be obtained from our public source code repository at [https://github.com/azure-rtos/netxduo/tree/master/addons/lwm2m](https://github.com/azure-rtos/netxduo/tree/master/addons/lwm2m/).</span></span> <span data-ttu-id="084d7-107">Этот пакет содержит три исходных файла и один включаемый файл, перечисленные ниже:</span><span class="sxs-lookup"><span data-stu-id="084d7-107">The package includes three source files, one include files, as follows.</span></span>

* <span data-ttu-id="084d7-108">**nx\_lwm2m\_client.h** — файл заголовка для клиента LWM2M;</span><span class="sxs-lookup"><span data-stu-id="084d7-108">**nx\_lwm2m\_client.h** Header file for the LWM2M Client</span></span>

* <span data-ttu-id="084d7-109">**nx\_lwm2m\_client.c** — исходный файл C для клиента LWM2M;</span><span class="sxs-lookup"><span data-stu-id="084d7-109">**nx\_lwm2m\_client.c** C Source files for LWM2M Client</span></span>

* <span data-ttu-id="084d7-110">**demo\_netx\_lwm2m\_client.c** — исходный файл C для демонстрационного примера клиента LWM2M.</span><span class="sxs-lookup"><span data-stu-id="084d7-110">**demo\_netx\_lwm2m\_client.c** C Source file for LWM2M Client Demo</span></span>

## <a name="lwm2m-client-installation"></a><span data-ttu-id="084d7-111">Установка клиента LWM2M</span><span class="sxs-lookup"><span data-stu-id="084d7-111">LWM2M Client Installation</span></span>

<span data-ttu-id="084d7-112">Клиент LWM2M входит в состав NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="084d7-112">The LWM2M Client is part of NetX Duo.</span></span> <span data-ttu-id="084d7-113">Это означает, что после клонирования NetX Duo из репозитория GitHub вы найдете клиент LWM2M в каталоге ***netxduo/addons/lwm2m***.</span><span class="sxs-lookup"><span data-stu-id="084d7-113">Therefore, after cloning NetX Duo from the GitHub repository, LWM2M client source can be found at ***netxduo/addons/lwm2m***.</span></span>

## <a name="using-lwm2m_client"></a><span data-ttu-id="084d7-114">Использование клиента LWM2M\_</span><span class="sxs-lookup"><span data-stu-id="084d7-114">Using LWM2M\_Client</span></span>

<span data-ttu-id="084d7-115">Использование клиента LWM2M не вызывает никаких трудностей.</span><span class="sxs-lookup"><span data-stu-id="084d7-115">Using LWM2M Client is straightforward.</span></span> <span data-ttu-id="084d7-116">В коде приложения следует включить файл ***nx\_lwm2m\_client.h* *_ после _* _tx\_api.h_ *_ и _* _nx\_api.h_ *_, чтобы использовать ThreadX и NetX. После включения файла _* _nx\_lwm2m\_client.h_ *_ код приложения сможет выполнять вызовы функций LWM2M, указанные далее в этом руководстве. Также приложению нужно импортировать файл _* _nx\_lwm2m\_client\_.\***\* в библиотеку NetX.</span><span class="sxs-lookup"><span data-stu-id="084d7-116">Basically, the application code must include ***nx\_lwm2m\_client.h\*\*_ after it includes _*_tx\_api.h_*_ and _*_nx\_api.h_*_, in order to use ThreadX and NetX. Once _*_nx\_lwm2m\_client.h_*_ is included, the application code is then able to make the LWM2M Client function calls specified later in this guide. The application must also import the _* _nx\_lwm2m\_client\_.\***\* files into the NetX library.</span></span>

## <a name="configuration-options"></a><span data-ttu-id="084d7-117">Параметры конфигурации</span><span class="sxs-lookup"><span data-stu-id="084d7-117">Configuration Options</span></span>

<span data-ttu-id="084d7-118">При сборке библиотеки клиента LWM2M и приложения, использующего клиент LWM2M, можно применить несколько параметров конфигурации.</span><span class="sxs-lookup"><span data-stu-id="084d7-118">There are several configuration options when building the LWM2M Client library and the application using the LWM2M Client.</span></span> <span data-ttu-id="084d7-119">Параметры конфигурации можно определить в исходном коде приложения или в командной строке, если не указано иное.</span><span class="sxs-lookup"><span data-stu-id="084d7-119">The configuration options can be defined in the application source, on the command line, unless otherwise specified.</span></span>

| <span data-ttu-id="084d7-120">Параметр&nbsp;конфигурации</span><span class="sxs-lookup"><span data-stu-id="084d7-120">Configuration&nbsp;Option</span></span> | <span data-ttu-id="084d7-121">Описание</span><span class="sxs-lookup"><span data-stu-id="084d7-121">Description</span></span> |
| --- | --- |
| <span data-ttu-id="084d7-122">**NX\_LWM2M\_CLIENT\_MTU**</span><span class="sxs-lookup"><span data-stu-id="084d7-122">**NX\_LWM2M\_CLIENT\_MTU**</span></span> | <span data-ttu-id="084d7-123">Определяет максимальный размер сообщения CoAP, включая заголовки IP и UDP.</span><span class="sxs-lookup"><span data-stu-id="084d7-123">Specifies the maximum size of a CoAP message, including IP and UDP headers.</span></span> <span data-ttu-id="084d7-124">Значение по умолчанию — 1280.</span><span class="sxs-lookup"><span data-stu-id="084d7-124">The default value is 1280.</span></span> |
| <span data-ttu-id="084d7-125">**NX\_LWM2M\_CLIENT\_SOCKET\_TOS**</span><span class="sxs-lookup"><span data-stu-id="084d7-125">**NX\_LWM2M\_CLIENT\_SOCKET\_TOS**</span></span> | <span data-ttu-id="084d7-126">Тип требуемой службы для LwM2M UDP.</span><span class="sxs-lookup"><span data-stu-id="084d7-126">Type of service required for the LwM2M UDP.</span></span> <span data-ttu-id="084d7-127">По умолчанию это значение определено как NX\_IP\_NORMAL для указания обычной службы IP-пакетов.</span><span class="sxs-lookup"><span data-stu-id="084d7-127">By default, this value is defined as NX\_IP\_NORMAL to indicate normal IP packet service.</span></span> |
| <span data-ttu-id="084d7-128">**NX\_LWM2M\_CLIENT\_SOCKET\_TTL**</span><span class="sxs-lookup"><span data-stu-id="084d7-128">**NX\_LWM2M\_CLIENT\_SOCKET\_TTL**</span></span> | <span data-ttu-id="084d7-129">Указывает число маршрутизаторов, которые может пройти пакет, прежде чем его передача будет отменена.</span><span class="sxs-lookup"><span data-stu-id="084d7-129">Specifies the number of routers this packet can pass before it is discarded.</span></span> <span data-ttu-id="084d7-130">Значение по умолчанию — 0x80.</span><span class="sxs-lookup"><span data-stu-id="084d7-130">The default value is set to 0x80.</span></span> |
| <span data-ttu-id="084d7-131">**NX\_LWM2M\_CLIENT\_SOCKET\_QUEUE\_MAX**</span><span class="sxs-lookup"><span data-stu-id="084d7-131">**NX\_LWM2M\_CLIENT\_SOCKET\_QUEUE\_MAX**</span></span> | <span data-ttu-id="084d7-132">Определяет максимальную глубину для очереди получения.</span><span class="sxs-lookup"><span data-stu-id="084d7-132">Specifies the number of maximum depths of receive queue.</span></span> <span data-ttu-id="084d7-133">По умолчанию задано значение 4.</span><span class="sxs-lookup"><span data-stu-id="084d7-133">The default value is set to 4.</span></span> |
| <span data-ttu-id="084d7-134">**NX\_LWM2M\_CLIENT\_MAX\_COAP\_URI\_PATH**</span><span class="sxs-lookup"><span data-stu-id="084d7-134">**NX\_LWM2M\_CLIENT\_MAX\_COAP\_URI\_PATH**</span></span> | <span data-ttu-id="084d7-135">Определяет максимальную длину для параметра CoAP Uri-Path.</span><span class="sxs-lookup"><span data-stu-id="084d7-135">Specifies the number of maximum lengths of the CoAP Uri-Path option.</span></span> <span data-ttu-id="084d7-136">По умолчанию задано значение 32.</span><span class="sxs-lookup"><span data-stu-id="084d7-136">The default value is set to 32.</span></span> |
| <span data-ttu-id="084d7-137">**NX\_LWM2M\_CLIENT\_MAX\_DEVICE\_ERRORS**</span><span class="sxs-lookup"><span data-stu-id="084d7-137">**NX\_LWM2M\_CLIENT\_MAX\_DEVICE\_ERRORS**</span></span> | <span data-ttu-id="084d7-138">Указывает максимальное количество кодов ошибок, хранящихся в объекте устройства.</span><span class="sxs-lookup"><span data-stu-id="084d7-138">Specifies the maximum number of error codes stored by the Device Object.</span></span> <span data-ttu-id="084d7-139">Значение по умолчанию: 8.</span><span class="sxs-lookup"><span data-stu-id="084d7-139">The default value is 8.</span></span> |
| <span data-ttu-id="084d7-140">**NX\_LWM2M\_CLIENT\_MAX\_SECURITY\_INSTANCES**</span><span class="sxs-lookup"><span data-stu-id="084d7-140">**NX\_LWM2M\_CLIENT\_MAX\_SECURITY\_INSTANCES**</span></span> | <span data-ttu-id="084d7-141">Указывает максимальное число экземпляров объекта безопасности.</span><span class="sxs-lookup"><span data-stu-id="084d7-141">Specifies the maximum number of Security Object Instances.</span></span> <span data-ttu-id="084d7-142">По умолчанию имеет значение 2, чтобы поддерживать сервер начальной загрузки и стандартный сервер.</span><span class="sxs-lookup"><span data-stu-id="084d7-142">The default value is 2 for supporting a Bootstrap Server and a standard Server.</span></span> |
| <span data-ttu-id="084d7-143">**NX\_LWM2M\_CLIENT\_MAX\_SERVER\_INSTANCES**</span><span class="sxs-lookup"><span data-stu-id="084d7-143">**NX\_LWM2M\_CLIENT\_MAX\_SERVER\_INSTANCES**</span></span> | <span data-ttu-id="084d7-144">Указывает максимальное число экземпляров объекта сервера.</span><span class="sxs-lookup"><span data-stu-id="084d7-144">Specifies the maximum number of Server Object Instances.</span></span> <span data-ttu-id="084d7-145">По умолчанию имеет значение 1, чтобы поддерживать один стандартный сервер.</span><span class="sxs-lookup"><span data-stu-id="084d7-145">The default value is 1 for supporting a single standard Server.</span></span> |
| <span data-ttu-id="084d7-146">**NX\_LWM2M\_CLIENT\_MAX\_ACCESS\_CONTROL\_INSTANCES**</span><span class="sxs-lookup"><span data-stu-id="084d7-146">**NX\_LWM2M\_CLIENT\_MAX\_ACCESS\_CONTROL\_INSTANCES**</span></span> | <span data-ttu-id="084d7-147">Указывает максимальное число экземпляров службы контроля доступа.</span><span class="sxs-lookup"><span data-stu-id="084d7-147">Specifies the maximum number of Access Control Instances.</span></span> <span data-ttu-id="084d7-148">По умолчанию имеет значение 0. При этом контроль доступа отключен.</span><span class="sxs-lookup"><span data-stu-id="084d7-148">The default value is 0, which disables access control.</span></span> <span data-ttu-id="084d7-149">Если приложение поддерживает несколько серверов LWM2M, максимальное число экземпляров управления доступом должно совпадать с максимальным числом экземпляров объектов, которые будет поддерживать клиент LWM2M, так как для каждого экземпляра объекта (за исключением экземпляров объекта безопасности) должен быть создан один экземпляр управления доступом.</span><span class="sxs-lookup"><span data-stu-id="084d7-149">If the application supports more than one LWM2M Server, the maximum number of Access Control Instances must be set to the maximum number of Object Instances that the LWM2M Client will support, as one Access Control Instance must be created for each Object Instance (except for the Security Object Instances).</span></span> |
| <span data-ttu-id="084d7-150">**NX\_LWM2M\_CLIENT\_MAX\_ACCESS\_CONTROL\_ACLS**</span><span class="sxs-lookup"><span data-stu-id="084d7-150">**NX\_LWM2M\_CLIENT\_MAX\_ACCESS\_CONTROL\_ACLS**</span></span> | <span data-ttu-id="084d7-151">Указывает максимальное количество ресурсов ACL на каждый экземпляр службы контроля доступа.</span><span class="sxs-lookup"><span data-stu-id="084d7-151">Specifies the maximum number of ACL resources per Access Control Instance.</span></span> <span data-ttu-id="084d7-152">Значение по умолчанию — 4.</span><span class="sxs-lookup"><span data-stu-id="084d7-152">The default value is 4.</span></span> |
| <span data-ttu-id="084d7-153">**NX\_LWM2M\_CLIENT\_MAX\_NOTIFICATIONS**</span><span class="sxs-lookup"><span data-stu-id="084d7-153">**NX\_LWM2M\_CLIENT\_MAX\_NOTIFICATIONS**</span></span> | <span data-ttu-id="084d7-154">Указывает максимальное количество уведомлений, которые будет поддерживать клиент LWM2M.</span><span class="sxs-lookup"><span data-stu-id="084d7-154">Specifies the maximum number of notifications that the LWM2M Client will support.</span></span> <span data-ttu-id="084d7-155">Сервер LWM2M может устанавливать уведомления для объектов, экземпляров объектов и ресурсов.</span><span class="sxs-lookup"><span data-stu-id="084d7-155">A LWM2M Server can set notifications on Objects, Object Instances, and Resources.</span></span> <span data-ttu-id="084d7-156">Значение по умолчанию: 8.</span><span class="sxs-lookup"><span data-stu-id="084d7-156">The default value is 8.</span></span> |
| <span data-ttu-id="084d7-157">**NX\_LWM2M\_CLIENT\_MAX\_RESOURCES**</span><span class="sxs-lookup"><span data-stu-id="084d7-157">**NX\_LWM2M\_CLIENT\_MAX\_RESOURCES**</span></span> | <span data-ttu-id="084d7-158">Указывает максимальное количество ресурсов на объект.</span><span class="sxs-lookup"><span data-stu-id="084d7-158">Specifies the maximum number of Resources per Object.</span></span> <span data-ttu-id="084d7-159">Значение по умолчанию: 32.</span><span class="sxs-lookup"><span data-stu-id="084d7-159">The default value is 32.</span></span> |
| <span data-ttu-id="084d7-160">**NX\_LWM2M\_CLIENT\_MAX\_MULTIPLE\_RESOURCES**</span><span class="sxs-lookup"><span data-stu-id="084d7-160">**NX\_LWM2M\_CLIENT\_MAX\_MULTIPLE\_RESOURCES**</span></span> | <span data-ttu-id="084d7-161">Указывает максимальное число экземпляров ресурсов при поддержке нескольких ресурсов.</span><span class="sxs-lookup"><span data-stu-id="084d7-161">Specifies the maximum number of Resources instances for multiple resource.</span></span> <span data-ttu-id="084d7-162">Значение по умолчанию: 8.</span><span class="sxs-lookup"><span data-stu-id="084d7-162">The default value is 8.</span></span> |
| <span data-ttu-id="084d7-163">**NX\_LWM2M\_CLIENT\_BOOTSTRAP\_IDLE\_TIMER**</span><span class="sxs-lookup"><span data-stu-id="084d7-163">**NX\_LWM2M\_CLIENT\_BOOTSTRAP\_IDLE\_TIMER**</span></span> | <span data-ttu-id="084d7-164">Указывает максимальное время ожидания запросов сервера начальной загрузки при запуске сеанса начальной загрузки перед прерыванием сеанса.</span><span class="sxs-lookup"><span data-stu-id="084d7-164">Specifies the maximum time to wait for bootstrap server requests when the bootstrap session is initiated before aborting the session.</span></span> <span data-ttu-id="084d7-165">Значение по умолчанию — 60 секунд.</span><span class="sxs-lookup"><span data-stu-id="084d7-165">The default value is 60 seconds.</span></span> |
| <span data-ttu-id="084d7-166">**NX\_LWM2M\_CLIENT\_DTLS\_START\_TIMEOUT**</span><span class="sxs-lookup"><span data-stu-id="084d7-166">**NX\_LWM2M\_CLIENT\_DTLS\_START\_TIMEOUT**</span></span> | <span data-ttu-id="084d7-167">Указывает максимальное время ожидания для завершения подтверждения DTLS.</span><span class="sxs-lookup"><span data-stu-id="084d7-167">Specifies the maximum time to wait for DTLS handshake completion.</span></span> <span data-ttu-id="084d7-168">Значение по умолчанию - 30 секунды.</span><span class="sxs-lookup"><span data-stu-id="084d7-168">The default value is 30 seconds.</span></span> |
| <span data-ttu-id="084d7-169">**NX\_LWM2M\_CLIENT\_DTLS\_END\_TIMEOUT**</span><span class="sxs-lookup"><span data-stu-id="084d7-169">**NX\_LWM2M\_CLIENT\_DTLS\_END\_TIMEOUT**</span></span> | <span data-ttu-id="084d7-170">Указывает максимальное время ожидания для завершения работы DTLS.</span><span class="sxs-lookup"><span data-stu-id="084d7-170">Specifies the maximum time to wait for DTLS shutdown completion.</span></span> <span data-ttu-id="084d7-171">Значение по умолчанию — 5 секунд.</span><span class="sxs-lookup"><span data-stu-id="084d7-171">The default value is 5 seconds.</span></span> |
| <span data-ttu-id="084d7-172">**NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_SERVER\_URI**</span><span class="sxs-lookup"><span data-stu-id="084d7-172">**NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_SERVER\_URI**</span></span> | <span data-ttu-id="084d7-173">Указывает максимальную длину URI сервера, включая завершающий нуль-символ.</span><span class="sxs-lookup"><span data-stu-id="084d7-173">Specifies the maximum length of a server URI, including terminating null character.</span></span> <span data-ttu-id="084d7-174">Значение по умолчанию — 128.</span><span class="sxs-lookup"><span data-stu-id="084d7-174">The default value is 128.</span></span> |
| <span data-ttu-id="084d7-175">**NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_PUBLIC\_KEY\_OR\_IDENTITY**</span><span class="sxs-lookup"><span data-stu-id="084d7-175">**NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_PUBLIC\_KEY\_OR\_IDENTITY**</span></span> | <span data-ttu-id="084d7-176">Задает максимальную длину открытого ключа или удостоверения для DTLS.</span><span class="sxs-lookup"><span data-stu-id="084d7-176">Specifies the maximum length of the public key or identity for DTLS.</span></span> <span data-ttu-id="084d7-177">Значение по умолчанию — 128.</span><span class="sxs-lookup"><span data-stu-id="084d7-177">The default value is 128.</span></span> |
| <span data-ttu-id="084d7-178">**NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_SERVER\_PUBLIC\_KEY**</span><span class="sxs-lookup"><span data-stu-id="084d7-178">**NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_SERVER\_PUBLIC\_KEY**</span></span> | <span data-ttu-id="084d7-179">Указывает максимальную длину открытого ключа сервера для DTLS.</span><span class="sxs-lookup"><span data-stu-id="084d7-179">Specifies the maximum length of the server public key for DTLS.</span></span> <span data-ttu-id="084d7-180">Значение по умолчанию — 128.</span><span class="sxs-lookup"><span data-stu-id="084d7-180">The default value is 128.</span></span> |
| <span data-ttu-id="084d7-181">**NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_SECRET\_KEY**</span><span class="sxs-lookup"><span data-stu-id="084d7-181">**NX\_LWM2M\_CLIENT\_SECURITY\_MAX\_SECRET\_KEY**</span></span> | <span data-ttu-id="084d7-182">Указывает максимальную длину закрытого ключа для DTLS.</span><span class="sxs-lookup"><span data-stu-id="084d7-182">Specifies the maximum length of the secret key for DTLS.</span></span> <span data-ttu-id="084d7-183">Значение по умолчанию — 128.</span><span class="sxs-lookup"><span data-stu-id="084d7-183">The default value is 128.</span></span> |
| <span data-ttu-id="084d7-184">**NX\_LWM2M\_CLIENT\_HOLD\_OFF**</span><span class="sxs-lookup"><span data-stu-id="084d7-184">**NX\_LWM2M\_CLIENT\_HOLD\_OFF**</span></span> | <span data-ttu-id="084d7-185">Указывает количество секунд ожидания перед инициацией начальной загрузки.</span><span class="sxs-lookup"><span data-stu-id="084d7-185">Specifies the number of seconds to wait before initiating bootstrap.</span></span> <span data-ttu-id="084d7-186">Значение по умолчанию — 1 секунда.</span><span class="sxs-lookup"><span data-stu-id="084d7-186">The default value is 1 second.</span></span> |
| <span data-ttu-id="084d7-187">**NX\_LWM2M\_CLIENT\_LIFE\_TIME**</span><span class="sxs-lookup"><span data-stu-id="084d7-187">**NX\_LWM2M\_CLIENT\_LIFE\_TIME**</span></span> | <span data-ttu-id="084d7-188">Указывает количество секунд для времени существования регистрации.</span><span class="sxs-lookup"><span data-stu-id="084d7-188">Specifies the number of seconds for the registration lifetime.</span></span> <span data-ttu-id="084d7-189">Значение по умолчанию — 600 секунд.</span><span class="sxs-lookup"><span data-stu-id="084d7-189">The default value is 600 seconds.</span></span> |
