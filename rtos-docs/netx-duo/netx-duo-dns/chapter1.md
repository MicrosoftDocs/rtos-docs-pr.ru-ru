---
title: Глава 1. Введение в клиент DNS NetX Duo для ОСРВ Azure
description: Служба DNS предоставляет распределенную базу данных, которая содержит сведения о сопоставлении между доменными именами и физическими IP-адресами.
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 4c07d6e3183d421c637874dcdeff3767554fca78
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104814736"
---
# <a name="chapter-1---introduction-to-the-azure-rtos-netx-duo-dns-client"></a><span data-ttu-id="f42c8-103">Глава 1. Введение в клиент DNS NetX Duo для ОСРВ Azure</span><span class="sxs-lookup"><span data-stu-id="f42c8-103">Chapter 1 - Introduction to the Azure RTOS NetX Duo DNS Client</span></span>

<span data-ttu-id="f42c8-104">Служба DNS предоставляет распределенную базу данных, которая содержит сведения о сопоставлении между доменными именами и физическими IP-адресами.</span><span class="sxs-lookup"><span data-stu-id="f42c8-104">The DNS provides a distributed database that contains mapping between domain names and physical IP addresses.</span></span> <span data-ttu-id="f42c8-105">База данных называется *распределенной*, так как в Интернете нет единой сущности, содержащей полные сведения о сопоставлении.</span><span class="sxs-lookup"><span data-stu-id="f42c8-105">The database is referred to as *distributed* because there is no single entity on the Internet that contains the complete mapping.</span></span> <span data-ttu-id="f42c8-106">Сущность, которая обслуживает часть сведений о сопоставлении, называется DNS-сервером.</span><span class="sxs-lookup"><span data-stu-id="f42c8-106">An entity that maintains a portion of the mapping is called a DNS Server.</span></span> <span data-ttu-id="f42c8-107">Интернет состоит из многочисленных DNS-серверов, каждый из которых содержит подмножество указанной базы данных.</span><span class="sxs-lookup"><span data-stu-id="f42c8-107">The Internet is composed of numerous DNS Servers, each of which contains a subset of the database.</span></span> <span data-ttu-id="f42c8-108">DNS-серверы также отвечают на запросы клиентов DNS на предоставление сведений о сопоставлении доменных имен, только если соответствующий сервер содержит запрошенное сопоставление.</span><span class="sxs-lookup"><span data-stu-id="f42c8-108">DNS Servers also respond to DNS Client requests for domain name mapping information, only if the server has the requested mapping.</span></span>

<span data-ttu-id="f42c8-109">Протокол клиента DNS для NetX Duo предоставляет приложению службы для запроса сведений о сопоставлении с одного DNS-сервера или нескольких.</span><span class="sxs-lookup"><span data-stu-id="f42c8-109">The DNS Client protocol for NetX Duo provides the application with services to request mapping information from one or more DNS Servers.</span></span>

## <a name="dns-client-setup"></a><span data-ttu-id="f42c8-110">Установка клиента DNS</span><span class="sxs-lookup"><span data-stu-id="f42c8-110">DNS Client Setup</span></span>

<span data-ttu-id="f42c8-111">Для правильной работы пакета клиента DNS требуется, чтобы экземпляр IP в NetX Duo уже был создан.</span><span class="sxs-lookup"><span data-stu-id="f42c8-111">In order to function properly, the DNS Client package requires that a NetX Duo IP instance has already been created.</span></span>

<span data-ttu-id="f42c8-112">После создания клиента DNS приложение должно добавить один DNS-сервер или несколько в список серверов, обслуживаемый клиентом DNS.</span><span class="sxs-lookup"><span data-stu-id="f42c8-112">After creating the DNS Client, the application must add one or more DNS servers to the server list maintained by the DNS Client.</span></span> <span data-ttu-id="f42c8-113">Для добавления DNS-серверов приложение использует службу *nxd_dns_server_add*.</span><span class="sxs-lookup"><span data-stu-id="f42c8-113">To add DNS servers, the application uses the *nxd_dns_server_add* service.</span></span> <span data-ttu-id="f42c8-114">Службу *nx_dns_server_add* клиента NetX Duo также можно использовать для добавления серверов.</span><span class="sxs-lookup"><span data-stu-id="f42c8-114">The NetX Duo DNS Client service *nx_dns_server_add* can also be used to add servers.</span></span> <span data-ttu-id="f42c8-115">Однако она принимает только IPv4-адреса, поэтому разработчикам рекомендуется использовать вместо этого службу *nxd_dns_server_add*.</span><span class="sxs-lookup"><span data-stu-id="f42c8-115">However it only accepts IPv4 addresses and it is recommended that developers use the *nxd_dns_server_add* service instead.</span></span>

<span data-ttu-id="f42c8-116">Если параметр NX_DNS_IP_GATEWAY_SERVER включен, а адрес шлюза экземпляра IP-адреса не равен нулю, то шлюз экземпляра IP-адреса автоматически добавляется в качестве основного DNS-сервера.</span><span class="sxs-lookup"><span data-stu-id="f42c8-116">If the NX_DNS_IP_GATEWAY_SERVER option is enabled, and the IP instance gateway address is non zero, the IP instance gateway is automatically added as the primary DNS server.</span></span> <span data-ttu-id="f42c8-117">Если сведения о DNS-сервере не заданы статически, их также можно получить с помощью протокола DHCP для NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="f42c8-117">If DNS server information is not statically known, it may also be derived through the Dynamic Host Configuration Protocol (DHCP) for NetX Duo.</span></span> <span data-ttu-id="f42c8-118">Дополнительные сведения см. в руководстве пользователя по DHCP для NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="f42c8-118">Please refer to the NetX Duo DHCP User Guide for more information.</span></span>

<span data-ttu-id="f42c8-119">Клиенту DNS нужен пул пакетов для передачи сообщений DNS.</span><span class="sxs-lookup"><span data-stu-id="f42c8-119">The DNS Client requires a packet pool for transmitting DNS messages.</span></span> <span data-ttu-id="f42c8-120">По умолчанию клиент DNS создает этот пул пакетов при вызове службы *nx_dns_create*.</span><span class="sxs-lookup"><span data-stu-id="f42c8-120">By default, the DNS Client creates this packet pool when the *nx_dns_create* service is called.</span></span> <span data-ttu-id="f42c8-121">Параметры конфигурации NX_DNS_PACKET_PAYLOAD_UNALIGNED и NX_DNS_PACKET_POOL_SIZE позволяют приложению определить полезные данные пакета и размер (то есть число пакетов) этого пула пакетов соответственно.</span><span class="sxs-lookup"><span data-stu-id="f42c8-121">The configuration options NX_DNS_PACKET_PAYLOAD_UNALIGNED and NX_DNS_PACKET_POOL_SIZE allow the application to determine the packet payload and packet pool size (e.g. number of packets) of this packet pool respectively.</span></span> <span data-ttu-id="f42c8-122">Эти параметры описаны в разделе "Параметры конфигурации" главы 2.</span><span class="sxs-lookup"><span data-stu-id="f42c8-122">These options are described in section “Configuration Options” in Chapter Two.</span></span>

<span data-ttu-id="f42c8-123">Альтернативой клиенту DNS, создающему свой пул пакетов, является создание приложением пула пакетов и его назначение в качестве пула пакетов клиента DNS с помощью службы *nx_dns_packet_pool_set*.</span><span class="sxs-lookup"><span data-stu-id="f42c8-123">An alternative to the DNS Client creating its own packet pool is for the application to create the packet pool and set it as the DNS Client’s packet pool using the *nx_dns_packet_pool_set* service.</span></span> <span data-ttu-id="f42c8-124">Для этого необходимо определить параметр NX_DNS_CLIENT_USER_CREATE_PACKET_POOL.</span><span class="sxs-lookup"><span data-stu-id="f42c8-124">To do so, the NX_DNS_CLIENT_USER_CREATE_PACKET_POOL option must be defined.</span></span> <span data-ttu-id="f42c8-125">Этот параметр также требует ранее созданный с помощью *nx_packet_pool_create* пул пакетов, используемый в качестве входных данных указателя пула пакетов для *nx_dns_packet_pool_set*.</span><span class="sxs-lookup"><span data-stu-id="f42c8-125">This option also requires a previously created packet pool using *nx_packet_pool_create* as the packet pool pointer input to *nx_dns_packet_pool_set* .</span></span> <span data-ttu-id="f42c8-126">При удалении экземпляра клиента DNS приложение отвечает за удаление пула пакетов клиента DNS, если он больше не требуется, когда включен параметр NX_DNS_CLIENT_USER_CREATE_PACKET_POOL.</span><span class="sxs-lookup"><span data-stu-id="f42c8-126">When the DNS Client instance is deleted, the application is responsible for deleting the DNS Client packet pool if NX_DNS_CLIENT_USER_CREATE_PACKET_POOL is enabled if it is no longer needed.</span></span>

> [!NOTE] 
> <span data-ttu-id="f42c8-127">Для приложений, которые предоставляют собственный пул пакетов с помощью параметра NX_DNS_CLIENT_USER_CREATE_PACKET_POOL, размер пакета должен вмещать в себя сообщение DNS максимального размера (512 байт), а также заголовок UDP, заголовок IPv4 или IPv6 и заголовок MAC.</span><span class="sxs-lookup"><span data-stu-id="f42c8-127">For applications choosing to provide its own packet pool using the NX_DNS_CLIENT_USER_CREATE_PACKET_POOL option, the packet size needs to be able to hold the DNS maximum massage size (512 bytes) plus rooms for UDP header, IPv4 or IPv6 header, and the MAC header.</span></span>

## <a name="dns-messages"></a><span data-ttu-id="f42c8-128">Сообщения DNS</span><span class="sxs-lookup"><span data-stu-id="f42c8-128">DNS Messages</span></span>

<span data-ttu-id="f42c8-129">DNS имеет очень простой механизм получения сопоставления между именами узлов и IP-адресами.</span><span class="sxs-lookup"><span data-stu-id="f42c8-129">The DNS has a very simple mechanism for obtaining mapping between host names and IP addresses.</span></span> <span data-ttu-id="f42c8-130">Чтобы получить сопоставление, клиент DNS подготавливает сообщение запроса DNS, содержащее имя или IP-адрес, которые необходимо разрешить.</span><span class="sxs-lookup"><span data-stu-id="f42c8-130">To obtain a mapping, the DNS Client prepares a DNS query message containing the name or the IP address that needs to be resolved.</span></span> <span data-ttu-id="f42c8-131">Затем сообщение отправляется на первый DNS-сервер в списке серверов.</span><span class="sxs-lookup"><span data-stu-id="f42c8-131">The message is then sent to the first DNS server in the server list.</span></span> <span data-ttu-id="f42c8-132">Если сервер содержит такое сопоставление, он отвечает клиенту DNS, используя ответное сообщение DNS, содержащее запрошенные сведения о сопоставлении.</span><span class="sxs-lookup"><span data-stu-id="f42c8-132">If the server has such a mapping, it replies to the DNS Client using a DNS response message that contains the requested mapping information.</span></span> <span data-ttu-id="f42c8-133">Если сервер не отвечает, клиент DNS отправляет запрос следующему серверу в списке, пока не будут запрошены все DNS-серверы.</span><span class="sxs-lookup"><span data-stu-id="f42c8-133">If the server does not respond, the DNS Client queries the next server on its list until all its DNS servers have been queried.</span></span> <span data-ttu-id="f42c8-134">Если не получен ответ ни от одного из DNS-серверов, клиент DNS использует логику повторных попыток для повторной передачи сообщения DNS.</span><span class="sxs-lookup"><span data-stu-id="f42c8-134">If no response from all its DNS servers is received, the DNS Client has retry logic to retransmit the DNS message.</span></span> <span data-ttu-id="f42c8-135">При повторной отправке запроса DNS время ожидания повторной передачи удваивается.</span><span class="sxs-lookup"><span data-stu-id="f42c8-135">On resending a DNS query, the retransmission timeout is doubled.</span></span> <span data-ttu-id="f42c8-136">Этот процесс продолжает до тех пор, пока не будет достигнуто максимальное время ожидания передачи (определенное NX_DNS_MAX_RETRANS_TIMEOUT в *nxd_dns.h*) или пока не будет получен успешный ответ от такого сервера.</span><span class="sxs-lookup"><span data-stu-id="f42c8-136">This process continues until the maximum transmission timeout (defined as NX_DNS_MAX_RETRANS_TIMEOUT in *nxd_dns.h*) is reached or until a successful response is received from that server is obtained.</span></span>

<span data-ttu-id="f42c8-137">Клиент DNS NetX Duo может выполнять операции поиска IPv6-адресов (типа AAAA) и IPv4-адресов (типа A), указывая версию IP-адреса в вызове *nxd_dns_host_by_name_get*.</span><span class="sxs-lookup"><span data-stu-id="f42c8-137">NetX Duo DNS Client can perform both IPv6 address lookups (type AAAA) and IPv4 address lookups (type A) by specifying the version of the IP address in the *nxd_dns_host_by_name_get* call.</span></span> <span data-ttu-id="f42c8-138">Клиент DNS может выполнять обратный просмотр IP-адресов (запросы типа PTR) для получения имен веб-узлов с помощью *nxd_dns_host_by_address_get*.</span><span class="sxs-lookup"><span data-stu-id="f42c8-138">The DNS Client can perform reverse lookups of IP addresses (type PTR queries) to obtain web host names using *nxd_dns_host_by_address_get*.</span></span> <span data-ttu-id="f42c8-139">Клиент DNS NetX Duo по-прежнему поддерживает службы *nx_dns_host_by_name_get* и *nx_dns_host_by_address_get*, которые являются эквивалентными, но ограничены только соединениями по протоколу IPv4.</span><span class="sxs-lookup"><span data-stu-id="f42c8-139">The NetX Duo DNS Client still supports the *nx_dns_host_by_name_get* and *nx_dns_host_by_address_get* which are the equivalent services but which are limited to IPv4 network communication.</span></span> <span data-ttu-id="f42c8-140">Однако разработчикам рекомендуется перевести существующие клиентские приложения DNS на использование служб *nxd_dns_host_by_name_get* и *nxd_dns_host_by_address_get*.</span><span class="sxs-lookup"><span data-stu-id="f42c8-140">However, developers are encouraged to port existing DNS Client applications to the *nxd_dns_host_by_name_get* and *nxd_dns_host_by_address_get* services.</span></span>

<span data-ttu-id="f42c8-141">Служба обмена сообщениями DNS использует протокол UDP для отправки запросов и ответов полей.</span><span class="sxs-lookup"><span data-stu-id="f42c8-141">DNS messaging utilizes the UDP protocol to send requests and field responses.</span></span> <span data-ttu-id="f42c8-142">DNS-сервер прослушивает номер порта 53 на предмет запросов от клиентов.</span><span class="sxs-lookup"><span data-stu-id="f42c8-142">A DNS Server listens on port number 53 for queries from clients.</span></span> <span data-ttu-id="f42c8-143">Поэтому в NetX Duo с помощью службы ***nx_udp_enable** _ должны быть включены службы UDP для ранее созданного экземпляра IP (_*_nx_ip_create_\*\*).</span><span class="sxs-lookup"><span data-stu-id="f42c8-143">Therefore UDP services must be enabled in NetX Duo using the ***nx_udp_enable** _ service on a previously created IP instance (_*_nx_ip_create_\*\*).</span></span>

<span data-ttu-id="f42c8-144">На этом этапе клиент DNS готов принимать запросы от приложения и отправлять запросы DNS.</span><span class="sxs-lookup"><span data-stu-id="f42c8-144">At this point, the DNS Client is ready to accept requests from the application and send out DNS queries.</span></span>

## <a name="extended-dns-resource-record-types"></a><span data-ttu-id="f42c8-145">Расширенные типы записей ресурсов DNS</span><span class="sxs-lookup"><span data-stu-id="f42c8-145">Extended DNS Resource Record Types</span></span>

<span data-ttu-id="f42c8-146">Если параметр NX_DNS_ENABLE_EXTENDED_RR_TYPES включен, клиент DNS для NetX Duo также поддерживает запросы следующих типов записей.</span><span class="sxs-lookup"><span data-stu-id="f42c8-146">If NX_DNS_ENABLE_EXTENDED_RR_TYPES is enabled, NetX Duo DNS Client also supports the following record type queries:</span></span>

- <span data-ttu-id="f42c8-147">CNAME: содержит каноническое имя для псевдонима.</span><span class="sxs-lookup"><span data-stu-id="f42c8-147">CNAME: contains the canonical name for an alias</span></span>
- <span data-ttu-id="f42c8-148">TXT: содержит текстовую строку.</span><span class="sxs-lookup"><span data-stu-id="f42c8-148">TXT: contains a text string</span></span>
- <span data-ttu-id="f42c8-149">NS: содержит полномочный сервер доменных имен.</span><span class="sxs-lookup"><span data-stu-id="f42c8-149">NS: contains an authoritative name server</span></span>
- <span data-ttu-id="f42c8-150">SOA: содержит начало зоны.</span><span class="sxs-lookup"><span data-stu-id="f42c8-150">SOA: contains the start of a zone of authority</span></span>
- <span data-ttu-id="f42c8-151">MX: используется для обмена электронной почтой.</span><span class="sxs-lookup"><span data-stu-id="f42c8-151">MX: used for mail exchange</span></span>
- <span data-ttu-id="f42c8-152">SRV: содержит сведения о службе, предоставляемой доменом.</span><span class="sxs-lookup"><span data-stu-id="f42c8-152">SRV: contains information on the service offered by the domain</span></span>

<span data-ttu-id="f42c8-153">За исключением типов записей CNAME и TXT, приложение должно предоставить 4-байтовый выровненный буфер для получения записи данных DNS.</span><span class="sxs-lookup"><span data-stu-id="f42c8-153">With the exception of CNAME and TXT record types, the application must supply a 4-byte aligned buffer to receive the DNS data record.</span></span>

<span data-ttu-id="f42c8-154">В клиенте DNS для NetX Duo данные записи хранятся таким образом, чтобы наиболее эффективно использовать место в буфере.</span><span class="sxs-lookup"><span data-stu-id="f42c8-154">In NetX Duo DNS Client, record data is stored in such a way to make most efficient use of buffer space.</span></span>

<span data-ttu-id="f42c8-155">Ниже приведен пример буфера записей фиксированной длины (запись типа AAAA).</span><span class="sxs-lookup"><span data-stu-id="f42c8-155">An example of a record buffer of fixed length (type AAAA record) is shown below:</span></span>

![Буфер записей фиксированной длины](media/image2.png)

<span data-ttu-id="f42c8-157">Для тех запросов, типы записей которых имеют переменную длину данных, как, например, записи NS, у которых имена узлов имеют переменную длину, клиент DNS для NetX Duo сохраняет данные следующим образом.</span><span class="sxs-lookup"><span data-stu-id="f42c8-157">For those queries whose record types have variable data length, such as NS records whose host names are of variable length, NetX Duo DNS Client saves the data as follows.</span></span> <span data-ttu-id="f42c8-158">Буфер, заданный в запросе клиента DNS, организован в виде области данных фиксированной длины и области неструктурированной памяти.</span><span class="sxs-lookup"><span data-stu-id="f42c8-158">The buffer supplied in the DNS Client query is organized into an area of fixed length data and an area of unstructured memory.</span></span> <span data-ttu-id="f42c8-159">Верхняя часть буфера памяти поделена на 4-байтовые выровненные элементы записи.</span><span class="sxs-lookup"><span data-stu-id="f42c8-159">The top of the memory buffer is organized into 4-byte aligned record entries.</span></span> <span data-ttu-id="f42c8-160">Каждый элемент записи содержит IP-адрес и указатель на данные переменной длины для этого IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="f42c8-160">Each record entry contains the IP address and a pointer to the variable length data for that IP address.</span></span> <span data-ttu-id="f42c8-161">Данные переменной длины для каждого IP-адреса хранятся в области неструктурированной памяти, начиная с конца буфера памяти.</span><span class="sxs-lookup"><span data-stu-id="f42c8-161">The variable length data for each IP address are stored in the unstructured area memory starting at the end of the memory buffer.</span></span> <span data-ttu-id="f42c8-162">Данные переменной длины для каждого последующего элемента записи сохраняются в следующей области памяти, примыкающей к данным переменной длинны предыдущих элементов записи.</span><span class="sxs-lookup"><span data-stu-id="f42c8-162">The variable length data for each successive record entry is saved in the next area memory adjacent to the previous record entries variable data.</span></span> <span data-ttu-id="f42c8-163">Таким образом, данные переменной длины "нарастают" в сторону области структурированной памяти, содержащей элементы записи, до тех пор, пока не перестанет хватать памяти для сохранения очередного элемента записи и данных переменной длины.</span><span class="sxs-lookup"><span data-stu-id="f42c8-163">Hence, the variable data ‘grows’ towards the structured area of memory containing the record entries until there is insufficient memory to store another record entry and variable data.</span></span>

<span data-ttu-id="f42c8-164">Это показано ниже.</span><span class="sxs-lookup"><span data-stu-id="f42c8-164">This is shown in the figure below:</span></span>

![Рис. 2](media/image3.png)

<span data-ttu-id="f42c8-166">Выше приведен пример хранилища данных доменных имен DNS (NS).</span><span class="sxs-lookup"><span data-stu-id="f42c8-166">The example of the DNS domain name (NS) data storage is shown above.</span></span>

<span data-ttu-id="f42c8-167">Запросы клиента DNS для NetX Duo, использующие формат хранения записей, возвращают число записей, сохраненных в буфере записи.</span><span class="sxs-lookup"><span data-stu-id="f42c8-167">NetX Duo DNS Client queries using the record storage format return the number of records saved to the record buffer.</span></span> <span data-ttu-id="f42c8-168">Эта информация позволяет приложению извлекать записи NS из буфера записей.</span><span class="sxs-lookup"><span data-stu-id="f42c8-168">This information enables the application to extract NS records from the record buffer.</span></span>

<span data-ttu-id="f42c8-169">Ниже приведен пример запроса клиента DNS, который сохраняет данные переменной длины DNS с помощью этого формата хранения записей.</span><span class="sxs-lookup"><span data-stu-id="f42c8-169">An example of a DNS Client query that stores variable length DNS data using this record storage format is shown below:</span></span>

```C
UINT  _nx_dns_domain_name_server_get(NX_DNS *dns_ptr, 
                    UCHAR *host_name, VOID *record_buffer, 
                    UINT buffer_size, UINT *record_count, 
                    ULONG wait_option);
```


<span data-ttu-id="f42c8-170">Дополнительные сведения см. в главе 3, "Описание служб клиента DNS".</span><span class="sxs-lookup"><span data-stu-id="f42c8-170">More details are available in Chapter 3, “Description of DNS Client Services”.</span></span>

## <a name="dns-cache"></a><span data-ttu-id="f42c8-171">Кэш DNS</span><span class="sxs-lookup"><span data-stu-id="f42c8-171">DNS Cache</span></span>

<span data-ttu-id="f42c8-172">Если параметр NX_DNS_CACHE_ENABLE включен, клиент DNS для NetX Duo поддерживает функцию кэша DNS.</span><span class="sxs-lookup"><span data-stu-id="f42c8-172">If NX_DNS_CACHE_ENABLE is enabled, NetX Duo DNS Client supports the DNS Cache feature.</span></span> <span data-ttu-id="f42c8-173">После создания клиента DNS приложение может вызвать API *nx_dns_cache_initialize()* , чтобы задать специальный кэш DNS.</span><span class="sxs-lookup"><span data-stu-id="f42c8-173">After creating the DNS Client, the application can call the API *nx_dns_cache_initialize()* to set the special DNS Cache.</span></span> <span data-ttu-id="f42c8-174">Если включить функцию кэша DNS, клиент DNS выполнит поиск доступного ответа в кэше DNS перед началом отправки запроса DNS. При нахождении доступного ответа он возвращается напрямую приложению, в противном случае клиент DNS отправляет сообщение запроса на DNS-сервер и ждет ответа.</span><span class="sxs-lookup"><span data-stu-id="f42c8-174">If enable DNS Cache feature, DNS Client will find the available answer from DNS Cache before starts to send DNS query, if find the available answer, directly return the answer to application, otherwise DNS Client sends out query message to DNS server and waits for the reply.</span></span> <span data-ttu-id="f42c8-175">Когда клиент DNS получает ответное сообщение и доступен свободный кэш, клиент DNS возвращает ответ приложению, а также добавляет этот ответ в качестве записи ресурса в кэш DNS.</span><span class="sxs-lookup"><span data-stu-id="f42c8-175">When DNS Client gets the response message and there is free cache available, DNS Client returns the answer to the application and also adds the answer as resource record into DNS cache.</span></span>

<span data-ttu-id="f42c8-176">Каждый ответ представляет собой структуру данных *NX_DNS_RR* (запись ресурса) в кэше.</span><span class="sxs-lookup"><span data-stu-id="f42c8-176">Each answer a data structure *NX_DNS_RR* (Resource Record) in the cache.</span></span> <span data-ttu-id="f42c8-177">Строки (данные и имя записи ресурса) в записях имеют переменную длину, поэтому не хранятся в структуре NX_DNS_RR.</span><span class="sxs-lookup"><span data-stu-id="f42c8-177">Strings (resource record name and data) in Records are variable length, therefore are not stored in the NX_DNS_RR structure.</span></span> <span data-ttu-id="f42c8-178">Запись содержит указатели на фактическую область памяти, в которой хранятся строки.</span><span class="sxs-lookup"><span data-stu-id="f42c8-178">The Record contains pointers to the actual memory location where the strings are stored.</span></span> <span data-ttu-id="f42c8-179">Таблица строк и записи используют кэш совместно.</span><span class="sxs-lookup"><span data-stu-id="f42c8-179">The string table and the Records share the cache.</span></span> <span data-ttu-id="f42c8-180">Записи хранятся в начале кэша и нарастают по направлению к его концу.</span><span class="sxs-lookup"><span data-stu-id="f42c8-180">Records are stored from the beginning of the cache, and grow towards the end of the cache.</span></span> <span data-ttu-id="f42c8-181">Таблица строк начинается с конца кэша и нарастает в сторону его начала.</span><span class="sxs-lookup"><span data-stu-id="f42c8-181">The string table starts from the end of the cache and grows towards the beginning of the cache.</span></span> <span data-ttu-id="f42c8-182">Каждая строка в таблице строк имеет поле длины и поле счетчика.</span><span class="sxs-lookup"><span data-stu-id="f42c8-182">Each string in the string table has a length field and a counter field.</span></span> <span data-ttu-id="f42c8-183">Если при добавлении строки в таблицу строк там уже присутствует такая же строка, значение счетчика увеличивается, а память для строки не выделяется.</span><span class="sxs-lookup"><span data-stu-id="f42c8-183">When a string is added to the string table, if the same string is already present in the table, the counter value is incremented and no memory is allocated for the string.</span></span> <span data-ttu-id="f42c8-184">Кэш считается заполненным, если в него больше нельзя добавить записи ресурсов или новые строки.</span><span class="sxs-lookup"><span data-stu-id="f42c8-184">The cache is considered full if no more resource records or new strings can be added to the cache.</span></span>

## <a name="dns-client-limitations"></a><span data-ttu-id="f42c8-185">Ограничения клиента DNS</span><span class="sxs-lookup"><span data-stu-id="f42c8-185">DNS Client Limitations</span></span>

<span data-ttu-id="f42c8-186">Клиент DNS поддерживает выполнение одного запросу DNS за раз.</span><span class="sxs-lookup"><span data-stu-id="f42c8-186">The DNS Client supports one DNS request at a time.</span></span> <span data-ttu-id="f42c8-187">Потоки, пытающиеся выполнить другой запрос DNS, временно блокируются до завершения предыдущего запроса DNS.</span><span class="sxs-lookup"><span data-stu-id="f42c8-187">Threads attempting to make another DNS request are temporarily blocked until the previous DNS request is complete.</span></span>

<span data-ttu-id="f42c8-188">Клиент DNS для NetX Duo не использует данные из заслуживающих доверия ответов для пересылки дополнительных запросов DNS на другие DNS-серверы.</span><span class="sxs-lookup"><span data-stu-id="f42c8-188">The NetX Duo DNS Client does not use data from authoritative answers to forward additional DNS queries to other DNS servers.</span></span>

## <a name="dns-rfcs"></a><span data-ttu-id="f42c8-189">Документы RFC по DNS</span><span class="sxs-lookup"><span data-stu-id="f42c8-189">DNS RFCs</span></span>

<span data-ttu-id="f42c8-190">Служба DNS для NetX Duo соответствует следующим документам RFC.</span><span class="sxs-lookup"><span data-stu-id="f42c8-190">NetX Duo DNS is compliant with the following RFCs:</span></span>

- <span data-ttu-id="f42c8-191">RFC1034. ДОМЕННЫЕ ИМЕНА — ПОНЯТИЯ И ВОЗМОЖНОСТИ</span><span class="sxs-lookup"><span data-stu-id="f42c8-191">RFC1034 DOMAIN NAMES - CONCEPTS AND FACILITIES</span></span>
- <span data-ttu-id="f42c8-192">RFC1035. ДОМЕННЫЕ ИМЕНА — РЕАЛИЗАЦИЯ И СПЕЦИФИКАЦИЯ</span><span class="sxs-lookup"><span data-stu-id="f42c8-192">RFC1035 DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION</span></span>
- <span data-ttu-id="f42c8-193">RFC1480. Домен США</span><span class="sxs-lookup"><span data-stu-id="f42c8-193">RFC1480 The US Domain</span></span>
- <span data-ttu-id="f42c8-194">RFC 2782. Запись ресурса DNS для указания расположения служб (DNS SRV)</span><span class="sxs-lookup"><span data-stu-id="f42c8-194">RFC 2782 A DNS RR for specifying the location of services (DNS SRV)</span></span>
- <span data-ttu-id="f42c8-195">RFC 3596. Расширения DNS для поддержки протокола IP версии 6</span><span class="sxs-lookup"><span data-stu-id="f42c8-195">RFC 3596 DNS Extensions to Support IP Version 6</span></span>