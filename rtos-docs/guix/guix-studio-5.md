---
title: Конструктор экрана в GUIX Studio
description: Основной целью GUIX Studio является проектирование экранов приложения.
author: philmea
ms.author: philmea
ms.date: 5/19/2020
ms.service: rtos
ms.topic: article
ms.openlocfilehash: 318e68ab5ab7d841057d65565dfda263597d03e4
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104814940"
---
# <a name="chapter-5-guix-studio-screen-designer"></a>Глава 5. Конструктор экрана в GUIX Studio

Основной целью GUIX Studio является проектирование экранов приложения. Проектирование экранов осуществляется с помощью всех вариантов представлений, описанных ранее в главе 3. Однако основным элементом проектирования экранов в GUIX Studio является ***целевое представление***, в котором визуальное представление всех элементов экрана аналогично представлению во внедренном целевом объекте отображения. Эти элементы экрана можно выбирать, перемещать, изменять их размер и т. д. с помощью простых действий с использованием мыши и кнопок. Кроме того, для выбранных объектов доступны операции выравнивания и кнопки Z-упорядочивания. В следующих подразделах описаны различные функции конструктора экрана в GUIX Studio. 

## <a name="creatingconfiguring-projects"></a>Создание и настройка проектов

Интерфейс GUIX Studio значительно упрощает создание проектов. Нужно просто нажать кнопку **Новый проект** или выбрать в меню _*_"Проект", "Новый проект"_*_. Затем появится диалоговое окно _ *_Настройка проекта_**. В нем будут показаны основные параметры отображения, а также сведения о пути для поиска кода, созданного GUIX Studio.

При создании нового проекта отобразится диалоговое окно настройки проекта. Здесь разработчик указывает количество аппаратных отображений, доступных на целевом объекте, и свойства каждого из них. К свойствам относятся логическое имя, разрешение x/y, глубина цвета и формат, а также прочие свойства отображения. Интерфейс GUIX Studio поддерживает несколько отображений в одном и том же проекте. Если требуются дополнительные отображения, следует внести изменения в поле ***Количество отображений** _, чтобы оно соответствовало количеству экранов на встроенном устройстве. Максимальное количество отображений в проекте — 4. На _ *_рисунке 21_** показано диалоговое окно "Настройка проекта".

Изменение настроек проекта и отображение выполняется с помощью параметра меню ***Настройка, Проект/отображение** _. Выбрать проект или отображение можно также, щелкнув правой кнопкой мыши и выбрав параметр _*_Настройка, Проект/отображение_*_. После этого появится диалоговое окно _ *_Настройка проекта_**, которое упрощает внесение изменений в настройки проекта и отображения.

![Снимок экрана: диалоговое окно "Настройка проекта".](./media/guix-studio/config_project.png)

**Рис. 21**

В группе "Каталоги" можно указать выходные каталоги по умолчанию для файлов исходного кода и заголовков C, создаваемых с помощью Studio. Обычно эти каталоги сохраняются относительно расположения проекта, чтобы упростить процесс переноса проектов с одного компьютера на другой или из одной файловой системы в другую.

В поле "Дополнительные заголовки" можно указать пользовательские файлы заголовков. Если требуется более одного файла заголовка, разделяйте их в списке точкой с запятой.

При вызове команд Studio "Создать приложение" или "Создать ресурсы", которые являются каталогами по умолчанию, в них будут записываться эти исходные файлы. В любой момент можно изменить расположения этих каталогов, введя новые расположения в диалоговом окне "Выходной каталог".

## <a name="selecting-widgets"></a>Выбор мини-приложений

Выбрать мини-приложение можно, либо щелкнув его в дереве мини-приложений ***Представление проекта** _, либо щелкнув мини-приложение, которое отображается в области _*_Целевое представление_*_. Как только одно мини-приложение будет выбрано, его свойства отобразятся в области _*_Представление свойств_*_. На _*_рисунке 22_*_ показано выбранное мини-приложение "_*_кнопка_**".

![Снимок экрана: выбранное мини-приложение.](./media/guix-studio/select_button.png)

**Рис. 22**

## <a name="using-properties"></a>Использование свойств

Как упоминалось ранее, свойства для выбранного мини-приложения представлены в области ***Представление свойств** _. Все мини-приложения имеют общий набор свойств, а также некоторые свойства, специфичные для определенного типа мини-приложения. Например, мини-приложение "кнопка" имеет свойство _ *_Нажать_**, а у мини-приложения "окно" такого свойства нет. Ниже приведен общий набор свойств мини-приложения:

| Свойство         | Значение                                                                               |
| ---------------- | ------------------------------------------------------------------------------------- |
| Тип мини-приложения    | Тип мини-приложения, для справки.                                                                               |
| Имя мини-приложения      | Имя мини-приложения, которое передается в функцию создания мини-приложения, а также используется для именования переменных в созданных исходных файлах.               |
| Идентификатор мини-приложения        | Идентификатор мини-приложения. Это значение идентификатора используется для вызова сигналов с дочерних мини-приложений на их родительские экраны.                            |
| Левый             | Самая левая координата мини-приложения.                                                                                                 |
| Начало              | Самая верхняя координата мини-приложения.                                                                                                  |
| Ширина            | Ширина мини-приложения в пикселях.                                                                                                      |
| Высота           | Высота мини-приложения в пикселях.                                                                                                     |
| Рамка           | Тип границ мини-приложения.                                                                                                          |
| Прозрачный      | Флажок должен быть установлен, если мини-приложение частично прозрачно.                                                                       |
| Выбранная прорисовка    | Флажок должен быть установлен, если мини-приложение должно сначала прорисовать себя в выбранном состоянии.                                            |
| Включить           | Флажок должен быть установлен, если конечный пользователь может выбрать мини-приложение или щелкнуть его.                                                    |
| Принятие фокуса    | Флажок должен быть установлен, если мини-приложение принимает фокус.                                                                                 |
| Выделение среды выполнения | Флажок должен быть установлен, если блок управления мини-приложением должен быть выделен динамически.                                                 |
| Обычная заливка      | Идентификатор ресурса цвета обычной заливки.                                                                                                  |
| Выбранная заливка    | Идентификатор ресурса цвета выбранной заливки.                                                                                                |
| Функция рисования    | Имя определяемой пользователем пользовательской функции рисования. Если это поле пустое, используется стандартная функция рисования для этого типа мини-приложения. |
| Функция события   | Имя пользовательской функции обработки определяемых пользователем событий. Если это поле пустое, для этого типа мини-приложения используется стандартная обработка событий.          |

На ***рисунке 23*** показаны свойства простого окна мини-приложения.

![Снимок экрана: свойства простого окна мини-приложения.](./media/guix-studio/image57.jpg)

**Рис. 23**

Многие типы мини-приложений имеют дополнительные свойства, специфичные для каждого типа.

Например, выше на рисунке 23 тип мини-приложения Windows поддерживает идентификатор карт отображения пикселей фонового рисунка, а также параметр стиля, указывающий, должен ли фоновый рисунок отображаться по центру или быть замощенным.

Текстовые мини-приложения поддерживают поле идентификатора строки, а также стили выравнивания текста и спецификацию шрифта. После прочтения описания каждого из типов мини-приложений и доступных стилей, а также создания параметров функции для этого типа дополнительные свойства мини-приложений станут для вас понятными на интуитивном уровне.

## <a name="manipulating-widgets"></a>Управление мини-приложениями

Для работы с мини-приложением сначала необходимо его выбрать. Это можно сделать, непосредственно щелкнув его в области ***Целевое представление** _ или выбрав в дереве мини-приложения параметр _ *_Представление проекта_**. Выбранное мини-приложение будет иметь пунктирный контур. В этом состоянии его можно переместить, просто щелкнув и перетащив в нужное место на родительском объекте. Если это мини-приложение является мини-приложением верхнего уровня, то его перетаскивание фактически устанавливает изначальное расположение мини-приложения на целевом дисплее. К тому же всегда можно переместить мини-приложение или изменить его размер в любое удобное для вас время с помощью программного интерфейса GUIX.

Чтобы изменить высоту мини-приложения, наведите указатель мыши на его верхний край и дождитесь, когда указатель изменится на стрелку "вверх-вниз". В этот момент высоту мини-приложения можно изменить, просто переместив мышь, одновременно нажимая и удерживая ее правую кнопку. Ширину можно изменить мышью аналогичным образом. Для этого следует переместить указатель мыши на левый край мини-приложения.На  ***рисунке 24** _ показано мини-приложение "_*_кнопка_**", размер которого изменен и которое перемещено в левую или верхнюю область родительского окна.

![Снимок экрана: мини-приложение "кнопка".](./media/guix-studio/resize_button.png)

**Рис. 24**

## <a name="manipulating-multiple-widgets"></a>Управление несколькими мини-приложениями

Выбрать несколько мини-приложений можно, если щелкнуть несколько мини-приложений в целевом представлении, при этом удерживая клавишу ***Ctrl***. Это приведет к отображению пунктирным контуром каждого из выбранных мини-приложений. Обратите внимание, что при выборе нескольких мини-приложений для каждого из них в группе выбора должен быть дочерний элемент того же родительского элемента.

После выбора нескольких мини-приложений их можно будет одновременно переместить, щелкнув внутри одного из них и двигая мышь, при этом удерживая ее правую кнопку. Кроме того, можно выровнять группы выбранных мини-приложений с помощью кнопки выравнивания на ***Панели инструментов** _. На _*_рисунке 25_*_ показаны выбранные мини-приложения "_*_кнопка_*_" и "_*_новая кнопка_*_", а на _*_рисунке 26_*_ показан результат применения кнопки _ *_Выровнять по левому краю_* *, когда эти мини-приложения выбраны.

![Снимок экрана: выбранные мини-приложения "кнопка" и "новая кнопка".](./media/guix-studio/multiple_select.png)

**Рис. 25**

![Снимок экрана: результат выбора кнопки "Выровнять по левому краю".](./media/guix-studio/align_left.png)

**Рис. 26**

## <a name="cutcopypaste-operations"></a>Операции "вырезать", "копировать" и "вставить"

Выбранное мини-приложение в ***Целевом представлении** _ можно вырезать, скопировать и вставить стандартным способом. Мини-приложения и экраны можно копировать в один проект или копировать из одного проекта и вставлять в другой. _*_Панель инструментов_*_ содержит кнопки "вырезать", "копировать" и "вставить". Те же параметры есть и в пункте меню "Правка". Обратите внимание, что при вставке мини-приложения сначала нужно выбрать родительское мини-приложение, а потом вставлять новое. На _*_рисунке 27_*_ показан результат выбора мини-приложения "_*_кнопка_**", его копирование и вставка в то же окно.

![Снимок экрана: операции "вырезать", "копировать" и "вставить".](./media/guix-studio/copy_paste_button.png)

**Рис. 27**

Операции "копировать" и "вставить" в рамках одного проекта обычно просты, так как ресурсы, которые могут потребоваться для копирования мини-приложений, всегда в наличии при работе в рамках одного проекта. Однако при копировании мини-приложения из проекта А и его вставке в проект B могут возникнуть некоторые проблемы с зависимостями ресурсов.

Когда копируют мини-приложение в среде Studio, приложение Studio создает список ресурсов, необходимых для скопированных мини-приложений, и переносимую таблицу зависимостей ресурсов в формате XML. Все это копируется в буфер обмена окна вместе с фактическими сведениями о скопированном мини-приложении. При вставке мини-приложения в другой проект интерфейс Studio сначала проверяет список зависимостей ресурсов и добавляет необходимые ресурсы в открытый проект, если их еще там нет. Studio определяет соответствующие ресурсы по именам идентификаторов ресурсов, а также сравнивает содержимое строки для строковых ресурсов. При обнаружении соответствующих ресурсов Studio обновляет идентификаторы ресурсов вставленных мини-приложений, чтобы правильно использовать ресурсы в новом проекте. Если ресурсы не найдены, они добавляются.

Когда Studio добавляет ресурс в ваш проект в ходе операции вставки мини-приложения, в действительности Studio добавляет ссылку на ресурс, если предстоит работать с ресурсами шрифтов и карт отображения пикселей. Эта ссылка создается на основе исходного проекта. Вы получите предупреждающие сообщения, если эти ресурсы не удастся найти относительно расположения проекта, в который вы их вставляете. Ссылки на ресурсы будут добавлены в проект в любом случае, но для устранения ошибок загрузки ресурсов может понадобиться вручную скопировать шрифты и файлы изображений в соответствующие места в новом дереве проекта. Studio не копирует из одного расположения в другое TTF-, PNG- или JPG-файлы.

Самый простой способ избежать проблем в этом отношении заключается в том, чтобы сохранить согласованную структуру каталогов между проектами, к которым нужно предоставить общий доступ. Если вы хотите легко переместить элементы из проекта A в проект B, сохраните графические изображения и шрифты, используемые обоими проектами, в согласованном подкаталоге каждой папки проекта.

## <a name="changing-z-order"></a>Изменение Z-порядка

Мини-приложения можно легко перемещать перед другими мини-приложениями или за ними. Для этого следует выбрать мини-приложение и нажать кнопки ***Переместить на передний план** _ или _*_Переместить на задний план_*_ на _*_Панели инструментов_*_. На _ *_рисунке 28_** показано перемещение второй кнопки на задний план.

![Снимок экрана: кнопка z-порядка](./media/guix-studio/change_z_order.png)

**Рис. 28**

## <a name="assigning-colors-fonts-and-pixelmaps"></a>Назначение цветов, шрифтов и карт отображения пикселей

Помимо выбора цветов, шрифтов и карт отображения пикселей в области "Представление свойств" для выбранного мини-приложения, также поддерживается сокращенный способ перетаскивания для назначения ресурсов мини-приложениям. Чтобы использовать эту функцию, просто щелкните левой кнопкой мыши ресурс, например цвет шрифта в представлении ресурсов, а затем перетащите его на нужное мини-приложение в целевом представлении. Закончите перемещение ресурса, отпустив левую кнопку мыши над мини-приложением.

Цветовые ресурсы всегда назначаются обычному цвету фона мини-приложения при использовании метода перетаскивания. Другие цвета, такие как выбранный цвет или выбранный цвет текста, должны быть назначены в области "Представление свойств".

Аналогичным образом ресурсы карты отображения пикселей назначаются "обычному" или "заполненному" полю в мини-приложении, которое поддерживает показ карты отображения пикселей. Чтобы назначить другие поля мини-приложению, поддерживающему несколько карт отображения пикселей, следует использовать "Представление свойств".

## <a name="using-templates"></a>Использование шаблонов

Любой экран или коллекцию дочерних мини-приложений, которые создаются в Studio, можно использовать в качестве шаблона для новых экранов и дочерних элементов управления. Использование шаблона аналогично копированию и вставке мини-приложения, за исключением того, что все производное из шаблона автоматически изменяется при изменении шаблона, на котором оно основано. Вам нельзя изменять свойства шаблона мини-приложения при работе с производным экраном или унаследованным экземпляром шаблона. Однако при изменении свойств шаблона любым способом все экземпляры, которые ссылаются на этот шаблон, автоматически обновляются, так как они являются производными от этого шаблона.

Еще одним преимуществом использования шаблонов для повторяющихся элементов является то, что созданный в среде Studio файл спецификации скорее всего будет меньшим по размеру, чем в случае повторного создания повторяющихся элементов при каждом их использовании.

Чтобы указать, что в качестве шаблона следует использовать экран или коллекцию дочерних мини-приложений, установите флажок "Шаблон" в окне свойств мини-приложения. После установления флажка "Шаблон" мини-приложение шаблона появится в раскрывающемся меню ***Вставка|Шаблон***.

Как пример использования шаблона можно определить окно, которое используют в качестве панели кнопок. Это окно может содержать несколько дочерних кнопок, а панель кнопок часто используется на различных экранах. В проекте Studio можно определить небольшое автономное окно, которое содержит необходимые дочерние кнопки, и присвоить этому окну имя button_bar. Затем выберите это окно и включите свойство "Шаблон". Далее выберите экран, на котором нужно добавить эту панель кнопок. Используйте команду меню "Вставка|Шаблон|button_bar", чтобы вставить экземпляр окна button_bar на свой экран. Обратите внимание, что можно изменить расположение панели кнопок, но нельзя изменять большинство свойств. Однако можно использовать мини-приложение button_bar (и все дочерние элементы) так же, как и любые другие предварительно определенные типы мини-приложений GUIX. Чтобы изменить button_bar, нужно выбрать шаблон button_bar и внести изменения.

Другим примером типичного использования шаблона является приложение, которое содержит много похожих экранов. Например, приложение может иметь 10 разных экранов, которые совместно используют общую строку заголовка, цвет заливки, размер и т. д. В этом случае вы можете определить экран шаблона, который включает дочерние мини-приложения в строке заголовка, настраивает размер экрана, цвет заливки, а также другие свойства. После того как этот экран шаблона будет определен, вы сможете получить из этого шаблона 10 различных экранов. При использовании команды меню Вставка|Шаблон|\<base_screen> на экране будут запущены все дочерние мини-приложения и параметры шаблона экрана. Обратите внимание, что каждый экран, производный из экрана шаблона — это не копия шаблона, а действительно производный экземпляр экрана шаблона. Затем вы сможете настроить каждый производный экран, чтобы вместить любое необходимое дополнительное содержимое.

Обратите внимание, что помимо сохранения размера созданного файла спецификаций использование шаблонов может упростить управление изменениями внешнего вида приложения. Предположим, что в приведенном выше примере необходимо изменить цвет фона для 10 похожих экранов. Вместо того чтобы выбирать каждый экран отдельно и изменять параметры цвета заливки, необходимо выбрать только базовый шаблон и изменить цвет его заливки. Это изменение немедленно отразится на всех производных экранах.

Еще один комментарий относительно шаблонов. Необходимо убедиться, что поток обработки событий поддерживается, то есть, если вы предоставляете обработчик событий как для базового экрана (для обработки общих событий мини-приложений), так и для производного экрана, обработчик событий производного экрана должен вызвать обработчик событий base_screen в варианте по умолчанию. Это позволит обработчику событий базового экрана обрабатывать события, создаваемые мини-приложениями, общими для всех экранов, производных от этой базы шаблона.

## <a name="record-and-playback-macro"></a>Запись и воспроизведение макроса

Функции записи и воспроизведения макросов помогают записывать и воспроизводить события нажатия клавиш и мыши.

Запись в файл макроса выполняется путем нажатия кнопки ***Записать макрос** _ на панели инструментов или в меню, где следует выбрать _*_Правка, Записать макрос_*_. В GUIX Studio появится диалоговое окно _*_Записать макрос_*_, в котором можно указать путь к файлу макроса. Выбрав путь, нажмите кнопку _*_Запись_*_, чтобы начать запись. После завершения записи снова нажмите кнопку _*_Записать макрос_*_ на панели инструментов или воспользуйтесь раскрывающимся меню, выбрав _ *_Правка, Завершить макрос_** для завершения записи макроса.

Воспроизведение файла макроса осуществляется путем нажатия кнопки ***Воспроизвести макрос** _ на панели инструментов в главном раскрывающемся меню и выбора команды _*_Правка, Воспроизвести макрос_*_. В GUIX Studio появится диалоговое окно _ *_Воспроизвести макрос_**, в котором можно указать ранее записанный файл макроса для запуска.

При записи макросов, которые выбирают входные или выходные файлы, например добавление шрифта или изображения, лучше воспользоваться вводом имени файла на клавиатуре, а не выбором файла из файлового браузера при помощи мыши. Так как средство записи макросов записывает события мыши и клавиатуры и так как ваш файловый браузер может изменяться со временем, более надежным является ввод имени файла, чем выбор файла в графическом виде.

## <a name="zooming-target-view"></a>Изменение масштаба целевого представления

Функция "увеличить" позволяет получить крупный план представления целевого экрана.

Выбрать нужный параметр масштабирования в процентах можно в пункте меню * **Настройка|Целевое представление|Масштаб** _. На _ *_панели инструментов_** также имеются кнопки для изменения масштаба.

## <a name="gridsnap-settings"></a>Параметры сетки или прикрепления

Диалоговое окно ***Параметры сетки и прикрепления** _ содержит некоторые настройки и параметры для сетки и прикрепления. На _*_рисунке 29_*_ показано диалоговое окно _*_Параметры сетки и прикрепления_*_ при выборе меню _ *_Настройка|Целевое представление|Сетка или прикрепление_**.

![Снимок экрана: параметры сетки и прикрепления.](./media/guix-studio/image63.jpg)

**Рис. 29**

Включите параметр ***Показать сетку** _, чтобы отобразить сетку на целевом экране. Можно указать шаг сетки (в пикселях) в поле _*_Интервал сетки_*_. Параметр _ *_Привязать к сетке_** позволяет получить соответствующее положение мини-приложения. Включите этот параметр, чтобы активировать прикрепления.

Если включен параметр ***Сетка и прикрепление***:

- при перетаскивании объекта с помощью мыши в целевом представлении объект будет перемещаться по шагам сетки;
- при перетаскивании края объекта для изменения размера край, который вы перетаскиваете, будет прикреплен к положению сетки;
- при выборе объекта и использовании клавиш "вверх", "влево", "вниз", "вправо" выбранное мини-приложение будет перемещаться по шагу прикрепления. Можно указать шаг прикрепления (в пикселях) в поле ***Интервал прикрепления***.
