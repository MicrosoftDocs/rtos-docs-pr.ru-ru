---
title: Определение потока экранов
description: GUIX Studio поддерживает автоматическое создание и выполнение логики перехода между экранами.
author: philmea
ms.author: philmea
ms.date: 5/19/2020
ms.service: rtos
ms.topic: article
ms.openlocfilehash: 1c590725281c785181bcb4c5852346bc973c24d1
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104814919"
---
# <a name="chapter-7-defining-screen-flow"></a>Глава 7. Определение потока экранов

GUIX Studio поддерживает автоматическое создание и выполнение логики перехода между экранами. Пользователь определяет логику перехода между экранами, создавая и изменяя графическую схему потока экранов. Когда схема потока экранов добавляется в проект, она обеспечивает две важные функции: 1) приложение может выполняться из среды Studio и 2) среда Studio автоматически создает обработчики событий и логику перехода между экранами для реализации заданного потока экранов в файле specifications.c, освобождая приложение от этой задачи. 

Запуск приложения на компьютере из среды Studio — это удобная возможность, которая экономит время, так как вам не приходится выполнять цикл компиляции и компоновки для выполнения приложения. Разумеется, при запуске приложения без компиляции возможности ограниченны. Пользовательские функции рисования, пользовательские обработчики событий и обработчики сложных событий недоступны при запуске приложения из среды GUIX Studio. Тем не менее эта возможность позволяет автоматически создавать логику перехода между экранами и выполнять программную анимацию для перехода с одного экрана на другой. Эти эффекты и анимации можно наблюдать непосредственно в среде GUIX Studio.

Обратите внимание, что при определении потока экранов, триггеров и действий, которые будут описаны в следующих абзацах, вы не только обеспечиваете выполнение пользовательского интерфейса из среды Studio, но и позволяете GUIX Studio создать в файле спецификаций логику, которая будет обрабатывать события и выполнять на их основе действия, например переход с одного экрана на другой.

## <a name="configuring-screen-flow"></a>Настройка потока экранов

Перед выполнением приложения в среде Studio необходимо определить несколько элементов. Во-первых, нужно указать экран или экраны верхнего уровня, которые должны отображаться при запуске программы. Для этого нужно задать свойство Visible at Startup (Видимое при запуске) в представлении свойств в Studio. Этот флаг указывает, что экран должен отображаться первым при запуске программы. При необходимости можно выбрать несколько экранов.

После определения экранов, видимых при запуске, пользователь может указать, как будут сменяться экраны в пользовательском интерфейсе приложения. В GUIX Studio есть графическая схема потока экранов для определения логики перехода между экранами. Просто выберите в меню пункты ***Configure > Screen Flow** _ (Настроить > Поток экранов), чтобы открыть диалоговое окно изменения потока экранов. См. снимок экрана на _*_рис. 30_**.

![Снимок экрана: диалоговое окно потока экранов в GUIX Studio](./media/guix-studio/config_screen_flow.png)

**Рис. 30**

Каждый экран верхнего уровня, определенный в проекте, будет отображаться в виде поля с именем экрана. Это поле представляет собой заполнитель для каждого экрана верхнего уровня, определенного в проекте. Поля можно перемещать и изменять их размеры по желанию. После определения перехода от одного экрана верхнего уровня к другому между ними появляется соединительная линия со стрелкой, указывающей направление перехода.

В представлении в виде дерева слева от схемы потока экранов показаны все экраны верхнего уровня. Вы можете выбрать, какие из них должны отображаться на схеме.

Схему потока экранов можно прокручивать. Любой блок экрана можно перетащить вниз и вправо за пределы видимой области, чтобы увеличить прокручиваемое окно. После увеличения прокручиваемого окна можно уменьшить масштаб, прокрутив колесико мыши вниз, чтобы окно заняло видимую область. Если прокручиваемое окно уменьшено, вы можете сделать его достаточно большим, чтобы в нем поместились все блоки, прокрутив колесико мыши вверх.

Чтобы определить переходы для экрана, щелкните правой кнопкой мыши его заполнитель. Откроется диалоговое окно изменения списка триггеров, показанное на ***рис. 31***.

![Снимок экрана: диалоговое окно изменения списка триггеров в GUIX Studio](./media/guix-studio/edit_trigger_list.png)

**Рис. 31**

В диалоговом окне изменения триггеров показан список определенных пользователем событий, которые активируют переход на экран. Такие события и называются триггерами. Обычно триггеры представляют собой сигналы, генерируемые одним дочерним мини-приложением выбранного экрана или несколькими.

Чтобы определить новый триггер, нажмите кнопку ***Add New Trigger** _ (Добавить новый триггер) в диалоговом окне изменения списка триггеров. Откроется диалоговое окно добавления триггера, показанное на _*_рис. 32_**.

![Снимок экрана: диалоговое окно добавления триггера в GUIX Studio](./media/guix-studio/add_trigger_for.png)

**Рис. 32**

Вы можете определить тип события, инициирующего новый набор действий, и действия, которые будут выполняться при получении этого события триггера.

Определив тип события, которое будет использоваться для активации нового анимированного перехода на экран, сохраните этот триггер. Оно появится в диалоговом окне изменения списка триггеров.

Это событие можно изменить (без изменения связанных действий), выбрав событие в диалоговом окне изменения списка триггеров и нажав кнопку ***Edit Trigger Event*** (Изменить событие триггера).

Аналогичным образом можно удалить любое событие триггера из списка, выбрав событие и нажав кнопку ***Delete Selected Trigger*** (Удалить выбранный триггер).

Чтобы указать анимацию или переход на экран, которые должны выполняться при наступлении определенного события триггера, выберите это событие и нажмите кнопку ***Edit Action(s)*** (Изменить действия). Обратите внимание, что один триггер может активировать несколько действий.

При нажатии кнопки **Edit Action(s)** (Изменить действия) открывается диалоговое окно изменения действий для триггера, показанное на рис. 33. 

![Снимок экрана: диалоговое окно изменения действий для триггера в GUIX Studio](./media/guix-studio/edit_actions_for_trigger.png)

**Рис. 33**

В этом диалоговом окне можно определить любое количество действий, активируемых при наступлении данного события триггера. Каждому действию можно присвоить понятное имя, которое поможет связать его определение с визуальной анимацией или переходом. В приведенном выше примере мы определили два действия с именами fade_in_text_screen и fade_out_button_screen.

Чтобы определить новое действие, нажмите кнопку Add New Action (Добавить новое действие). Откроется диалоговое окно выбора действия, показанное на рис. 34.

![Снимок экрана: диалоговое окно выбора действия в GUIX Studio](./media/guix-studio/select_action.png)

**Рис. 34**

Ниже перечислены доступные типы действий.

- **Animation** (Анимация): запуск анимации с указанными сведениями.
- **Attach** (Присоединение): присоединение целевого экрана к родительскому. Если родительский экран не указан, целевой экран будет присоединен к корневому окну.
- **Detach** (Отсоединение): отсоединение целевого экрана от родительского.
- **Hide** (Скрытие): скрытие целевого экрана.
- **Screen Stack Pop** (Извлечение экрана из стека): извлечение экрана из внутреннего стека экранов.
- **Screen Stack Push** (Помещение экрана в стек): помещение указателя на экран во внутренний стек экранов.
- **Screen Stack Reset** (Сброс стека экранов): удаление всех указателей на экраны из внутреннего стека экранов.
- **Show** (Отображение): отображение целевого экрана.
- **Toggle** (Переключение): присоединение целевого экрана к родительскому экрану текущего экрана и отсоединение текущего экрана от родительского.
- **Window Execute** (Выполнение окна): модальное выполнение целевого экрана.
- **Window Execute Stop** (Остановка выполнения окна): завершение модального выполнения текущего экрана.

После определения действия, выполняемого при наступлении выбранного события триггера, это действие появится в диалоговом окне изменения действий для триггера. Вы можете выбрать это действие, чтобы изменить его параметры, как показано на рис. 35.

![Снимок экрана: диалоговое окно изменения действий для триггера в GUIX Studio](./media/guix-studio/edit_actions_for_trigger.png)

**Рис. 35**

Если тип действия — анимация, справа отображается набор параметров анимации, позволяющий настроить анимацию скольжения или исчезновения. Вы также можете определить, должна ли анимация после завершения автоматически отсоединяться от родительского экрана и (или) помещаться во внутренний стек экрана, что часто бывает полезно при определении многоуровневой системы меню.

Для анимаций скольжения и исчезновения можно также определить функцию для реалистичной анимации, нажав кнопку Easing Func Select (Выбор функции для реалистичной анимации). Функции для реалистичной анимации — это различные кривые, которые позволяют более правдоподобно имитировать реальные движения. При нажатии этой кнопки открывается диалоговое окно **Select Easing Function** (Выбор функции для реалистичной анимации), показанное на рис. 36.

![Снимок экрана: диалоговое окно выбора функции для реалистичной анимации в GUIX Studio](./media/guix-studio/easing_function_select.png)

**Рис. 36**

При определении нескольких действий, связанных с одним событием триггера, может быть полезно назначить каждому из них понятное имя. Имена действий должны соответствовать правилам именования C, так как они будут использоваться в генерируемом файле спецификаций для определения таблиц событий и действий.

При определении событий триггеров и действий в GUIX Studio в файле спецификаций проекта создаются автоматические обработчики событий для обработки этих событий и выполнения указанных действий. Это означает, что обрабатывать эти события в коде приложения НЕ требуется, хотя события триггера по-прежнему передаются в определенные вами пользовательские обработчики событий. Иными словами, обработчики событий, созданные средой Studio, дополняют, а не заменяют ваши собственные обработчики событий.

## <a name="running-the-application"></a>Запуск приложения

После создания экранов запуска и схемы потока экранов можно запустить приложение в среде Studio, нажав кнопку Run Application (Запустить приложение)

![Снимок экрана: кнопка Run Application (Запустить приложение)](./media/guix-studio/image68.jpg)

на панели инструментов, выбрав пункт Run Application (Запустить приложение) в меню Edit (Правка) проекта или нажав кнопку Run (Запуск) в нижней части диалогового окна изменение потока экранов.

При запуске приложения вы увидите экраны, настроенные как видимые при запуске, в новом окне. Дочерние мини-приложения на этих экранах полностью работоспособны. Вы можете нажимать кнопки, перемещать ползунки и колеса прокрутки и т. д. Если вы определили пользовательские функции рисования или обработчики событий для каких-либо мини-приложений, они НЕ будут работать при запуске приложения в этом режиме. Однако, если вы определили схему потока экранов с событиями триггеров и действиями, эти триггеры будут работать и экраны будут сменяться так, как вы указали, включая все настроенные анимации.
